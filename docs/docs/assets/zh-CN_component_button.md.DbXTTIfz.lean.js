import{d as va,s as Ca,y as Ba,o as Li,c as Ii,I as Qi,a2 as Wi}from"./chunks/framework.BLHWSx9w.js";const b={toURL(s,t){let e=encodeURIComponent(s);return t==="text"?e="data:text/plain;charset=utf-8,"+e:t==="svg"&&(e="data:image/svg+xml,"+e),e},image:{hitCanvasSize:100,maxCacheSize:2560*1600,maxPatternSize:4096*2160,crossOrigin:"anonymous",getRealURL(s){const{prefix:t,suffix:e}=b.image;return e&&!s.startsWith("data:")&&!s.startsWith("blob:")&&(s+=(s.includes("?")?"&":"?")+e),t&&s[0]==="/"&&(s=t+s),s}}},pt={},xe={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(s){const{types:t}=hl;return t[s]?t[s]++:(t[s]=1,0)}},hl=xe,{round:ol,pow:ll,PI:Ra}=Math,Gt={within(s,t,e){return t!==void 0&&s<t&&(s=t),e!==void 0&&s>e&&(s=e),s},fourNumber(s,t){let e;if(s instanceof Array)switch(s.length){case 4:e=t===void 0?s:[...s];break;case 2:e=[s[0],s[1],s[0],s[1]];break;case 3:e=[s[0],s[1],s[2],s[1]];break;case 1:s=s[0];break;default:s=0}if(e||(e=[s,s,s,s]),t)for(let i=0;i<4;i++)e[i]>t&&(e[i]=t);return e},formatRotation(s,t){return s%=360,t?s<0&&(s+=360):(s>180&&(s-=360),s<-180&&(s+=360)),Gt.float(s)},getGapRotation(s,t,e=0){let i=s+e;if(t>1){const n=Math.abs(i%t);(n<1||n>t-1)&&(i=Math.round(i/t)*t)}return i-e},float(s,t){const e=t?ll(10,t):1e12;return s=ol(s*e)/e,s===-0?0:s}},N=Ra/180,zt=Ra*2,ds=Ra/2;function so(){return{x:0,y:0}}function io(){return{x:0,y:0,width:0,height:0}}function sa(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:Ji,cos:tn,acos:ii,sqrt:en}=Math,{float:is}=Gt,ns={};function Ua(){return Object.assign(Object.assign(Object.assign({},sa()),io()),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const S={defaultMatrix:sa(),defaultWorld:Ua(),tempMatrix:{},set(s,t=1,e=0,i=0,n=1,a=0,r=0){s.a=t,s.b=e,s.c=i,s.d=n,s.e=a,s.f=r},get:sa,getWorld:Ua,copy(s,t){s.a=t.a,s.b=t.b,s.c=t.c,s.d=t.d,s.e=t.e,s.f=t.f},translate(s,t,e){s.e+=t,s.f+=e},translateInner(s,t,e,i){s.e+=s.a*t+s.c*e,s.f+=s.b*t+s.d*e,i&&(s.e-=t,s.f-=e)},scale(s,t,e=t){s.a*=t,s.b*=t,s.c*=e,s.d*=e},scaleOfOuter(s,t,e,i){K.toInnerPoint(s,t,ns),K.scaleOfInner(s,ns,e,i)},scaleOfInner(s,t,e,i=e){K.translateInner(s,t.x,t.y),K.scale(s,e,i),K.translateInner(s,-t.x,-t.y)},rotate(s,t){const{a:e,b:i,c:n,d:a}=s;t*=N;const r=tn(t),h=Ji(t);s.a=e*r-i*h,s.b=e*h+i*r,s.c=n*r-a*h,s.d=n*h+a*r},rotateOfOuter(s,t,e){K.toInnerPoint(s,t,ns),K.rotateOfInner(s,ns,e)},rotateOfInner(s,t,e){K.translateInner(s,t.x,t.y),K.rotate(s,e),K.translateInner(s,-t.x,-t.y)},skew(s,t,e){const{a:i,b:n,c:a,d:r}=s;e&&(e*=N,s.a=i+a*e,s.b=n+r*e),t&&(t*=N,s.c=a+i*t,s.d=r+n*t)},skewOfOuter(s,t,e,i){K.toInnerPoint(s,t,ns),K.skewOfInner(s,ns,e,i)},skewOfInner(s,t,e,i=0){K.translateInner(s,t.x,t.y),K.skew(s,e,i),K.translateInner(s,-t.x,-t.y)},multiply(s,t){const{a:e,b:i,c:n,d:a,e:r,f:h}=s;s.a=t.a*e+t.b*n,s.b=t.a*i+t.b*a,s.c=t.c*e+t.d*n,s.d=t.c*i+t.d*a,s.e=t.e*e+t.f*n+r,s.f=t.e*i+t.f*a+h},multiplyParent(s,t,e,i,n,a){let{e:r,f:h}=s;if(a&&(r+=a.scrollX,h+=a.scrollY),e||(e=s),i===void 0&&(i=s.a!==1||s.b||s.c||s.d!==1),i){const{a:o,b:l,c:d,d:_}=s;e.a=o*t.a+l*t.c,e.b=o*t.b+l*t.d,e.c=d*t.a+_*t.c,e.d=d*t.b+_*t.d,n&&(e.scaleX=t.scaleX*n.scaleX,e.scaleY=t.scaleY*n.scaleY)}else e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,n&&(e.scaleX=t.scaleX,e.scaleY=t.scaleY);e.e=r*t.a+h*t.c+t.e,e.f=r*t.b+h*t.d+t.f},divide(s,t){K.multiply(s,K.tempInvert(t))},divideParent(s,t){K.multiplyParent(s,K.tempInvert(t))},tempInvert(s){const{tempMatrix:t}=K;return K.copy(t,s),K.invert(t),t},invert(s){const{a:t,b:e,c:i,d:n,e:a,f:r}=s;if(!e&&!i)if(t===1&&n===1)s.e=-a,s.f=-r;else{const h=1/(t*n);s.a=n*h,s.d=t*h,s.e=-a*n*h,s.f=-r*t*h}else{const h=1/(t*n-e*i);s.a=n*h,s.b=-e*h,s.c=-i*h,s.d=t*h,s.e=-(a*n-r*i)*h,s.f=-(r*t-a*e)*h}},toOuterPoint(s,t,e,i){const{x:n,y:a}=t;e||(e=t),e.x=n*s.a+a*s.c,e.y=n*s.b+a*s.d,i||(e.x+=s.e,e.y+=s.f)},toInnerPoint(s,t,e,i){const{a:n,b:a,c:r,d:h}=s,o=1/(n*h-a*r),{x:l,y:d}=t;if(e||(e=t),e.x=(l*h-d*r)*o,e.y=(d*n-l*a)*o,!i){const{e:_,f:u}=s;e.x-=(_*h-u*r)*o,e.y-=(u*n-_*a)*o}},setLayout(s,t,e,i){const{x:n,y:a,scaleX:r,scaleY:h}=t;if(i===void 0&&(i=t.rotation||t.skewX||t.skewY),i){const{rotation:o,skewX:l,skewY:d}=t,_=o*N,u=tn(_),p=Ji(_);if(l||d){const f=l*N,g=d*N;s.a=(u+g*-p)*r,s.b=(p+g*u)*r,s.c=(-p+f*u)*h,s.d=(u+f*p)*h}else s.a=u*r,s.b=p*r,s.c=-p*h,s.d=u*h}else s.a=r,s.b=0,s.c=0,s.d=h;s.e=n,s.f=a,e&&K.translateInner(s,-e.x,-e.y,!0)},getLayout(s,t,e){const{a:i,b:n,c:a,d:r,e:h,f:o}=s;let l=h,d=o,_,u,p,f,g;if(n||a){const m=i*r-n*a;if(a&&!e){_=en(i*i+n*n),u=m/_;const w=i/_;p=n>0?ii(w):-ii(w)}else{u=en(a*a+r*r),_=m/u;const w=a/u;p=ds-(r>0?ii(-w):-ii(w))}const E=is(tn(p)),k=Ji(p);_=is(_),u=is(u),f=E?is((a/u+k)/E/N,9):0,g=E?is((n/_-k)/E/N,9):0,p=is(p/N)}else _=i,u=r,p=f=g=0;return t&&(l+=t.x*i+t.y*a,d+=t.x*n+t.y*r),{x:l,y:d,scaleX:_,scaleY:u,rotation:p,skewX:f,skewY:g}},withScale(s,t,e=t){const i=s;if(!t||!e){const{a:n,b:a,c:r,d:h}=s;a||r?(t=en(n*n+a*a),e=(n*h-a*r)/t):(t=n,e=h)}return i.scaleX=t,i.scaleY=e,i},reset(s){K.set(s)}},K=S,{toInnerPoint:sn,toOuterPoint:Ya}=S,{sin:Va,cos:Xa,abs:qa,sqrt:dl,atan2:nn,min:pl,PI:cl}=Math,R={defaultPoint:so(),tempPoint:{},tempRadiusPoint:{},set(s,t=0,e=0){s.x=t,s.y=e},setRadius(s,t,e){s.radiusX=t,s.radiusY=e===void 0?t:e},copy(s,t){s.x=t.x,s.y=t.y},copyFrom(s,t,e){s.x=t,s.y=e},move(s,t,e){s.x+=t,s.y+=e},scale(s,t,e=t){s.x&&(s.x*=t),s.y&&(s.y*=e)},scaleOf(s,t,e,i=e){s.x+=(s.x-t.x)*(e-1),s.y+=(s.y-t.y)*(i-1)},rotate(s,t,e){e||(e=Ue.defaultPoint),t*=N;const i=Xa(t),n=Va(t),a=s.x-e.x,r=s.y-e.y;s.x=e.x+a*i-r*n,s.y=e.y+a*n+r*i},tempToInnerOf(s,t){const{tempPoint:e}=Ue;return rn(e,s),sn(t,e,e),e},tempToOuterOf(s,t){const{tempPoint:e}=Ue;return rn(e,s),Ya(t,e,e),e},tempToInnerRadiusPointOf(s,t){const{tempRadiusPoint:e}=Ue;return rn(e,s),Ue.toInnerRadiusPointOf(s,t,e),e},toInnerRadiusPointOf(s,t,e){e||(e=s),sn(t,s,e),e.radiusX=Math.abs(s.radiusX/t.scaleX),e.radiusY=Math.abs(s.radiusY/t.scaleY)},toInnerOf(s,t,e){sn(t,s,e)},toOuterOf(s,t,e){Ya(t,s,e)},getCenter(s,t){return{x:s.x+(t.x-s.x)/2,y:s.y+(t.y-s.y)/2}},getCenterX(s,t){return s+(t-s)/2},getCenterY(s,t){return s+(t-s)/2},getDistance(s,t){return an(s.x,s.y,t.x,t.y)},getDistanceFrom(s,t,e,i){const n=qa(e-s),a=qa(i-t);return dl(n*n+a*a)},getMinDistanceFrom(s,t,e,i,n,a){return pl(an(s,t,e,i),an(e,i,n,a))},getAngle(s,t){return Ka(s,t)/N},getRotation(s,t,e,i){return i||(i=t),Ue.getRadianFrom(s.x,s.y,t.x,t.y,e.x,e.y,i.x,i.y)/N},getRadianFrom(s,t,e,i,n,a,r,h){r===void 0&&(r=e,h=i);let o=nn(t-i,s-e);const d=nn(a-h,n-r)-o;return d<-cl?d+zt:d},getAtan2(s,t){return nn(t.y-s.y,t.x-s.x)},getDistancePoint(s,t,e,i){const n=Ka(s,t);return t=i?t:{},t.x=s.x+Xa(n)*e,t.y=s.y+Va(n)*e,t},reset(s){}},Ue=R,{getDistanceFrom:an,copy:rn,getAtan2:Ka}=Ue;class Is{constructor(t,e){this.set(t,e)}set(t,e){return typeof t=="object"?R.copy(this,t):R.set(this,t,e),this}get(){const{x:t,y:e}=this;return{x:t,y:e}}clone(){return new Is(this)}move(t,e){return R.move(this,t,e),this}scale(t,e){return R.scale(this,t,e),this}scaleOf(t,e,i){return R.scaleOf(this,t,e,i),this}rotate(t,e){return R.rotate(this,t,e),this}rotateOf(t,e){return R.rotate(this,e,t),this}getRotation(t,e,i){return R.getRotation(this,t,e,i)}toInnerOf(t,e){return R.toInnerOf(this,t,e),this}toOuterOf(t,e){return R.toOuterOf(this,t,e),this}getCenter(t){return new Is(R.getCenter(this,t))}getDistance(t){return R.getDistance(this,t)}getDistancePoint(t,e,i){return new Is(R.getDistancePoint(this,t,e,i))}getAngle(t){return R.getAngle(this,t)}getAtan2(t){return R.getAtan2(this,t)}reset(){return this}}new Is;class Oe{constructor(t,e,i,n,a,r){this.set(t,e,i,n,a,r)}set(t,e,i,n,a,r){return typeof t=="object"?S.copy(this,t):S.set(this,t,e,i,n,a,r),this}setWith(t){return S.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:e,c:i,d:n,e:a,f:r}=this;return{a:t,b:e,c:i,d:n,e:a,f:r}}clone(){return new Oe(this)}translate(t,e){return S.translate(this,t,e),this}translateInner(t,e){return S.translateInner(this,t,e),this}scale(t,e){return S.scale(this,t,e),this}scaleWith(t,e){return S.scale(this,t,e),this.scaleX*=t,this.scaleY*=e||t,this}scaleOfOuter(t,e,i){return S.scaleOfOuter(this,t,e,i),this}scaleOfInner(t,e,i){return S.scaleOfInner(this,t,e,i),this}rotate(t){return S.rotate(this,t),this}rotateOfOuter(t,e){return S.rotateOfOuter(this,t,e),this}rotateOfInner(t,e){return S.rotateOfInner(this,t,e),this}skew(t,e){return S.skew(this,t,e),this}skewOfOuter(t,e,i){return S.skewOfOuter(this,t,e,i),this}skewOfInner(t,e,i){return S.skewOfInner(this,t,e,i),this}multiply(t){return S.multiply(this,t),this}multiplyParent(t){return S.multiplyParent(this,t),this}divide(t){return S.divide(this,t),this}divideParent(t){return S.divideParent(this,t),this}invert(){return S.invert(this),this}invertWith(){return S.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,e,i){S.toOuterPoint(this,t,e,i)}toInnerPoint(t,e,i){S.toInnerPoint(this,t,e,i)}setLayout(t,e){return S.setLayout(this,t,e),this}getLayout(t,e){return S.getLayout(this,t,e)}withScale(t,e){return S.withScale(this,t,e)}reset(){S.reset(this)}}new Oe;const qs={tempPointBounds:{},setPoint(s,t,e){s.minX=s.maxX=t,s.minY=s.maxY=e},addPoint(s,t,e){s.minX=t<s.minX?t:s.minX,s.minY=e<s.minY?e:s.minY,s.maxX=t>s.maxX?t:s.maxX,s.maxY=e>s.maxY?e:s.maxY},addBounds(s,t,e,i,n){Za(s,t,e),Za(s,t+i,e+n)},copy(s,t){s.minX=t.minX,s.minY=t.minY,s.maxX=t.maxX,s.maxY=t.maxY},addPointBounds(s,t){s.minX=t.minX<s.minX?t.minX:s.minX,s.minY=t.minY<s.minY?t.minY:s.minY,s.maxX=t.maxX>s.maxX?t.maxX:s.maxX,s.maxY=t.maxY>s.maxY?t.maxY:s.maxY},toBounds(s,t){t.x=s.minX,t.y=s.minY,t.width=s.maxX-s.minX,t.height=s.maxY-s.minY}},{addPoint:Za}=qs,{tempPointBounds:Be,setPoint:Qa,addPoint:ni,toBounds:Ja}=qs,{toOuterPoint:ai}=S,{float:ri,fourNumber:ul}=Gt,{floor:tr,ceil:hi}=Math;let te,ee,We,$e;const ue={},Tt={},C={tempBounds:{},set(s,t=0,e=0,i=0,n=0){s.x=t,s.y=e,s.width=i,s.height=n},copy(s,t){s.x=t.x,s.y=t.y,s.width=t.width,s.height=t.height},copyAndSpread(s,t,e,i){if(e instanceof Array){const n=ul(e);i?I.set(s,t.x+n[3],t.y+n[0],t.width-n[1]-n[3],t.height-n[2]-n[0]):I.set(s,t.x-n[3],t.y-n[0],t.width+n[1]+n[3],t.height+n[2]+n[0])}else i&&(e=-e),I.set(s,t.x-e,t.y-e,t.width+e*2,t.height+e*2)},minX(s){return s.width>0?s.x:s.x+s.width},minY(s){return s.height>0?s.y:s.y+s.height},maxX(s){return s.width>0?s.x+s.width:s.x},maxY(s){return s.height>0?s.y+s.height:s.y},move(s,t,e){s.x+=t,s.y+=e},getByMove(s,t,e){return s=Object.assign({},s),I.move(s,t,e),s},toOffsetOutBounds(s,t,e){t?sr(t,s):t=s,e?(t.offsetX=-(I.maxX(e)-s.x),t.offsetY=-(I.maxY(e)-s.y)):(t.offsetX=s.x+s.width,t.offsetY=s.y+s.height),I.move(t,-t.offsetX,-t.offsetY)},scale(s,t,e=t){R.scale(s,t,e),s.width*=t,s.height*=e},scaleOf(s,t,e,i=e){R.scaleOf(s,t,e,i),s.width*=e,s.height*=i},tempToOuterOf(s,t){return I.copy(I.tempBounds,s),I.toOuterOf(I.tempBounds,t),I.tempBounds},getOuterOf(s,t){return s=Object.assign({},s),I.toOuterOf(s,t),s},toOuterOf(s,t,e){if(e||(e=s),t.b===0&&t.c===0){const{a:i,d:n}=t;i>0?(e.width=s.width*i,e.x=t.e+s.x*i):(e.width=s.width*-i,e.x=t.e+s.x*i-e.width),n>0?(e.height=s.height*n,e.y=t.f+s.y*n):(e.height=s.height*-n,e.y=t.f+s.y*n-e.height)}else ue.x=s.x,ue.y=s.y,ai(t,ue,Tt),Qa(Be,Tt.x,Tt.y),ue.x=s.x+s.width,ai(t,ue,Tt),ni(Be,Tt.x,Tt.y),ue.y=s.y+s.height,ai(t,ue,Tt),ni(Be,Tt.x,Tt.y),ue.x=s.x,ai(t,ue,Tt),ni(Be,Tt.x,Tt.y),Ja(Be,e)},toInnerOf(s,t,e){e||(e=s),I.move(e,-t.e,-t.f),I.scale(e,1/t.a,1/t.d)},getFitMatrix(s,t,e=1){const i=Math.min(e,Math.min(s.width/t.width,s.height/t.height));return new Oe(i,0,0,i,-t.x*i,-t.y*i)},getSpread(s,t){const e={};return I.copyAndSpread(e,s,t),e},spread(s,t){I.copyAndSpread(s,s,t)},shrink(s,t){I.copyAndSpread(s,s,t,!0)},ceil(s){const{x:t,y:e}=s;s.x=tr(s.x),s.y=tr(s.y),s.width=t>s.x?hi(s.width+t-s.x):hi(s.width),s.height=e>s.y?hi(s.height+e-s.y):hi(s.height)},unsign(s){s.width<0&&(s.x+=s.width,s.width=-s.width),s.height<0&&(s.y+=s.height,s.height=-s.height)},float(s,t){s.x=ri(s.x,t),s.y=ri(s.y,t),s.width=ri(s.width,t),s.height=ri(s.height,t)},add(s,t,e){te=s.x+s.width,ee=s.y+s.height,We=t.x,$e=t.y,e||(We+=t.width,$e+=t.height),te=te>We?te:We,ee=ee>$e?ee:$e,s.x=s.x<t.x?s.x:t.x,s.y=s.y<t.y?s.y:t.y,s.width=te-s.x,s.height=ee-s.y},addList(s,t){I.setListWithFn(s,t,void 0,!0)},setList(s,t,e=!1){I.setListWithFn(s,t,void 0,e)},addListWithFn(s,t,e){I.setListWithFn(s,t,e,!0)},setListWithFn(s,t,e,i=!1){let n,a=!0;for(let r=0,h=t.length;r<h;r++)n=e?e(t[r]):t[r],n&&(n.width||n.height)&&(a?(a=!1,i||sr(s,n)):er(s,n));a&&I.reset(s)},setPoints(s,t){t.forEach((e,i)=>i===0?Qa(Be,e.x,e.y):ni(Be,e.x,e.y)),Ja(Be,s)},setPoint(s,t){I.set(s,t.x,t.y)},addPoint(s,t){er(s,t,!0)},getPoints(s){const{x:t,y:e,width:i,height:n}=s;return[{x:t,y:e},{x:t+i,y:e},{x:t+i,y:e+n},{x:t,y:e+n}]},hitRadiusPoint(s,t,e){return e&&(t=R.tempToInnerRadiusPointOf(t,e)),t.x>=s.x-t.radiusX&&t.x<=s.x+s.width+t.radiusX&&t.y>=s.y-t.radiusY&&t.y<=s.y+s.height+t.radiusY},hitPoint(s,t,e){return e&&(t=R.tempToInnerOf(t,e)),t.x>=s.x&&t.x<=s.x+s.width&&t.y>=s.y&&t.y<=s.y+s.height},hit(s,t,e){return e&&(t=I.tempToOuterOf(t,e)),!(s.y+s.height<t.y||t.y+t.height<s.y||s.x+s.width<t.x||t.x+t.width<s.x)},includes(s,t,e){return e&&(t=I.tempToOuterOf(t,e)),s.x<=t.x&&s.y<=t.y&&s.x+s.width>=t.x+t.width&&s.y+s.height>=t.y+t.height},getIntersectData(s,t,e){if(e&&(t=I.tempToOuterOf(t,e)),!I.hit(s,t))return io();let{x:i,y:n,width:a,height:r}=t;return te=i+a,ee=n+r,We=s.x+s.width,$e=s.y+s.height,i=i>s.x?i:s.x,n=n>s.y?n:s.y,te=te<We?te:We,ee=ee<$e?ee:$e,a=te-i,r=ee-n,{x:i,y:n,width:a,height:r}},intersect(s,t,e){I.copy(s,I.getIntersectData(s,t,e))},isSame(s,t){return s.x===t.x&&s.y===t.y&&s.width===t.width&&s.height===t.height},isEmpty(s){return s.x===0&&s.y===0&&s.width===0&&s.height===0},reset(s){I.set(s)}},I=C,{add:er,copy:sr}=I;class et{get minX(){return C.minX(this)}get minY(){return C.minY(this)}get maxX(){return C.maxX(this)}get maxY(){return C.maxY(this)}constructor(t,e,i,n){this.set(t,e,i,n)}set(t,e,i,n){return typeof t=="object"?C.copy(this,t):C.set(this,t,e,i,n),this}get(){const{x:t,y:e,width:i,height:n}=this;return{x:t,y:e,width:i,height:n}}clone(){return new et(this)}move(t,e){return C.move(this,t,e),this}scale(t,e){return C.scale(this,t,e),this}scaleOf(t,e,i){return C.scaleOf(this,t,e,i),this}toOuterOf(t,e){return C.toOuterOf(this,t,e),this}toInnerOf(t,e){return C.toInnerOf(this,t,e),this}getFitMatrix(t,e){return C.getFitMatrix(this,t,e)}spread(t){return C.spread(this,t),this}shrink(t){return C.shrink(this,t),this}ceil(){return C.ceil(this),this}unsign(){return C.unsign(this),this}float(t){return C.float(this,t),this}add(t){return C.add(this,t),this}addList(t){return C.setList(this,t,!0),this}setList(t){return C.setList(this,t),this}addListWithFn(t,e){return C.setListWithFn(this,t,e,!0),this}setListWithFn(t,e){return C.setListWithFn(this,t,e),this}setPoint(t){return C.setPoint(this,t),this}setPoints(t){return C.setPoints(this,t),this}addPoint(t){return C.addPoint(this,t),this}getPoints(){return C.getPoints(this)}hitPoint(t,e){return C.hitPoint(this,t,e)}hitRadiusPoint(t,e){return C.hitRadiusPoint(this,t,e)}hit(t,e){return C.hit(this,t,e)}includes(t,e){return C.includes(this,t,e)}intersect(t,e){return C.intersect(this,t,e),this}getIntersect(t,e){return new et(C.getIntersectData(this,t,e))}isSame(t){return C.isSame(this,t)}isEmpty(){return C.isEmpty(this)}reset(){C.reset(this)}}const $=new et;class fl{constructor(t,e,i,n,a,r){typeof t=="object"?this.copy(t):this.set(t,e,i,n,a,r)}set(t=0,e=0,i=0,n=0,a=0,r=0){this.top=t,this.right=e,this.bottom=i,this.left=n,this.width=a,this.height=r}copy(t){const{top:e,right:i,bottom:n,left:a,width:r,height:h}=t;this.set(e,i,n,a,r,h)}getBoundsFrom(t){const{top:e,right:i,bottom:n,left:a,width:r,height:h}=this;return new et(a,e,r||t.width-a-i,h||t.height-e-n)}}var ia;(function(s){s[s.top=0]="top",s[s.right=1]="right",s[s.bottom=2]="bottom",s[s.left=3]="left"})(ia||(ia={}));var na;(function(s){s[s.topLeft=0]="topLeft",s[s.top=1]="top",s[s.topRight=2]="topRight",s[s.right=3]="right",s[s.bottomRight=4]="bottomRight",s[s.bottom=5]="bottom",s[s.bottomLeft=6]="bottomLeft",s[s.left=7]="left",s[s.center=8]="center",s[s["top-left"]=0]="top-left",s[s["top-right"]=2]="top-right",s[s["bottom-right"]=4]="bottom-right",s[s["bottom-left"]=6]="bottom-left"})(na||(na={}));const Aa=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];Aa.forEach(s=>s.type="percent");const ws={directionData:Aa,tempPoint:{},get:ir,toPoint(s,t,e,i,n){e||(e={});const a=ir(s);e.x=a.x,e.y=a.y,a.type==="percent"&&(e.x*=t.width,e.y*=t.height,n&&(e.x-=n.x,e.y-=n.y,a.x&&(e.x-=a.x===1?n.width:a.x===.5?a.x*n.width:0),a.y&&(e.y-=a.y===1?n.height:a.y===.5?a.y*n.height:0))),i||(e.x+=t.x,e.y+=t.y)}};function ir(s){return typeof s=="string"?Aa[na[s]]:s}const{toPoint:_l}=ws,no={toPoint(s,t,e,i,n){_l(s,e,i,n,t)}},gl={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1};class H{constructor(t){this.repeatMap={},this.name=t}static get(t){return new H(t)}static set filter(t){this.filterList=nr(t)}static set exclude(t){this.excludeList=nr(t)}log(...t){if(ze.enable){if(ze.filterList.length&&ze.filterList.every(e=>e!==this.name)||ze.excludeList.length&&ze.excludeList.some(e=>e===this.name))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){ze.enable&&this.warn(...t)}warn(...t){ze.showWarn&&console.warn(this.name,...t)}repeat(t,...e){this.repeatMap[t]||(this.warn("repeat:"+t,...e),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(e){console.error(this.name,...t,e)}}}H.filterList=[];H.excludeList=[];H.showWarn=!0;function nr(s){return s?typeof s=="string"&&(s=[s]):s=[],s}const ze=H,kl=H.get("RunTime"),Xt={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(s,t){const e=xe.create(xe.RUNTIME);return Ot.currentId=Ot.idMap[e]=t?performance.now():Date.now(),Ot.currentName=Ot.nameMap[e]=s,Ot.nameToIdMap[s]=e,e},end(s,t){const e=Ot.idMap[s],i=Ot.nameMap[s],n=t?(performance.now()-e)/1e3:Date.now()-e;Ot.idMap[s]=Ot.nameMap[s]=Ot.nameToIdMap[i]=void 0,kl.log(i,n,"ms")},endOfName(s,t){const e=Ot.nameToIdMap[s];e!==void 0&&Ot.end(e,t)}},Ot=Xt,yl=H.get("UICreator"),$i={list:{},register(s){const{__tag:t}=s.prototype;hn[t]?yl.repeat(t):hn[t]=s},get(s,t,e,i,n,a){const r=new hn[s](t);return e!==void 0&&(r.x=e,i&&(r.y=i),n&&(r.width=n),a&&(r.height=a)),r}},{list:hn}=$i,El=H.get("EventCreator"),ks={nameList:{},register(s){let t;Object.keys(s).forEach(e=>{t=s[e],typeof t=="string"&&(Fs[t]?El.repeat(t):Fs[t]=s)})},changeName(s,t){const e=Fs[s];if(e){const i=Object.keys(e).find(n=>e[n]===s);i&&(e[i]=t,Fs[t]=e)}},has(s){return!!this.nameList[s]},get(s,...t){return new Fs[s](...t)}},{nameList:Fs}=ks;class ao{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let e;const{list:i}=this;for(let a=0,r=i.length;a<r;a++)if(e=i[a],e.recycled&&e.isSameSize(t))return e.recycled=!1,e.manager||(e.manager=this),e;const n=pt.canvas(t);return this.add(n),n}recycle(t){t.recycled=!0}clearRecycled(){let t;const e=[];for(let i=0,n=this.list.length;i<n;i++)t=this.list[i],t.recycled?t.destroy():e.push(t);this.list=e}clear(){this.list.forEach(t=>{t.destroy()}),this.list.length=0}destroy(){this.clear()}}const _t={default(s,t){return on(t,s),on(s,t),s},assign(s,t){let e;Object.keys(t).forEach(i=>{var n;e=t[i],(e==null?void 0:e.constructor)===Object&&((n=s[i])===null||n===void 0?void 0:n.constructor)===Object?on(s[i],t[i]):s[i]=t[i]})},copyAttrs(s,t,e){return e.forEach(i=>{t[i]!==void 0&&(s[i]=t[i])}),s},clone(s){return JSON.parse(JSON.stringify(s))},toMap(s){const t={};for(let e=0,i=s.length;e<i;e++)t[s[e]]=!0;return t}},{assign:on}=_t;class ro{get __useNaturalRatio(){return!0}get __isLinePath(){return this.path&&this.path.length===6}get __blendMode(){if(this.eraser&&this.eraser!=="path")return"destination-out";const{blendMode:t}=this;return t==="pass-through"?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const e=this.__input[t];if(e!==void 0)return e}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:e}=this;let i;for(let n in this)n[0]!=="_"&&(i=e?e[n]:void 0,t[n]=i===void 0?this[n]:i);return t}__setInput(t,e){this.__input||(this.__input={}),this.__input[t]=e}__getInput(t){if(this.__input){const e=this.__input[t];if(e!==void 0)return e}if(!(t==="path"&&!this.__pathInputed))return this["_"+t]}__removeInput(t){this.__input&&this.__input[t]!==void 0&&(this.__input[t]=void 0)}__getInputData(t,e){const i={};if(t)if(t instanceof Array)for(let n of t)i[n]=this.__getInput(n);else for(let n in t)i[n]=this.__getInput(n);else{let n,a,{__input:r}=this;i.tag=this.__leaf.tag;for(let h in this)if(h[0]!=="_"&&(n=this["_"+h],n!==void 0)){if(h==="path"&&!this.__pathInputed)continue;a=r?r[h]:void 0,i[h]=a===void 0?n:a}}if(e&&e.matrix){const{a:n,b:a,c:r,d:h,e:o,f:l}=this.__leaf.__localMatrix;i.matrix={a:n,b:a,c:r,d:h,e:o,f:l}}return i}__setMiddle(t,e){this.__middle||(this.__middle={}),this.__middle[t]=e}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if(t.blendMode==="pass-through"){const e=this.__leaf;t.opacity<1&&e.isBranch||e.__hasEraser||t.eraser?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}var aa;(function(s){s[s.No=0]="No",s[s.Yes=1]="Yes",s[s.NoAndSkip=2]="NoAndSkip",s[s.YesAndSkip=3]="YesAndSkip"})(aa||(aa={}));function F(s,t,e,i){var n=arguments.length,a=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,t,e,i);else for(var h=s.length-1;h>=0;h--)(r=s[h])&&(a=(n<3?r(a):n>3?r(t,e,a):r(t,e))||a);return n>3&&a&&Object.defineProperty(t,e,a),a}function ho(s,t,e,i){function n(a){return a instanceof e?a:new e(function(r){r(a)})}return new(e||(e=Promise))(function(a,r){function h(d){try{l(i.next(d))}catch(_){r(_)}}function o(d){try{l(i.throw(d))}catch(_){r(_)}}function l(d){d.done?a(d.value):n(d.value).then(h,o)}l((i=i.apply(s,[])).next())})}function q(s){return(t,e)=>{s||(s=e),Object.defineProperty(t,e,{get(){return this.context[s]},set(i){this.context[s]=i}})}}const oo=[];function L(){return(s,t)=>{oo.push(t)}}const ml=[];let v=class{set blendMode(t){t==="normal"&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||ml)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;oo.forEach(e=>{t=this.context[e],t&&(this[e]=t.bind(this.context))}),this.textBaseline="alphabetic"}setTransform(t,e,i,n,a,r){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,e,i,n,a,r){typeof t=="object"?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,e,i,n,a,r)}translate(t,e){}scale(t,e){}rotate(t){}fill(t,e){}stroke(t){}clip(t,e){}fillRect(t,e,i,n){}strokeRect(t,e,i,n){}clearRect(t,e,i,n){}drawImage(t,e,i,n,a,r,h,o,l){switch(arguments.length){case 9:if(e<0){const d=-e/n*o;n+=e,e=0,r+=d,o-=d}if(i<0){const d=-i/a*l;a+=i,i=0,h+=d,l-=d}this.context.drawImage(t,e,i,n,a,r,h,o,l);break;case 5:this.context.drawImage(t,e,i,n,a);break;case 3:this.context.drawImage(t,e,i)}}beginPath(){}moveTo(t,e){}lineTo(t,e){}bezierCurveTo(t,e,i,n,a,r){}quadraticCurveTo(t,e,i,n){}closePath(){}arc(t,e,i,n,a,r){}arcTo(t,e,i,n,a){}ellipse(t,e,i,n,a,r,h,o){}rect(t,e,i,n){}roundRect(t,e,i,n,a){}createConicGradient(t,e,i){}createLinearGradient(t,e,i,n){}createPattern(t,e){}createRadialGradient(t,e,i,n,a,r){}fillText(t,e,i,n){}measureText(t){}strokeText(t,e,i,n){}destroy(){this.context=null}};F([q("imageSmoothingEnabled")],v.prototype,"smooth",void 0);F([q("imageSmoothingQuality")],v.prototype,"smoothLevel",void 0);F([q("globalAlpha")],v.prototype,"opacity",void 0);F([q()],v.prototype,"fillStyle",void 0);F([q()],v.prototype,"strokeStyle",void 0);F([q("lineWidth")],v.prototype,"strokeWidth",void 0);F([q("lineCap")],v.prototype,"strokeCap",void 0);F([q("lineJoin")],v.prototype,"strokeJoin",void 0);F([q("lineDashOffset")],v.prototype,"dashOffset",void 0);F([q()],v.prototype,"miterLimit",void 0);F([q()],v.prototype,"shadowBlur",void 0);F([q()],v.prototype,"shadowColor",void 0);F([q()],v.prototype,"shadowOffsetX",void 0);F([q()],v.prototype,"shadowOffsetY",void 0);F([q()],v.prototype,"filter",void 0);F([q()],v.prototype,"font",void 0);F([q()],v.prototype,"fontKerning",void 0);F([q()],v.prototype,"fontStretch",void 0);F([q()],v.prototype,"fontVariantCaps",void 0);F([q()],v.prototype,"textAlign",void 0);F([q()],v.prototype,"textBaseline",void 0);F([q()],v.prototype,"textRendering",void 0);F([q()],v.prototype,"wordSpacing",void 0);F([q()],v.prototype,"letterSpacing",void 0);F([q()],v.prototype,"direction",void 0);F([L()],v.prototype,"setTransform",null);F([L()],v.prototype,"resetTransform",null);F([L()],v.prototype,"getTransform",null);F([L()],v.prototype,"save",null);F([L()],v.prototype,"restore",null);F([L()],v.prototype,"translate",null);F([L()],v.prototype,"scale",null);F([L()],v.prototype,"rotate",null);F([L()],v.prototype,"fill",null);F([L()],v.prototype,"stroke",null);F([L()],v.prototype,"clip",null);F([L()],v.prototype,"fillRect",null);F([L()],v.prototype,"strokeRect",null);F([L()],v.prototype,"clearRect",null);F([L()],v.prototype,"beginPath",null);F([L()],v.prototype,"moveTo",null);F([L()],v.prototype,"lineTo",null);F([L()],v.prototype,"bezierCurveTo",null);F([L()],v.prototype,"quadraticCurveTo",null);F([L()],v.prototype,"closePath",null);F([L()],v.prototype,"arc",null);F([L()],v.prototype,"arcTo",null);F([L()],v.prototype,"ellipse",null);F([L()],v.prototype,"rect",null);F([L()],v.prototype,"roundRect",null);F([L()],v.prototype,"createConicGradient",null);F([L()],v.prototype,"createLinearGradient",null);F([L()],v.prototype,"createPattern",null);F([L()],v.prototype,"createRadialGradient",null);F([L()],v.prototype,"fillText",null);F([L()],v.prototype,"measureText",null);F([L()],v.prototype,"strokeText",null);const{copy:wl}=S,xl={width:1,height:1,pixelRatio:1},Ee=["width","height","pixelRatio"];class Sa extends v{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio}get pixelHeight(){return this.height*this.pixelRatio}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,e){super(),this.size={},this.worldTransform={},t||(t=xl),t.pixelRatio||(t.pixelRatio=b.devicePixelRatio),this.manager=e,this.innerId=xe.create(xe.CNAVAS);const{width:i,height:n,pixelRatio:a}=t;this.autoLayout=!i||!n,this.size.pixelRatio=a,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:e}=this.config;this.context=e?t.getContext("2d",e):t.getContext("2d"),this.__bindContext()}export(t,e){}toBlob(t,e){}toDataURL(t,e){}saveAs(t,e){}resize(t){if(this.isSameSize(t))return;let e;this.context&&!this.unreal&&this.width&&(e=this.getSameCanvas(),e.copyWorld(this)),_t.copyAttrs(this.size,t,Ee),this.size.pixelRatio||(this.size.pixelRatio=1),this.bounds=new et(0,0,this.width,this.height),this.unreal||(this.updateViewSize(),this.smooth=this.config.smooth),this.updateClientBounds(),this.context&&!this.unreal&&e&&(this.clearWorld(e.bounds),this.copyWorld(e),e.recycle())}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,e){}stopAutoLayout(){}setCursor(t){}setWorld(t,e){const{pixelRatio:i}=this,n=this.worldTransform;if(e){const{a,b:r,c:h,d:o,e:l,f:d}=e;this.setTransform(n.a=(t.a*a+t.b*h)*i,n.b=(t.a*r+t.b*o)*i,n.c=(t.c*a+t.d*h)*i,n.d=(t.c*r+t.d*o)*i,n.e=(t.e*a+t.f*h+l)*i,n.f=(t.e*r+t.f*o+d)*i)}else this.setTransform(n.a=t.a*i,n.b=t.b*i,n.c=t.c*i,n.d=t.d*i,n.e=t.e*i,n.f=t.f*i)}useWorldTransform(t){t&&(this.worldTransform=t);const e=this.worldTransform;e&&this.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}setStroke(t,e,i){e&&(this.strokeWidth=e),t&&(this.strokeStyle=t),i&&this.setStrokeOptions(i)}setStrokeOptions(t){this.strokeCap=t.strokeCap==="none"?"butt":t.strokeCap,this.strokeJoin=t.strokeJoin,this.dashPattern=t.dashPattern,this.dashOffset=t.dashOffset,this.miterLimit=t.miterLimit}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,e){return!0}hitStroke(t,e){return!0}hitPixel(t,e,i=1){return!0}setWorldShadow(t,e,i,n){const{pixelRatio:a}=this;this.shadowOffsetX=t*a,this.shadowOffsetY=e*a,this.shadowBlur=i*a,this.shadowColor=n||"black"}setWorldBlur(t){const{pixelRatio:e}=this;this.filter=`blur(${t*e}px)`}copyWorld(t,e,i,n){if(n&&(this.blendMode=n),e){const{pixelRatio:a}=this;i||(i=e),this.drawImage(t.view,e.x*a,e.y*a,e.width*a,e.height*a,i.x*a,i.y*a,i.width*a,i.height*a)}else this.drawImage(t.view,0,0);n&&(this.blendMode="source-over")}copyWorldToInner(t,e,i,n){if(n&&(this.blendMode=n),e.b||e.c)this.save(),this.resetTransform(),this.copyWorld(t,e,C.tempToOuterOf(i,e)),this.restore();else{const{pixelRatio:a}=this;this.drawImage(t.view,e.x*a,e.y*a,e.width*a,e.height*a,i.x,i.y,i.width,i.height)}n&&(this.blendMode="source-over")}copyWorldByReset(t,e,i,n,a){this.resetTransform(),this.copyWorld(t,e,i,n),a||this.useWorldTransform()}useMask(t,e,i){this.copyWorld(t,e,i,"destination-in")}useEraser(t,e,i){this.copyWorld(t,e,i,"destination-out")}fillWorld(t,e,i){i&&(this.blendMode=i),this.fillStyle=e,$.set(t).scale(this.pixelRatio),this.fillRect($.x,$.y,$.width,$.height),i&&(this.blendMode="source-over")}strokeWorld(t,e,i){i&&(this.blendMode=i),this.strokeStyle=e,$.set(t).scale(this.pixelRatio),this.strokeRect($.x,$.y,$.width,$.height),i&&(this.blendMode="source-over")}clearWorld(t,e){$.set(t).scale(this.pixelRatio),e&&$.ceil(),this.clearRect($.x,$.y,$.width,$.height)}clipWorld(t,e){this.beginPath(),$.set(t).scale(this.pixelRatio),e&&$.ceil(),this.rect($.x,$.y,$.width,$.height),this.clip()}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}isSameSize(t){return this.width===t.width&&this.height===t.height&&this.pixelRatio===t.pixelRatio}getSameCanvas(t,e){const i=this.manager?this.manager.get(this.size):pt.canvas(Object.assign({},this.size));return i.save(),t&&(wl(i.worldTransform,this.worldTransform),i.useWorldTransform()),e&&(i.smooth=this.smooth),i}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t,!0):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const ae={creator:{},parse(s,t){},convertToCanvasData(s,t){}},lo={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},Ht=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},lo),po={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},co={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},bl=Object.assign(Object.assign({},co),lo),Ai=Ht,uo={};for(let s in Ai)uo[Ai[s]]=s;const fo={};for(let s in Ai)fo[Ai[s]]=po[s];const _o={drawRoundRect(s,t,e,i,n,a){const r=Gt.fourNumber(a,Math.min(i/2,n/2)),h=t+i,o=e+n;r[0]?s.moveTo(t+r[0],e):s.moveTo(t,e),r[1]?s.arcTo(h,e,h,o,r[1]):s.lineTo(h,e),r[2]?s.arcTo(h,o,t,o,r[2]):s.lineTo(h,o),r[3]?s.arcTo(t,o,t,e,r[3]):s.lineTo(t,o),r[0]?s.arcTo(t,e,h,e,r[0]):s.lineTo(t,e)}},{sin:as,cos:vs,atan2:ar,ceil:Fl,abs:ln,PI:rr,sqrt:hr,pow:oi}=Math,{setPoint:dn,addPoint:li}=qs,{set:di}=R,{M:vl,L:pn,C:cn,Q:or,Z:Cl}=Ht,un={},Xe={points(s,t,e,i){if(s.push(vl,t[0],t[1]),e&&t.length>5){let n,a,r,h,o,l,d,_,u,p,f,g,m,E=t.length;const k=e===!0?.5:e;i&&(t=[t[E-2],t[E-1],...t,t[0],t[1],t[2],t[3]],E=t.length);for(let w=2;w<E-2;w+=2)n=t[w-2],a=t[w-1],r=t[w],h=t[w+1],o=t[w+2],l=t[w+3],f=hr(oi(r-n,2)+oi(h-a,2)),g=hr(oi(o-r,2)+oi(l-h,2)),m=f+g,f=k*f/m,g=k*g/m,o-=n,l-=a,d=r-f*o,_=h-f*l,w===2?i||s.push(or,d,_,r,h):s.push(cn,u,p,d,_,r,h),u=r+g*o,p=h+g*l;i||s.push(or,u,p,t[E-2],t[E-1])}else for(let n=2,a=t.length;n<a;n+=2)s.push(pn,t[n],t[n+1]);i&&s.push(Cl)},rect(s,t,e,i,n){ae.creator.path=s,ae.creator.moveTo(t,e).lineTo(t+i,e).lineTo(t+i,e+n).lineTo(t,e+n).lineTo(t,e)},roundRect(s,t,e,i,n,a){ae.creator.path=[],_o.drawRoundRect(ae.creator,t,e,i,n,a),s.push(...ae.convertToCanvasData(ae.creator.path,!0))},arcTo(s,t,e,i,n,a,r,h,o,l,d){const _=i-t,u=n-e,p=a-i,f=r-n;let g=ar(u,_),m=ar(f,p),E=m-g;if(E<0&&(E+=zt),E===rr||ln(_+u)<1e-12||ln(p+f)<1e-12){s&&s.push(pn,i,n),o&&(dn(o,t,e),li(o,i,n)),d&&di(d,t,e),l&&di(l,i,n);return}const k=_*f-p*u<0,w=k?-1:1,x=h/vs(E/2),A=i+x*vs(g+E/2+ds*w),M=n+x*as(g+E/2+ds*w);return g-=ds*w,m-=ds*w,pr(s,A,M,h,h,0,g/N,m/N,k,o,l,d)},arc(s,t,e,i,n,a,r,h,o,l){return pr(s,t,e,i,i,0,n,a,r,h,o,l)},ellipse(s,t,e,i,n,a,r,h,o,l,d,_){const u=a*N,p=as(u),f=vs(u);let g=r*N,m=h*N;g>rr&&(g-=zt),m<0&&(m+=zt);let E=m-g;E<0?E+=zt:E>zt&&(E-=zt),o&&(E-=zt);const k=Fl(ln(E/ds)),w=E/k,x=as(w/4),A=8/3*x*x/as(w/2);m=g+w;let M=vs(g),P=as(g),W,J,it,Y,tt,j,rt,V,T=it=f*i*M-p*n*P,ht=Y=p*i*M+f*n*P,ot=t+it,nt=e+Y;s&&s.push(pn,ot,nt),l&&dn(l,ot,nt),_&&di(_,ot,nt);for(let Pt=0;Pt<k;Pt++)W=vs(m),J=as(m),it=f*i*W-p*n*J,Y=p*i*W+f*n*J,tt=t+T-A*(f*i*P+p*n*M),j=e+ht-A*(p*i*P-f*n*M),rt=t+it+A*(f*i*J+p*n*W),V=e+Y+A*(p*i*J-f*n*W),s&&s.push(cn,tt,j,rt,V,t+it,e+Y),l&&dr(t+T,e+ht,tt,j,rt,V,t+it,e+Y,l,!0),T=it,ht=Y,M=W,P=J,g=m,m+=w;d&&di(d,t+it,e+Y)},quadraticCurveTo(s,t,e,i,n,a,r){s.push(cn,(t+2*i)/3,(e+2*n)/3,(a+2*i)/3,(r+2*n)/3,a,r)},toTwoPointBoundsByQuadraticCurve(s,t,e,i,n,a,r,h){dr(s,t,(s+2*e)/3,(t+2*i)/3,(n+2*e)/3,(a+2*i)/3,n,a,r,h)},toTwoPointBounds(s,t,e,i,n,a,r,h,o,l){const d=[];let _,u,p,f,g,m,E,k,w=s,x=e,A=n,M=r;for(let P=0;P<2;++P){if(P==1&&(w=t,x=i,A=a,M=h),_=-3*w+9*x-9*A+3*M,u=6*w-12*x+6*A,p=3*x-3*w,Math.abs(_)<1e-12){if(Math.abs(u)<1e-12)continue;f=-p/u,0<f&&f<1&&d.push(f);continue}E=u*u-4*p*_,k=Math.sqrt(E),!(E<0)&&(g=(-u+k)/(2*_),0<g&&g<1&&d.push(g),m=(-u-k)/(2*_),0<m&&m<1&&d.push(m))}l?li(o,s,t):dn(o,s,t),li(o,r,h);for(let P=0,W=d.length;P<W;P++)lr(d[P],s,t,e,i,n,a,r,h,un),li(o,un.x,un.y)},getPointAndSet(s,t,e,i,n,a,r,h,o,l){const d=1-s,_=d*d*d,u=3*d*d*s,p=3*d*s*s,f=s*s*s;l.x=_*t+u*i+p*a+f*h,l.y=_*e+u*n+p*r+f*o},getPoint(s,t,e,i,n,a,r,h,o){const l={};return lr(s,t,e,i,n,a,r,h,o,l),l}},{getPointAndSet:lr,toTwoPointBounds:dr,ellipse:pr}=Xe,{sin:Bl,cos:Rl,sqrt:cr,atan2:ur}=Math,{ellipse:Al}=Xe,Sl={ellipticalArc(s,t,e,i,n,a,r,h,o,l,d){const _=(o-t)/2,u=(l-e)/2,p=a*N,f=Bl(p),g=Rl(p),m=-g*_-f*u,E=-g*u+f*_,k=i*i,w=n*n,x=E*E,A=m*m,M=k*w-k*x-w*A;let P=0;if(M<0){const T=cr(1-M/(k*w));i*=T,n*=T}else P=(r===h?-1:1)*cr(M/(k*x+w*A));const W=P*i*E/n,J=-P*n*m/i,it=ur((E-J)/n,(m-W)/i),Y=ur((-E-J)/n,(-m-W)/i);let tt=Y-it;h===0&&tt>0?tt-=zt:h===1&&tt<0&&(tt+=zt);const j=t+_+g*W-f*J,rt=e+u+f*W+g*J,V=tt<0?1:0;d||b.ellipseToCurve?Al(s,j,rt,i,n,a,it/N,Y/N,V):i===n&&!a?s.push(Ht.O,j,rt,i,it/N,Y/N,V):s.push(Ht.G,j,rt,i,n,a,it/N,Y/N,V)}},{M:fr,m:Dl,L:pi,l:Pl,H:Tl,h:Ol,V:Ml,v:Ll,C:Cs,c:Il,S:fn,s:Wl,Q:Bs,q:$l,T:_n,t:zl,A:Nl,a:Hl,Z:_r,z:Gl,N:jl,D:Ul,X:Yl,G:Vl,F:Xl,O:ql,P:Kl,U:Zl}=Ht,{rect:Ql,roundRect:gr,arcTo:Jl,arc:kr,ellipse:yr,quadraticCurveTo:Er}=Xe,{ellipticalArc:td}=Sl,ed=H.get("PathConvert"),fe={},qe={current:{dot:0},stringify(s,t){let e=0,i=s.length,n,a="",r,h;for(;e<i;){r=s[e],n=fo[r],r===h?a+=" ":a+=uo[r];for(let o=1;o<n;o++)a+=Gt.float(s[e+o],t),o===n-1||(a+=" ");h=r,e+=n}return a},parse(s,t){let e,i,n,a="";const r=[],h=t?bl:co;for(let o=0,l=s.length;o<l;o++)i=s[o],gl[i]?(i==="."&&(Mt.dot&&(Ne(r,a),a=""),Mt.dot++),a==="0"&&i!=="."&&(Ne(r,a),a=""),a+=i):Ht[i]?(a&&(Ne(r,a),a=""),Mt.name=Ht[i],Mt.length=po[i],Mt.index=0,Ne(r,Mt.name),!e&&h[i]&&(e=!0)):i==="-"||i==="+"?n==="e"||n==="E"?a+=i:(a&&Ne(r,a),a=i):a&&(Ne(r,a),a=""),n=i;return a&&Ne(r,a),e?qe.toCanvasData(r,t):r},toCanvasData(s,t){let e=0,i=0,n=0,a=0,r=0,h=s.length,o,l,d,_,u;const p=[];for(;r<h;){switch(d=s[r],d){case Dl:s[r+1]+=e,s[r+2]+=i;case fr:e=s[r+1],i=s[r+2],p.push(fr,e,i),r+=3;break;case Ol:s[r+1]+=e;case Tl:e=s[r+1],p.push(pi,e,i),r+=2;break;case Ll:s[r+1]+=i;case Ml:i=s[r+1],p.push(pi,e,i),r+=2;break;case Pl:s[r+1]+=e,s[r+2]+=i;case pi:e=s[r+1],i=s[r+2],p.push(pi,e,i),r+=3;break;case Wl:s[r+1]+=e,s[r+2]+=i,s[r+3]+=e,s[r+4]+=i,d=fn;case fn:u=_===Cs||_===fn,n=u?e*2-o:s[r+1],a=u?i*2-l:s[r+2],o=s[r+1],l=s[r+2],e=s[r+3],i=s[r+4],p.push(Cs,n,a,o,l,e,i),r+=5;break;case Il:s[r+1]+=e,s[r+2]+=i,s[r+3]+=e,s[r+4]+=i,s[r+5]+=e,s[r+6]+=i,d=Cs;case Cs:o=s[r+3],l=s[r+4],e=s[r+5],i=s[r+6],p.push(Cs,s[r+1],s[r+2],o,l,e,i),r+=7;break;case zl:s[r+1]+=e,s[r+2]+=i,d=_n;case _n:u=_===Bs||_===_n,o=u?e*2-o:s[r+1],l=u?i*2-l:s[r+2],t?Er(p,e,i,o,l,s[r+1],s[r+2]):p.push(Bs,o,l,s[r+1],s[r+2]),e=s[r+1],i=s[r+2],r+=3;break;case $l:s[r+1]+=e,s[r+2]+=i,s[r+3]+=e,s[r+4]+=i,d=Bs;case Bs:o=s[r+1],l=s[r+2],t?Er(p,e,i,o,l,s[r+3],s[r+4]):p.push(Bs,o,l,s[r+3],s[r+4]),e=s[r+3],i=s[r+4],r+=5;break;case Hl:s[r+6]+=e,s[r+7]+=i;case Nl:td(p,e,i,s[r+1],s[r+2],s[r+3],s[r+4],s[r+5],s[r+6],s[r+7],t),e=s[r+6],i=s[r+7],r+=8;break;case Gl:case _r:p.push(_r),r++;break;case jl:e=s[r+1],i=s[r+2],t?Ql(p,e,i,s[r+3],s[r+4]):Re(p,s,r,5),r+=5;break;case Ul:e=s[r+1],i=s[r+2],t?gr(p,e,i,s[r+3],s[r+4],[s[r+5],s[r+6],s[r+7],s[r+8]]):Re(p,s,r,9),r+=9;break;case Yl:e=s[r+1],i=s[r+2],t?gr(p,e,i,s[r+3],s[r+4],s[r+5]):Re(p,s,r,6),r+=6;break;case Vl:yr(t?p:Re(p,s,r,9),s[r+1],s[r+2],s[r+3],s[r+4],s[r+5],s[r+6],s[r+7],s[r+8],null,fe),e=fe.x,i=fe.y,r+=9;break;case Xl:t?yr(p,s[r+1],s[r+2],s[r+3],s[r+4],0,0,360,!1):Re(p,s,r,5),e=s[r+1]+s[r+3],i=s[r+2],r+=5;break;case ql:kr(t?p:Re(p,s,r,7),s[r+1],s[r+2],s[r+3],s[r+4],s[r+5],s[r+6],null,fe),e=fe.x,i=fe.y,r+=7;break;case Kl:t?kr(p,s[r+1],s[r+2],s[r+3],0,360,!1):Re(p,s,r,4),e=s[r+1]+s[r+3],i=s[r+2],r+=4;break;case Zl:Jl(t?p:Re(p,s,r,6),e,i,s[r+1],s[r+2],s[r+3],s[r+4],s[r+5],null,fe),e=fe.x,i=fe.y,r+=6;break;default:return ed.error(`command: ${d} [index:${r}]`,s),p}_=d}return p},copyData(s,t,e,i){for(let n=e,a=e+i;n<a;n++)s.push(t[n])},pushData(s,t){Mt.index===Mt.length&&(Mt.index=1,s.push(Mt.name)),s.push(Number(t)),Mt.index++,Mt.dot=0}},{current:Mt,pushData:Ne,copyData:Re}=qe,{M:gn,L:sd,C:id,Q:nd,Z:ad,N:mr,D:rd,X:hd,G:od,F:ld,O:dd,P:pd,U:wr}=Ht,{getMinDistanceFrom:cd,getRadianFrom:ud}=R,{tan:fd,min:_d,abs:gd}=Math,rs={},Je={beginPath(s){s.length=0},moveTo(s,t,e){s.push(gn,t,e)},lineTo(s,t,e){s.push(sd,t,e)},bezierCurveTo(s,t,e,i,n,a,r){s.push(id,t,e,i,n,a,r)},quadraticCurveTo(s,t,e,i,n){s.push(nd,t,e,i,n)},closePath(s){s.push(ad)},rect(s,t,e,i,n){s.push(mr,t,e,i,n)},roundRect(s,t,e,i,n,a){if(typeof a=="number")s.push(hd,t,e,i,n,a);else{const r=Gt.fourNumber(a);r?s.push(rd,t,e,i,n,...r):s.push(mr,t,e,i,n)}},ellipse(s,t,e,i,n,a,r,h,o){a===void 0?s.push(ld,t,e,i,n):(r===void 0&&(r=0),h===void 0&&(h=360),s.push(od,t,e,i,n,a,r,h,o?1:0))},arc(s,t,e,i,n,a,r){n===void 0?s.push(pd,t,e,i):(a===void 0&&(a=360),s.push(dd,t,e,i,n,a,r?1:0))},arcTo(s,t,e,i,n,a,r,h){if(r!==void 0){const o=fd(ud(r,h,t,e,i,n)/2)*(cd(r,h,t,e,i,n)/2);s.push(wr,t,e,i,n,_d(a,gd(o)))}else s.push(wr,t,e,i,n,a)},drawEllipse(s,t,e,i,n,a,r,h,o){Xe.ellipse(null,t,e,i,n,a===void 0?0:a,r===void 0?0:r,h===void 0?360:h,o,null,null,rs),s.push(gn,rs.x,rs.y),kd(s,t,e,i,n,a,r,h,o)},drawArc(s,t,e,i,n,a,r){Xe.arc(null,t,e,i,n===void 0?0:n,a===void 0?360:a,r,null,null,rs),s.push(gn,rs.x,rs.y),yd(s,t,e,i,n,a,r)},drawPoints(s,t,e,i){Xe.points(s,t,e,i)}},{ellipse:kd,arc:yd}=Je,{moveTo:Ed,lineTo:md,quadraticCurveTo:wd,bezierCurveTo:xd,closePath:bd,beginPath:Fd,rect:vd,roundRect:Cd,ellipse:Bd,arc:Rd,arcTo:Ad,drawEllipse:Sd,drawArc:Dd,drawPoints:Pd}=Je;class Da{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.clearPath=this.beginPath,this.set(t)}set(t){return t?this.__path=typeof t=="string"?ae.parse(t):t:this.__path=[],this}beginPath(){return Fd(this.__path),this}moveTo(t,e){return Ed(this.__path,t,e),this}lineTo(t,e){return md(this.__path,t,e),this}bezierCurveTo(t,e,i,n,a,r){return xd(this.__path,t,e,i,n,a,r),this}quadraticCurveTo(t,e,i,n){return wd(this.__path,t,e,i,n),this}closePath(){return bd(this.__path),this}rect(t,e,i,n){return vd(this.__path,t,e,i,n),this}roundRect(t,e,i,n,a){return Cd(this.__path,t,e,i,n,a),this}ellipse(t,e,i,n,a,r,h,o){return Bd(this.__path,t,e,i,n,a,r,h,o),this}arc(t,e,i,n,a,r){return Rd(this.__path,t,e,i,n,a,r),this}arcTo(t,e,i,n,a){return Ad(this.__path,t,e,i,n,a),this}drawEllipse(t,e,i,n,a,r,h,o){return Sd(this.__path,t,e,i,n,a,r,h,o),this}drawArc(t,e,i,n,a,r){return Dd(this.__path,t,e,i,n,a,r),this}drawPoints(t,e,i){return Pd(this.__path,t,e,i),this}}const{M:Td,L:Od,C:Md,Q:Ld,Z:Id,N:Wd,D:$d,X:zd,G:Nd,F:Hd,O:Gd,P:jd,U:Ud}=Ht,Yd=H.get("PathDrawer"),Vd={drawPathByData(s,t){if(!t)return;let e,i=0,n=t.length;for(;i<n;)switch(e=t[i],e){case Td:s.moveTo(t[i+1],t[i+2]),i+=3;break;case Od:s.lineTo(t[i+1],t[i+2]),i+=3;break;case Md:s.bezierCurveTo(t[i+1],t[i+2],t[i+3],t[i+4],t[i+5],t[i+6]),i+=7;break;case Ld:s.quadraticCurveTo(t[i+1],t[i+2],t[i+3],t[i+4]),i+=5;break;case Id:s.closePath(),i+=1;break;case Wd:s.rect(t[i+1],t[i+2],t[i+3],t[i+4]),i+=5;break;case $d:s.roundRect(t[i+1],t[i+2],t[i+3],t[i+4],[t[i+5],t[i+6],t[i+7],t[i+8]]),i+=9;break;case zd:s.roundRect(t[i+1],t[i+2],t[i+3],t[i+4],t[i+5]),i+=6;break;case Nd:s.ellipse(t[i+1],t[i+2],t[i+3],t[i+4],t[i+5]*N,t[i+6]*N,t[i+7]*N,t[i+8]),i+=9;break;case Hd:s.ellipse(t[i+1],t[i+2],t[i+3],t[i+4],0,0,zt,!1),i+=5;break;case Gd:s.arc(t[i+1],t[i+2],t[i+3],t[i+4]*N,t[i+5]*N,t[i+6]),i+=7;break;case jd:s.arc(t[i+1],t[i+2],t[i+3],0,zt,!1),i+=4;break;case Ud:s.arcTo(t[i+1],t[i+2],t[i+3],t[i+4],t[i+5]),i+=6;break;default:Yd.error(`command: ${e} [index:${i}]`,t);return}}},{M:Xd,L:qd,C:xr,Q:br,Z:Fr,N:Kd,D:vr,X:Zd,G:Qd,F:Jd,O:tp,P:ep,U:sp}=Ht,{toTwoPointBounds:ip,toTwoPointBoundsByQuadraticCurve:np,arcTo:ap,arc:rp,ellipse:hp}=Xe,{addPointBounds:Rs,copy:kn,addPoint:op,setPoint:yn,addBounds:ci,toBounds:lp}=qs,dp=H.get("PathBounds");let hs,ui,En;const Bt={},Cr={},_e={},Pa={toBounds(s,t){Pa.toTwoPointBounds(s,Cr),lp(Cr,t)},toTwoPointBounds(s,t){if(!s||!s.length)return yn(t,0,0);let e,i=0,n=0,a=0,r,h,o,l;const d=s.length;for(;i<d;)switch(e=s[i],i===0&&(e===Fr||e===xr||e===br?yn(t,n,a):yn(t,s[i+1],s[i+2])),e){case Xd:case qd:n=s[i+1],a=s[i+2],op(t,n,a),i+=3;break;case xr:o=s[i+5],l=s[i+6],ip(n,a,s[i+1],s[i+2],s[i+3],s[i+4],o,l,Bt),Rs(t,Bt),n=o,a=l,i+=7;break;case br:r=s[i+1],h=s[i+2],o=s[i+3],l=s[i+4],np(n,a,r,h,o,l,Bt),Rs(t,Bt),n=o,a=l,i+=5;break;case Fr:i+=1;break;case Kd:n=s[i+1],a=s[i+2],ci(t,n,a,s[i+3],s[i+4]),i+=5;break;case vr:case Zd:n=s[i+1],a=s[i+2],ci(t,n,a,s[i+3],s[i+4]),i+=e===vr?9:6;break;case Qd:hp(null,s[i+1],s[i+2],s[i+3],s[i+4],s[i+5],s[i+6],s[i+7],s[i+8],Bt,_e),i===0?kn(t,Bt):Rs(t,Bt),n=_e.x,a=_e.y,i+=9;break;case Jd:n=s[i+1],a=s[i+2],ui=s[i+3],En=s[i+4],ci(t,n-ui,a-En,ui*2,En*2),n+=ui,i+=5;break;case tp:rp(null,s[i+1],s[i+2],s[i+3],s[i+4],s[i+5],s[i+6],Bt,_e),i===0?kn(t,Bt):Rs(t,Bt),n=_e.x,a=_e.y,i+=7;break;case ep:n=s[i+1],a=s[i+2],hs=s[i+3],ci(t,n-hs,a-hs,hs*2,hs*2),n+=hs,i+=4;break;case sp:ap(null,n,a,s[i+1],s[i+2],s[i+3],s[i+4],s[i+5],Bt,_e),i===0?kn(t,Bt):Rs(t,Bt),n=_e.x,a=_e.y,i+=6;break;default:dp.error(`command: ${e} [index:${i}]`,s);return}}},{M:mn,L:fi,C:Br,Z:_i}=Ht,{getCenterX:pp,getCenterY:cp}=R,{arcTo:wn}=Je,up={smooth(s,t,e){let i,n=0,a=0,r=0,h=0,o=0,l=0,d=0,_=0,u=0;const p=s.length,f=[];for(;n<p;)switch(i=s[n],i){case mn:h=_=s[n+1],o=u=s[n+2],n+=3,s[n]===fi?(l=s[n+1],d=s[n+2],f.push(mn,pp(h,l),cp(o,d))):f.push(mn,h,o);break;case fi:switch(a=s[n+1],r=s[n+2],n+=3,s[n]){case fi:wn(f,a,r,s[n+1],s[n+2],t,_,u);break;case _i:wn(f,a,r,h,o,t,_,u);break;default:f.push(fi,a,r)}_=a,u=r;break;case Br:f.push(Br,s[n+1],s[n+2],s[n+3],s[n+4],s[n+5],s[n+6]),n+=7;break;case _i:wn(f,h,o,l,d,t,_,u),f.push(_i),n+=1;break}return i!==_i&&(f[1]=h,f[2]=o),f}};ae.creator=new Da;ae.parse=qe.parse;ae.convertToCanvasData=qe.toCanvasData;const As=new Da,{drawRoundRect:fp}=_o;function _p(s){s&&!s.roundRect&&(s.roundRect=function(t,e,i,n,a){fp(this,t,e,i,n,a)})}function go(s){_p(s)}const we={opacityTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType(s){return!s||s.startsWith("image")?s:(s==="jpg"&&(s="jpeg"),"image/"+s)},fileType(s){const t=s.split(".");return t[t.length-1]},isOpaqueImage(s){const t=ra.fileType(s);return["jpg","jpeg"].some(e=>e===t)},getExportOptions(s){switch(typeof s){case"object":return s;case"number":return{quality:s};case"boolean":return{blob:s};default:return{}}}},ra=we;ra.opacityTypes.forEach(s=>ra.upperCaseTypeMap[s]=s.toUpperCase());const gp=H.get("TaskProcessor");class kp{constructor(t){this.parallel=!0,this.time=1,this.id=xe.create(xe.TASK),this.task=t}run(){return ho(this,void 0,void 0,function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){gp.error(t)}})}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class ha{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let e=0,i=0;for(let n=0;n<t;n++)n<=this.finishedIndex?(i+=this.list[n].time,n===this.finishedIndex&&(e=i)):e+=this.list[n].time;return this.isComplete?1:i/e}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&_t.assign(this.config,t),this.empty()}add(t,e){let i,n,a,r;const h=new kp(t);return h.parent=this,typeof e=="number"?r=e:e&&(n=e.parallel,i=e.start,a=e.time,r=e.delay),a&&(h.time=a),n===!1&&(h.parallel=!1),r===void 0?this.push(h,i):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(h,i))},r)),this.isComplete=!1,h}push(t,e){this.list.push(t),e!==!1&&!this.timer&&(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(t=>{t.isComplete||t.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];if(!t){this.nextTask();return}t.run().then(()=>{this.onTask(t),this.index++,this.nextTask()}).catch(e=>{this.onError(e)})}runParallelTasks(){this.parallelList.forEach(t=>this.runParallelTask(t))}runParallelTask(t){t.run().then(()=>{this.onTask(t),this.fillParallelTask()}).catch(e=>{this.onParallelError(e)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let e=this.index+this.config.parallel;e>this.list.length&&(e=this.list.length);for(let i=this.index;i<e&&(t=this.list[i],t.parallel);i++)this.parallelList.push(t)}fillParallelTask(){let t;const e=this.parallelList;this.parallelSuccessNumber++,e.pop();const i=e.length,n=this.finishedIndex+i;if(e.length){if(!this.running)return;n<this.total&&(t=this.list[n],t&&t.parallel&&(e.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach(e=>{e.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const Ct={map:{},recycledList:[],tasker:new ha,patternTasker:new ha,get isComplete(){return ge.tasker.isComplete},get(s){let t=ge.map[s.url];return t||(t=pt.image(s),ge.map[s.url]=t),t.use++,t},recycle(s){s.use--,setTimeout(()=>{s.use||ge.recycledList.push(s)})},clearRecycled(){const s=ge.recycledList;s.length>100&&(s.forEach(t=>{!t.use&&t.url&&(delete ge.map[t.url],t.destroy())}),s.length=0)},hasOpacityPixel(s){return we.opacityTypes.some(t=>ge.isFormat(t,s))},isFormat(s,t){if(t.format===s)return!0;const{url:e}=t;if(e.startsWith("data:")){if(e.startsWith("data:"+we.mineType(s)))return!0}else if(e.includes("."+s)||e.includes("."+we.upperCaseTypeMap[s]))return!0;return!1},destroy(){ge.map={},ge.recycledList=[]}},ge=Ct,{IMAGE:yp,create:Ep}=xe;class mp{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){this.use=0,this.waitComplete=[],this.innerId=Ep(yp),this.config=t||{url:""},this.isSVG=Ct.isFormat("svg",t),this.hasOpacityPixel=Ct.hasOpacityPixel(t)}load(t,e){return this.loading||(this.loading=!0,Ct.tasker.add(()=>ho(this,void 0,void 0,function*(){return yield b.origin.loadImage(this.url).then(i=>{this.ready=!0,this.width=i.naturalWidth||i.width,this.height=i.naturalHeight||i.height,this.view=i,this.onComplete(!0)}).catch(i=>{this.error=i,this.onComplete(!1)})}))),this.waitComplete.push(t,e),this.waitComplete.length-2}unload(t,e){const i=this.waitComplete;if(e){const n=i[t+1];n&&n({type:"stop"})}i[t]=i[t+1]=void 0}onComplete(t){let e;this.waitComplete.forEach((i,n)=>{e=n%2,i&&(t?e||i(this):e&&i(this.error))}),this.waitComplete.length=0,this.loading=!1}getCanvas(t,e,i,n){if(t||(t=this.width),e||(e=this.height),this.cache){let{params:h,data:o}=this.cache;for(let l in h)if(h[l]!==arguments[l]){o=null;break}if(o)return o}const a=b.origin.createCanvas(t,e),r=a.getContext("2d");return i&&(r.globalAlpha=i),r.drawImage(this.view,0,0,t,e),this.cache=this.use>1?{data:a,params:arguments}:null,a}getPattern(t,e,i,n){const a=b.canvas.createPattern(t,e);try{i&&a.setTransform&&(a.setTransform(i),i=null)}catch{}return n&&(n.transform=i),a}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function Ks(s,t,e,i){e.configurable=e.enumerable=!0,Object.defineProperty(s,t,e)}function ko(s,t){return Object.getOwnPropertyDescriptor(s,t)}function wp(s){return Object.getOwnPropertyNames(s)}function st(s,t){return(e,i)=>xp(e,i,s,t&&t(i))}function xp(s,t,e,i){Ks(s,t,Object.assign({get(){return this.__getAttr(t)},set(a){this.__setAttr(t,a)}},i||{})),wo(s,t,e)}function mt(s){return st(s)}function xs(s,t){return st(s,e=>({set(i){this.__setAttr(e,i,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function zi(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__hasAutoLayout=!!e,this.__local||this.__layout.createLocal())}}))}function yo(s,t){return st(s,e=>({set(i){this.__setAttr(e,i,t)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function Ta(s,t){return st(s,e=>({set(i){this.__setAttr(e,i,t)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function O(s,t){return st(s,e=>({set(i){this.__setAttr(e,i,t)&&bs(this)}}))}function bp(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&(bs(this),this.__.__removeNaturalSize())}}))}function bs(s){s.__layout.boxChanged||s.__layout.boxChange(),s.__hasAutoLayout&&(s.__layout.matrixChanged||s.__layout.matrixChange())}function Fp(s){return st(s,t=>({set(e){const i=this.__;i.__pathInputed!==2&&(i.__pathInputed=e?1:0),e||(i.__pathForRender=void 0),this.__setAttr(t,e),bs(this)}}))}const bt=O;function Ni(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&Eo(this)}}))}function Eo(s){s.__layout.strokeChanged||s.__layout.strokeChange(),s.__.__useArrow&&bs(s)}const le=Ni;function mo(s){return st(s,t=>({set(e){this.__setAttr(t,e),this.__layout.renderChanged||this.__layout.renderChange()}}))}function Zs(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function vp(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange())}}))}function Cp(s){return st(s,t=>({set(e){const i=this.visible;this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange(),(i===0||e===0)&&bs(this))}}))}function Bp(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function Rp(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(e)}))}}))}function Ap(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&this.waitParent(()=>{this.parent.__updateEraser(e)})}}))}function ts(s){return st(s,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.hitCanvasChanged=!0,H.showHitView&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}}))}function Sp(s){return st(s,t=>({set(e){this.__setAttr(t,e),this.leafer&&this.leafer.updateCursor()}}))}function kt(s){return(t,e)=>{Ks(t,"__DataProcessor",{get(){return s}})}}function Dp(s){return"set"+s.charAt(0).toUpperCase()+s.slice(1)}function wo(s,t,e){const i=s.__DataProcessor.prototype,n="_"+t,a=Dp(t),r={get(){const l=this[n];return l===void 0?e:l},set(l){this[n]=l}};e===void 0?r.get=function(){return this[n]}:t==="width"?r.get=function(){const l=this[n];if(l===void 0){const d=this;return d._height&&d.__naturalWidth&&d.__useNaturalRatio?d._height*d.__naturalWidth/d.__naturalHeight:d.__naturalWidth||e}else return l}:t==="height"&&(r.get=function(){const l=this[n];if(l===void 0){const d=this;return d._width&&d.__naturalHeight&&d.__useNaturalRatio?d._width*d.__naturalHeight/d.__naturalWidth:d.__naturalHeight||e}else return l});let h,o=i;for(;!h&&o;)h=ko(o,t),o=o.__proto__;h&&h.set&&(r.set=h.set),i[a]&&(r.set=i[a],delete i[a]),Ks(i,t,r)}const Pp=new H("rewrite"),Ci=[],Tp=["destroy","constructor"];function Jt(s){return(t,e)=>{Ci.push({name:t.constructor.name+"."+e,run:()=>{t[e]=s}})}}function Hi(){return s=>{xo()}}function xo(s){Ci.length&&(Ci.forEach(t=>{s&&Pp.error(t.name,"Class@rewriteAble()"),t.run()}),Ci.length=0)}setTimeout(()=>xo(!0));function Vt(s,t){return e=>{(s.prototype?wp(s.prototype):Object.keys(s)).forEach(n=>{!Tp.includes(n)&&(!t||!t.includes(n))&&(s.prototype?ko(s.prototype,n).writable&&(e.prototype[n]=s.prototype[n]):e.prototype[n]=s[n])})}}function yt(){return s=>{$i.register(s)}}function Le(){return s=>{ks.register(s)}}const{copy:os,toInnerPoint:Op,scaleOfOuter:Mp,rotateOfOuter:Lp,skewOfOuter:Ip,multiplyParent:Rr,divideParent:Ar,getLayout:Wp}=S,dt={},de={updateAllMatrix(s,t,e){if(t&&s.__hasAutoLayout&&s.__layout.matrixChanged&&(e=!0),zp(s,t,e),s.isBranch){const{children:i}=s;for(let n=0,a=i.length;n<a;n++)$p(i[n],t,e)}},updateMatrix(s,t,e){const i=s.__layout;t?e&&(i.waitAutoLayout=!0,s.__hasAutoLayout&&(i.matrixChanged=!1)):i.waitAutoLayout&&(i.waitAutoLayout=!1),i.matrixChanged&&s.__updateLocalMatrix(),i.waitAutoLayout||s.__updateWorldMatrix()},updateBounds(s){const t=s.__layout;t.boundsChanged&&s.__updateLocalBounds(),t.waitAutoLayout||s.__updateWorldBounds()},updateAllWorldOpacity(s){if(s.__updateWorldOpacity(),s.isBranch){const{children:t}=s;for(let e=0,i=t.length;e<i;e++)Sr(t[e])}},updateAllChange(s){if(Sr(s),s.__updateChange(),s.isBranch){const{children:t}=s;for(let e=0,i=t.length;e<i;e++)Np(t[e])}},worldHittable(s){for(;s;){if(!s.__.hittable)return!1;s=s.parent}return!0},moveWorld(s,t,e=0){const i=typeof t=="object"?Object.assign({},t):{x:t,y:e};s.parent&&Op(s.parent.worldTransform,i,i,!0),se.moveLocal(s,i.x,i.y)},moveLocal(s,t,e=0){typeof t=="object"?(s.x+=t.x,s.y+=t.y):(s.x+=t,s.y+=e)},zoomOfWorld(s,t,e,i,n){se.zoomOfLocal(s,xn(s,t),e,i,n)},zoomOfLocal(s,t,e,i=e,n){os(dt,s.__localMatrix),Mp(dt,t,e,i),Dr(s,dt),s.scaleResize(e,i,n!==!0)},rotateOfWorld(s,t,e){se.rotateOfLocal(s,xn(s,t),e)},rotateOfLocal(s,t,e){os(dt,s.__localMatrix),Lp(dt,t,e),Dr(s,dt),s.rotation=Gt.formatRotation(s.rotation+e)},skewOfWorld(s,t,e,i,n){se.skewOfLocal(s,xn(s,t),e,i,n)},skewOfLocal(s,t,e,i=0,n){os(dt,s.__localMatrix),Ip(dt,t,e,i),se.setTransform(s,dt,n)},transformWorld(s,t,e){os(dt,s.worldTransform),Rr(dt,t),s.parent&&Ar(dt,s.parent.worldTransform),se.setTransform(s,dt,e)},transform(s,t,e){os(dt,s.localTransform),Rr(dt,t),se.setTransform(s,dt,e)},setTransform(s,t,e){const i=Wp(t);if(e){const n=i.scaleX/s.scaleX,a=i.scaleY/s.scaleY;delete i.scaleX,delete i.scaleY,s.set(i),s.scaleResize(n,a,e!==!0)}else s.set(i)},getLocalOrigin(s,t){return R.tempToOuterOf(se.getInnerOrigin(s,t),s.localTransform)},getInnerOrigin(s,t){return typeof t=="string"&&ws.toPoint(t,s.boxBounds,t={}),t},getRelativeWorld(s,t,e){return os(dt,s.worldTransform),Ar(dt,t.worldTransform),e?dt:Object.assign({},dt)},drop(s,t,e,i){s.setTransform(se.getRelativeWorld(s,t,!0),i),t.add(s,e)},hasParent(s,t){if(!t)return!1;for(;s;){if(t===s)return!0;s=s.parent}}},se=de,{updateAllMatrix:$p,updateMatrix:zp,updateAllWorldOpacity:Sr,updateAllChange:Np}=se;function Dr(s,t){const{e,f:i}=s.__localMatrix;s.x+=t.e-e,s.y+=t.f-i}function xn(s,t){return s.__layout.update(),s.parent?R.tempToInnerOf(t,s.parent.__world):t}const Gi={worldBounds(s){return s.__world},localBoxBounds(s){return s.__.eraser||s.__.visible===0?null:s.__local||s.__layout},localStrokeBounds(s){return s.__.eraser||s.__.visible===0?null:s.__layout.localStrokeBounds},localRenderBounds(s){return s.__.eraser||s.__.visible===0?null:s.__layout.localRenderBounds},maskLocalBoxBounds(s){return s.__.mask?s.__localBoxBounds:null},maskLocalStrokeBounds(s){return s.__.mask?s.__layout.localStrokeBounds:null},maskLocalRenderBounds(s){return s.__.mask?s.__layout.localRenderBounds:null},excludeRenderBounds(s,t){return!!(t.bounds&&!t.bounds.hit(s.__world,t.matrix)||t.hideBounds&&t.hideBounds.includes(s.__world,t.matrix))}},{updateBounds:Pr}=de,Qs={sort(s,t){return s.__.zIndex===t.__.zIndex?s.__tempNumber-t.__tempNumber:s.__.zIndex-t.__.zIndex},pushAllChildBranch(s,t){if(s.__tempNumber=1,s.__.__childBranchNumber){const{children:e}=s;for(let i=0,n=e.length;i<n;i++)s=e[i],s.isBranch&&(s.__tempNumber=1,t.add(s),Hp(s,t))}},pushAllParent(s,t){const{keys:e}=t;if(e)for(;s.parent&&e[s.parent.innerId]===void 0;)t.add(s.parent),s=s.parent;else for(;s.parent;)t.add(s.parent),s=s.parent},pushAllBranchStack(s,t){let e=t.length;const{children:i}=s;for(let n=0,a=i.length;n<a;n++)i[n].isBranch&&t.push(i[n]);for(let n=e,a=t.length;n<a;n++)Tr(t[n],t)},updateBounds(s,t){const e=[s];Tr(s,e),Gp(e,t)},updateBoundsByBranchStack(s,t){let e,i;for(let n=s.length-1;n>-1;n--){e=s[n],i=e.children;for(let a=0,r=i.length;a<r;a++)Pr(i[a]);t&&t===e||Pr(e)}}},{pushAllChildBranch:Hp,pushAllBranchStack:Tr,updateBoundsByBranchStack:Gp}=Qs,Ye={run(s){if(s&&s.length){const t=s.length;for(let e=0;e<t;e++)s[e]();s.length===t?s.length=0:s.splice(0,t)}}},{getRelativeWorld:Or}=de,{toOuterOf:gi,getPoints:jp,copy:Up}=C,bn="_localContentBounds",Fn="_worldContentBounds",vn="_worldBoxBounds",Cn="_worldStrokeBounds";class Yp{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}get localContentBounds(){return gi(this.contentBounds,this.leaf.__localMatrix,this[bn]||(this[bn]={})),this[bn]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return gi(this.contentBounds,this.leaf.__world,this[Fn]||(this[Fn]={})),this[Fn]}get worldBoxBounds(){return gi(this.boxBounds,this.leaf.__world,this[vn]||(this[vn]={})),this[vn]}get worldStrokeBounds(){return gi(this.strokeBounds,this.leaf.__world,this[Cn]||(this[Cn]={})),this[Cn]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.boxBounds={x:0,y:0,width:0,height:0},this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),this.boxChange(),this.matrixChange()}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leafer:t}=this.leaf;if(t)t.ready?t.watcher.changed&&t.layouter.layout():t.start();else{let e=this.leaf;for(;e.parent&&!e.parent.leafer;)e=e.parent;b.layout(e)}}getTransform(t="world"){this.update();const{leaf:e}=this;switch(t){case"world":return e.__world;case"local":return e.__localMatrix;case"inner":return S.defaultMatrix;case"page":t=e.zoomLayer;default:return Or(e,t)}}getBounds(t,e="world"){switch(this.update(),e){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":e=this.leaf.zoomLayer;default:return new et(this.getInnerBounds(t)).toOuterOf(this.getTransform(e))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,e="world",i){const{leaf:n}=this;let a,r,h=this.getInnerBounds(t);switch(e){case"world":a=n.getWorldPoint(h),r=n.__world;break;case"local":a=n.getLocalPointByInner(h),r=n.__localMatrix;break;case"inner":a=h,r=S.defaultMatrix;break;case"page":e=n.zoomLayer;default:a=n.getWorldPoint(h,e),r=Or(n,e,!0)}const o=S.getLayout(r);if(Up(o,h),R.copy(o,a),i){const{scaleX:l,scaleY:d}=o,_=Math.abs(l),u=Math.abs(d);(_!==1||u!==1)&&(o.scaleX/=_,o.scaleY/=u,o.width*=_,o.height*=u)}return o}getLayoutPoints(t,e="world"){const{leaf:i}=this,n=jp(this.getInnerBounds(t));let a;switch(e){case"world":a=null;break;case"local":a=i.parent;break;case"inner":break;case"page":e=i.zoomLayer;default:a=e}return a!==void 0&&n.forEach(r=>i.innerToWorld(r,null,!1,a)),n}shrinkContent(){const{x:t,y:e,width:i,height:n}=this.boxBounds;this._contentBounds={x:t,y:e,width:i,height:n}}spreadStroke(){const{x:t,y:e,width:i,height:n}=this.strokeBounds;this._strokeBounds={x:t,y:e,width:i,height:n},this._localStrokeBounds={x:t,y:e,width:i,height:n},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:e,width:i,height:n}=this.renderBounds;this._renderBounds={x:t,y:e,width:i,height:n},this._localRenderBounds={x:t,y:e,width:i,height:n}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged||this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged||this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=!0,this.leaf.forceUpdate("surface"))}destroy(){}}const Mr={},Vp={on(s,t,e){let i,n;e&&(typeof e=="boolean"?i=e:(i=e.capture,n=e.once));let a;const r=Bn(this,i,!0),h=typeof s=="string"?s.split(" "):s,o=n?{listener:t,once:n}:{listener:t};h.forEach(l=>{l&&(a=r[l],a?a.findIndex(d=>d.listener===t)===-1&&a.push(o):r[l]=[o])})},off(s,t,e){if(s){const i=typeof s=="string"?s.split(" "):s;if(t){let n;e&&(n=typeof e=="boolean"?e:e.capture);let a,r;const h=Bn(this,n);i.forEach(o=>{o&&(a=h[o],a&&(r=a.findIndex(l=>l.listener===t),r>-1&&a.splice(r,1),a.length||delete h[o]))})}else{const{__bubbleMap:n,__captureMap:a}=this;i.forEach(r=>{n&&delete n[r],a&&delete a[r]})}}else this.__bubbleMap=this.__captureMap=void 0},on_(s,t,e,i){return e&&(t=t.bind(e)),this.on(s,t,i),{type:s,current:this,listener:t,options:i}},off_(s){if(!s)return;const t=s instanceof Array?s:[s];t.forEach(e=>e.current.off(e.type,e.listener,e.options)),t.length=0},once(s,t,e){this.on(s,t,{once:!0,capture:e})},emit(s,t,e){!t&&ks.has(s)&&(t=ks.get(s,{type:s,target:this,current:this}));const n=Bn(this,e)[s];if(n){let a;for(let r=0,h=n.length;r<h&&(a=n[r],a.listener(t),a.once&&(this.off(s,a.listener,e),r--,h--),!(t&&t.isStopNow));r++);}this.syncEventer&&this.syncEventer.emitEvent(t,e)},emitEvent(s,t){s.current=this,this.emit(s.type,s,t)},hasEvent(s,t){if(this.syncEventer&&this.syncEventer.hasEvent(s,t))return!0;const{__bubbleMap:e,__captureMap:i}=this,n=e&&e[s],a=i&&i[s];return!!(t===void 0?n||a:t?a:n)}};function Bn(s,t,e){if(t){const{__captureMap:i}=s;return i||(e?s.__captureMap={}:Mr)}else{const{__bubbleMap:i}=s;return i||(e?s.__bubbleMap={}:Mr)}}class pe{constructor(t,e){this.bubbles=!1,this.type=t,e&&(this.target=e)}stopDefault(){this.isStopDefault=!0,this.origin&&b.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&b.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&b.event.stop(this.origin)}}class Dt extends pe{constructor(t,e,i){super(t,e),this.parent=i,this.child=e}}Dt.ADD="child.add";Dt.REMOVE="child.remove";Dt.DESTROY="child.destroy";class me extends pe{constructor(t,e,i,n,a){super(t,e),this.attrName=i,this.oldValue=n,this.newValue=a}}me.CHANGE="property.change";me.LEAFER_CHANGE="property.leafer_change";class Ie extends pe{constructor(t,e){super(t),Object.assign(this,e)}}Ie.LOAD="image.load";Ie.LOADED="image.loaded";Ie.ERROR="image.error";class es extends pe{get bigger(){if(!this.old)return!0;const{width:t,height:e}=this.old;return this.width>=t&&this.height>=e}get smaller(){return!this.bigger}get samePixelRatio(){return this.old?this.pixelRatio===this.old.pixelRatio:!0}constructor(t,e){typeof t=="object"?(super(es.RESIZE),Object.assign(this,t)):super(t),this.old=e}}es.RESIZE="resize";class Pe extends pe{constructor(t,e){super(t),this.data=e}}Pe.REQUEST="watch.request";Pe.DATA="watch.data";class G extends pe{constructor(t,e,i){super(t),e&&(this.data=e,this.times=i)}}G.CHECK_UPDATE="layout.check_update";G.REQUEST="layout.request";G.START="layout.start";G.BEFORE="layout.before";G.LAYOUT="layout";G.AFTER="layout.after";G.AGAIN="layout.again";G.END="layout.end";class bo extends pe{}bo.FRAME="animate.frame";class X extends pe{constructor(t,e,i,n){super(t),e&&(this.times=e),i&&(this.renderBounds=i,this.renderOptions=n)}}X.REQUEST="render.request";X.START="render.start";X.BEFORE="render.before";X.RENDER="render";X.AFTER="render.after";X.AGAIN="render.again";X.END="render.end";X.NEXT="render.next";class at extends pe{}at.START="leafer.start";at.BEFORE_READY="leafer.before_ready";at.READY="leafer.ready";at.AFTER_READY="leafer.after_ready";at.VIEW_READY="leafer.view_ready";at.VIEW_COMPLETED="leafer.view_completed";at.STOP="leafer.stop";at.RESTART="leafer.restart";at.END="leafer.end";const{isFinite:Xp}=Number,qp=H.get("setAttr"),Kp={__setAttr(s,t,e){if(this.leafer&&this.leafer.created){const i=this.__.__getInput(s);if(e&&!Xp(t)&&t!==void 0&&(qp.warn(this.innerName,s,t),t=void 0),typeof t=="object"||i!==t){this.__[s]=t,this.__proxyData&&this.setProxyAttr(s,t);const{CHANGE:n}=me,a=new me(n,this,s,i,t);return this.isLeafer?this.emitEvent(new me(me.LEAFER_CHANGE,this,s,i,t)):this.hasEvent(n)&&this.emitEvent(a),this.leafer.emitEvent(a),!0}else return!1}else return this.__[s]=t,this.__proxyData&&this.setProxyAttr(s,t),!0},__getAttr(s){return this.__proxyData?this.getProxyAttr(s):this.__.__get(s)}},{setLayout:Zp,multiplyParent:Qp,translateInner:Jp,defaultWorld:tc}=S,{toPoint:ec,tempPoint:Rn}=ws,sc={__updateWorldMatrix(){Qp(this.__local||this.__layout,this.parent?this.parent.__world:tc,this.__world,!!this.__layout.affectScaleOrRotation,this.__,this.parent&&this.parent.__)},__updateLocalMatrix(){if(this.__local){const s=this.__layout,t=this.__local,e=this.__;s.affectScaleOrRotation&&(s.scaleChanged||s.rotationChanged)&&(Zp(t,e,null,s.affectRotation),s.scaleChanged=s.rotationChanged=!1),t.e=e.x+e.offsetX,t.f=e.y+e.offsetY,(e.around||e.origin)&&(ec(e.around||e.origin,s.boxBounds,Rn),Jp(t,-Rn.x,-Rn.y,e.origin))}this.__layout.matrixChanged=!1}},{updateMatrix:ic,updateAllMatrix:Lr}=de,{updateBounds:Ir}=Qs,{toOuterOf:ki,copyAndSpread:Wr,copy:nc}=C,{toBounds:ac}=Pa,rc={__updateWorldBounds(){ki(this.__layout.renderBounds,this.__world,this.__world),this.__layout.resized&&(this.__onUpdateSize(),this.__layout.resized=!1)},__updateLocalBounds(){const s=this.__layout;s.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),s.resized=!0),s.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),s.localBoxChanged=!1,s.strokeSpread&&(s.strokeChanged=!0),s.renderSpread&&(s.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),s.boxChanged=!1,s.strokeChanged&&(s.strokeSpread=this.__updateStrokeSpread(),s.strokeSpread?(s.strokeBounds===s.boxBounds&&s.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):s.spreadStrokeCancel(),s.strokeChanged=!1,(s.renderSpread||s.strokeSpread!==s.strokeBoxSpread)&&(s.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),s.resized=!0),s.renderChanged&&(s.renderSpread=this.__updateRenderSpread(),s.renderSpread?((s.renderBounds===s.boxBounds||s.renderBounds===s.strokeBounds)&&s.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):s.spreadRenderCancel(),s.renderChanged=!1,this.parent&&this.parent.__layout.renderChange()),s.boundsChanged=!1},__updateLocalBoxBounds(){this.__hasAutoLayout&&this.__updateAutoLayout(),ki(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){ki(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){ki(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(){const s=this.__layout.boxBounds,t=this.__;t.__pathInputed?ac(t.__pathForRender,s):(s.x=0,s.y=0,s.width=t.width,s.height=t.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.leafer&&this.leafer.ready&&this.leafer.layouter.addExtra(this),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),Lr(this),Ir(this,this),this.__.__autoSide&&this.__updateBoxBounds()):(Lr(this),Ir(this,this))):ic(this)},__updateNaturalSize(){const{__:s,__layout:t}=this;s.__naturalWidth=t.boxBounds.width,s.__naturalHeight=t.boxBounds.height},__updateStrokeBounds(){const s=this.__layout;Wr(s.strokeBounds,s.boxBounds,s.strokeBoxSpread)},__updateRenderBounds(){const s=this.__layout;s.renderSpread>0?Wr(s.renderBounds,s.boxBounds,s.renderSpread):nc(s.renderBounds,s.strokeBounds)}},hc={__render(s,t){if(this.__worldOpacity)if(s.setWorld(this.__nowWorld=this.__getNowWorld(t)),s.opacity=this.__.opacity,this.__.__single){if(this.__.eraser==="path")return this.__renderEraser(s,t);const e=s.getSameCanvas(!0,!0);this.__draw(e,t),this.__worldFlipped?s.copyWorldByReset(e,this.__nowWorld,null,this.__.__blendMode,!0):s.copyWorldToInner(e,this.__nowWorld,this.__layout.renderBounds,this.__.__blendMode),e.recycle(this.__nowWorld)}else this.__draw(s,t)},__clip(s,t){this.__worldOpacity&&(s.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawRenderPath(s),this.__.windingRule?s.clip(this.__.windingRule):s.clip())},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:$r}=Gi,oc={__updateChange(){const{__layout:s}=this;s.childrenSortChanged&&(this.__updateSortChildren(),s.childrenSortChanged=!1),this.__.__checkSingle()},__render(s,t){if(this.__worldOpacity)if(this.__.__single){if(this.__.eraser==="path")return this.__renderEraser(s,t);const e=s.getSameCanvas(!1,!0);this.__renderBranch(e,t);const i=this.__getNowWorld(t);s.opacity=this.__.opacity,s.copyWorldByReset(e,i,i,this.__.__blendMode,!0),e.recycle(i)}else this.__renderBranch(s,t)},__renderBranch(s,t){if(this.__hasMask)this.__renderMask(s,t);else{const{children:e}=this;for(let i=0,n=e.length;i<n;i++)$r(e[i],t)||e[i].__render(s,t)}},__clip(s,t){if(this.__worldOpacity){const{children:e}=this;for(let i=0,n=e.length;i<n;i++)$r(e[i],t)||e[i].__clip(s,t)}}},{LEAF:lc,create:dc}=xe,{toInnerPoint:pc,toOuterPoint:cc,multiplyParent:uc}=S,{toOuterOf:zr}=C,{copy:Nr}=R,{moveLocal:fc,zoomOfLocal:_c,rotateOfLocal:gc,skewOfLocal:kc,moveWorld:yc,zoomOfWorld:Ec,rotateOfWorld:mc,skewOfWorld:wc,transform:xc,transformWorld:bc,setTransform:Fc,getLocalOrigin:An,getRelativeWorld:vc,drop:Cc}=de;let Ke=class{get tag(){return this.__tag}set tag(t){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return ro}get __LayoutProcessor(){return Yp}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.__layout.update(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){const{leafer:t}=this;return t&&t.created&&t.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}constructor(t){this.innerId=dc(lc),this.reset(t)}reset(t){this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},t!==null&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0}),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),t&&(t.__&&(t=t.toJSON()),t.children?this.set(t):Object.assign(this,t))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(t,e){e&&(t=t.bind(e)),this.parent?t():this.__parentWait?this.__parentWait.push(t):this.__parentWait=[t]}waitLeafer(t,e){e&&(t=t.bind(e)),this.leafer?t():this.__leaferWait?this.__leaferWait.push(t):this.__leaferWait=[t]}nextRender(t,e,i){this.leafer?this.leafer.nextRender(t,e,i):this.waitLeafer(()=>this.leafer.nextRender(t,e,i))}removeNextRender(t){this.nextRender(t,null,"off")}__bindLeafer(t){if(this.isLeafer&&t!==null&&(t=this),this.leafer&&!t&&this.leafer.leafs--,this.leafer=t,t&&(t.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.__leaferWait&&Ye.run(this.__leaferWait)),this.isBranch){const{children:e}=this;for(let i=0,n=e.length;i<n;i++)e[i].__bindLeafer(t)}}set(t){}get(t){}setAttr(t,e){this[t]=e}getAttr(t){return this[t]}getComputedAttr(t){return this.__[t]}toJSON(t){return t&&this.__layout.update(),this.__.__getInputData(null,t)}toString(t){return JSON.stringify(this.toJSON(t))}toSVG(){}__SVG(t){}toHTML(){}__setAttr(t,e){return!0}__getAttr(t){}setProxyAttr(t,e){}getProxyAttr(t){}find(t,e){}findTag(t){}findOne(t,e){}findId(t){}focus(t){}updateLayout(){this.__layout.update()}forceUpdate(t){t===void 0?t="width":t==="surface"&&(t="blendMode");const e=this.__.__getInput(t);this.__[t]=e===void 0?null:void 0,this[t]=e}forceRender(t){this.forceUpdate("surface")}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(){}__updateContentBounds(){}__updateStrokeBounds(){}__updateRenderBounds(){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(t){this.__hasEraser=t?!0:this.children.some(e=>e.__.eraser)}__renderEraser(t,e){t.save(),this.__clip(t,e);const{renderBounds:i}=this.__layout;t.clearRect(i.x,i.y,i.width,i.height),t.restore()}__updateMask(t){this.__hasMask=t?!0:this.children.some(e=>e.__.mask)}__renderMask(t,e){}__getNowWorld(t){if(t.matrix){this.__cameraWorld||(this.__cameraWorld={});const e=this.__cameraWorld;return uc(this.__world,t.matrix,e,void 0,this.__world),zr(this.__layout.renderBounds,e,e),e}else return this.__world}getTransform(t){return this.__layout.getTransform(t||"local")}getBounds(t,e){return this.__layout.getBounds(t,e)}getLayoutBounds(t,e,i){return this.__layout.getLayoutBounds(t,e,i)}getLayoutPoints(t,e){return this.__layout.getLayoutPoints(t,e)}getWorldBounds(t,e,i){const n=e?vc(this,e):this.worldTransform,a=i?t:{};return zr(t,n,a),a}worldToLocal(t,e,i,n){this.parent?this.parent.worldToInner(t,e,i,n):e&&Nr(e,t)}localToWorld(t,e,i,n){this.parent?this.parent.innerToWorld(t,e,i,n):e&&Nr(e,t)}worldToInner(t,e,i,n){n&&(n.innerToWorld(t,e,i),t=e||t),pc(this.worldTransform,t,e,i)}innerToWorld(t,e,i,n){cc(this.worldTransform,t,e,i),n&&n.worldToInner(e||t,null,i)}getInnerPoint(t,e,i,n){const a=n?t:{};return this.worldToInner(t,a,i,e),a}getInnerPointByLocal(t,e,i,n){return this.getInnerPoint(t,this.parent,i,n)}getLocalPoint(t,e,i,n){const a=n?t:{};return this.worldToLocal(t,a,i,e),a}getLocalPointByInner(t,e,i,n){return this.getWorldPoint(t,this.parent,i,n)}getWorldPoint(t,e,i,n){const a=n?t:{};return this.innerToWorld(t,a,i,e),a}getWorldPointByLocal(t,e,i,n){const a=n?t:{};return this.localToWorld(t,a,i,e),a}getPagePoint(t,e,i,n){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(t,e,i,n)}getWorldPointByPage(t,e,i,n){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(t,e,i,n)}setTransform(t,e){Fc(this,t,e)}transform(t,e){xc(this,t,e)}move(t,e){fc(this,t,e)}scaleOf(t,e,i,n){_c(this,An(this,t),e,i,n)}rotateOf(t,e){gc(this,An(this,t),e)}skewOf(t,e,i,n){kc(this,An(this,t),e,i,n)}transformWorld(t,e){bc(this,t,e)}moveWorld(t,e){yc(this,t,e)}scaleOfWorld(t,e,i,n){Ec(this,t,e,i,n)}rotateOfWorld(t,e){mc(this,t,e)}skewOfWorld(t,e,i,n){wc(this,t,e,i,n)}scaleResize(t,e=t,i){this.scaleX*=t,this.scaleY*=e}__scaleResize(t,e){}resizeWidth(t){}resizeHeight(t){}__hitWorld(t){return!0}__hit(t){return!0}__hitFill(t){return!0}__hitStroke(t,e){return!0}__hitPixel(t){return!0}__drawHitPath(t){}__updateHitCanvas(){}__render(t,e){}__drawFast(t,e){}__draw(t,e){}__clip(t,e){}__renderShape(t,e,i,n){}__updateWorldOpacity(){}__updateChange(){}__drawPath(t){}__drawRenderPath(t){}__updatePath(){}__updateRenderPath(){}__updateSortChildren(){}add(t,e){}remove(t,e){this.parent&&this.parent.remove(this,e)}dropTo(t,e,i){Cc(this,t,e,i)}on(t,e,i){}off(t,e,i){}on_(t,e,i,n){}off_(t){}once(t,e,i){}emit(t,e,i){}emitEvent(t,e){}hasEvent(t,e){return!1}static changeAttr(t,e,i){i?this.addAttr(t,e,i):wo(this.prototype,t,e)}static addAttr(t,e,i){i||(i=O),i(e)(this.prototype,t)}destroy(){if(!this.destroyed){const{parent:t}=this;t&&this.remove(),this.children&&this.removeAll(!0),this.hasEvent(Dt.DESTROY)&&this.emitEvent(new Dt(Dt.DESTROY,this,t)),this.__.destroy(),this.__layout.destroy(),this.__captureMap=this.__bubbleMap=this.__parentWait=this.__leaferWait=null,this.destroyed=!0}}};Ke=F([Vt(Kp),Vt(sc),Vt(rc),Vt(Vp),Vt(hc)],Ke);const{setListWithFn:Sn}=C,{sort:Bc}=Qs,{localBoxBounds:Rc,localStrokeBounds:Ac,localRenderBounds:Sc,maskLocalBoxBounds:Dc,maskLocalStrokeBounds:Pc,maskLocalRenderBounds:Tc}=Gi;let oa=class extends Ke{__updateStrokeSpread(){const{children:t}=this;for(let e=0,i=t.length;e<i;e++)if(t[e].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:t}=this;for(let e=0,i=t.length;e<i;e++)if(t[e].__layout.renderSpread)return 1;return 0}__updateBoxBounds(){Sn(this.__layout.boxBounds,this.children,this.__hasMask?Dc:Rc)}__updateStrokeBounds(){Sn(this.__layout.strokeBounds,this.children,this.__hasMask?Pc:Ac)}__updateRenderBounds(){Sn(this.__layout.renderBounds,this.children,this.__hasMask?Tc:Sc)}__updateSortChildren(){let t;const{children:e}=this;if(e.length>1){for(let i=0,n=e.length;i<n;i++)e[i].__tempNumber=i,e[i].__.zIndex&&(t=!0);e.sort(Bc),this.__layout.affectChildrenSort=t}}add(t,e){t!==this&&(t.parent&&t.parent.remove(t),t.parent=this,e===void 0?this.children.push(t):this.children.splice(e,0,t),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1),t.__layout.boxChanged||t.__layout.boxChange(),t.__layout.matrixChanged||t.__layout.matrixChange(),t.__parentWait&&Ye.run(t.__parentWait),this.leafer&&(t.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(Dt.ADD,t)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange())}addMany(...t){t.forEach(e=>this.add(e))}remove(t,e){if(t){const i=this.children.indexOf(t);i>-1&&(this.children.splice(i,1),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(t),e&&t.destroy())}else t===void 0&&super.remove(null,e)}removeAll(t){const{children:e}=this;e.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,e.forEach(i=>{this.__realRemoveChild(i),t&&i.destroy()}))}clear(){this.removeAll(!0)}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(t){t.parent=null,this.leafer&&(t.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(Dt.REMOVE,t),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(t,e){const i=new Dt(t,e,this);e.hasEvent(t)&&e.emitEvent(i),this.hasEvent(t)&&!this.isLeafer&&this.emitEvent(i),this.leafer.emitEvent(i)}};oa=F([Vt(oc)],oa);class lt{get length(){return this.list.length}constructor(t){this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return t&&this.keys[t.innerId]!==void 0}indexAt(t){return this.list[t]}indexOf(t){const e=this.keys[t.innerId];return e===void 0?-1:e}add(t){const{list:e,keys:i}=this;i[t.innerId]===void 0&&(e.push(t),i[t.innerId]=e.length-1)}addAt(t,e=0){const{keys:i}=this;if(i[t.innerId]===void 0){const{list:n}=this;for(let a=e,r=n.length;a<r;a++)i[n[a].innerId]++;e===0?n.unshift(t):(e>n.length&&(e=n.length),n.splice(e,0,t)),i[t.innerId]=e}}addList(t){for(let e=0;e<t.length;e++)this.add(t[e])}remove(t){const{list:e}=this;let i;for(let n=0,a=e.length;n<a;n++)i!==void 0?this.keys[e[n].innerId]=n-1:e[n].innerId===t.innerId&&(i=n,delete this.keys[t.innerId]);i!==void 0&&e.splice(i,1)}sort(t){const{list:e}=this;t?e.sort((i,n)=>n.__level-i.__level):e.sort((i,n)=>i.__level-n.__level)}forEach(t){this.list.forEach(t)}clone(){const t=new lt;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:e}=this;for(let i=0,n=t.length;i<n;i++)e[t[i].innerId]=i}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class Oc{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return this.keys[t.innerId]!==void 0}without(t){return this.keys[t.innerId]===void 0}sort(t){const{levels:e}=this;t?e.sort((i,n)=>n-i):e.sort((i,n)=>i-n)}addList(t){t.forEach(e=>{this.add(e)})}add(t){const{keys:e,levelMap:i}=this;e[t.innerId]||(e[t.innerId]=1,i[t.__level]?i[t.__level].push(t):(i[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let e;this.levels.forEach(i=>{e=this.levelMap[i];for(let n=0,a=e.length;n<a;n++)t(e[n])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}function c(s,t,e,i){var n=arguments.length,a=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,t,e,i);else for(var h=s.length-1;h>=0;h--)(r=s[h])&&(a=(n<3?r(a):n>3?r(t,e,a):r(t,e))||a);return n>3&&a&&Object.defineProperty(t,e,a),a}const Fo={},Hs={},vo={},ft={},Ze={},Bi={},la={},Gs={},Et={};function Co(s){return st(s,t=>({set(e){this.__setAttr(t,e),this.waitLeafer(()=>{Et.setStyle&&Et.setStyle(this,t+"Style",e)})}}))}function Bo(s){return st(s,t=>({set(e){if(this.__setAttr(t,e)){const i=this.__;i.__useArrow=i.startArrow!=="none"||i.endArrow!=="none",Eo(this)}}}))}function Js(s){return st(s,t=>({set(e){this.__setAttr(t,e),e&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}}))}function ti(s){return st(s,t=>({set(e){this.__setAttr(t,e),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}}))}function Mc(){return(s,t)=>{const e="_"+t;Ks(s,t,{set(i){this.isLeafer&&(this[e]=i)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[e]||this:this.leafer&&this.leafer.zoomLayer}})}}const{parse:Lc}=qe,Hr={},Gr=H.get("UIData");class Fe extends ro{get __strokeWidth(){const{strokeWidth:t,strokeWidthFixed:e}=this;if(e){const i=this.__leaf;let{scaleX:n}=i.__nowWorld||i.__world;return n<0&&(n=-n),n>1?t/n:t}else return t}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this.__leaf.leafer&&(this.__leaf.leafer.watcher.hasVisible=!0),this._visible=t}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,Gr.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,Gr.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),typeof t=="string"||!t?(this.__isFills&&(this.__removeInput("fill"),Ze.recycleImage("fill",this),this.__isFills=!1,this.__pixelFill&&(this.__pixelFill=!1)),this._fill=t):typeof t=="object"&&(this.__setInput("fill",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isFills=!0,this._fill||(this._fill=Hr))}setStroke(t){typeof t=="string"||!t?(this.__isStrokes&&(this.__removeInput("stroke"),Ze.recycleImage("stroke",this),this.__isStrokes=!1,this.__pixelStroke&&(this.__pixelStroke=!1)),this._stroke=t):typeof t=="object"&&(this.__setInput("stroke",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isStrokes=!0,this._stroke||(this._stroke=Hr))}setPath(t){typeof t=="string"?(this.__setInput("path",t),this._path=Lc(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){this.__setInput("shadow",t),t instanceof Array?(t.some(e=>e.visible===!1)&&(t=t.filter(e=>e.visible!==!1)),this._shadow=t.length?t:null):t?this._shadow=t.visible===!1?null:[t]:this._shadow=null}setInnerShadow(t){this.__setInput("innerShadow",t),t instanceof Array?(t.some(e=>e.visible===!1)&&(t=t.filter(e=>e.visible!==!1)),this._innerShadow=t.length?t:null):t?this._innerShadow=t.visible===!1?null:[t]:this._innerShadow=null}__computePaint(){const{fill:t,stroke:e}=this.__input;t&&ft.compute("fill",this.__leaf),e&&ft.compute("stroke",this.__leaf),this.__needComputePaint=!1}}const jr={number(s,t){return typeof s=="object"?s.type==="percent"?s.value*t:s.value:s}};class ji extends Fe{}class Oa extends ji{get __boxStroke(){return!this.__pathInputed}}class Ic extends ji{}class Wc extends Oa{}class $c extends Fe{}class Ma extends Fe{get __boxStroke(){return!this.__pathInputed}}class zc extends Fe{get __boxStroke(){return!this.__pathInputed}}class Nc extends Fe{}class Hc extends Fe{}class Gc extends Fe{}class jc extends ji{}const Uc={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900};class Yc extends Fe{get __useNaturalRatio(){return!1}setFontWeight(t){typeof t=="string"?(this.__setInput("fontWeight",t),this._fontWeight=Uc[t]||400):(this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t)}}class Vc extends Ma{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.__leaf.image&&(this.__leaf.image=null),this.fill=t?{type:"image",mode:"strench",url:t}:void 0}__getData(){const t=super.__getData();return delete t.fill,t}__getInputData(){const t=super.__getInputData();return delete t.fill,t}}class Xc extends Ma{}const qc={__updateStrokeSpread(){let s=0,t=0;const e=this.__,{strokeAlign:i,strokeWidth:n}=e;if((e.stroke||e.hitStroke==="all")&&n&&i!=="inside"&&(t=s=i==="center"?n/2:n,!e.__boxStroke)){const a=e.__isLinePath?0:10*s,r=e.strokeCap==="none"?0:n;s+=Math.max(a,r)}return e.__useArrow&&(s+=n*5),this.__layout.strokeBoxSpread=t,s},__updateRenderSpread(){let s=0;const{shadow:t,innerShadow:e,blur:i,backgroundBlur:n}=this.__;t&&t.forEach(r=>{s=Math.max(s,Math.max(Math.abs(r.y),Math.abs(r.x))+(r.spread>0?r.spread:0)+r.blur*1.5)}),i&&(s=Math.max(s,i));let a=s=Math.ceil(s);return e&&e.forEach(r=>{a=Math.max(a,Math.max(Math.abs(r.y),Math.abs(r.x))+(r.spread<0?-r.spread:0)+r.blur*1.5)}),n&&(a=Math.max(a,n)),this.__layout.renderShapeSpread=a,s+(this.__layout.strokeSpread||0)}},Kc={__updateChange(){const s=this.__;if(s.__useEffect){const{shadow:e,innerShadow:i,blur:n,backgroundBlur:a}=this.__;s.__useEffect=!!(e||i||n||a)}s.__checkSingle(),s.__isFills||s.__isStrokes||s.cornerRadius||s.__useEffect?s.__complex=!0:s.__complex&&(s.__complex=!1)},__drawFast(s,t){Ur(this,s,t)},__draw(s,t){const e=this.__;if(e.__complex){e.__needComputePaint&&e.__computePaint();const{fill:i,stroke:n,__drawAfterFill:a}=e;if(this.__drawRenderPath(s),e.__useEffect){const r=ft.shape(this,s,t);this.__nowWorld=this.__getNowWorld(t);const{shadow:h,innerShadow:o}=e;h&&la.shadow(this,s,r),i&&(e.__isFills?ft.fills(i,this,s):ft.fill(i,this,s)),a&&this.__drawAfterFill(s,t),o&&la.innerShadow(this,s,r),n&&(e.__isStrokes?ft.strokes(n,this,s):ft.stroke(n,this,s)),r.worldCanvas&&r.worldCanvas.recycle(),r.canvas.recycle()}else i&&(e.__isFills?ft.fills(i,this,s):ft.fill(i,this,s)),a&&this.__drawAfterFill(s,t),n&&(e.__isStrokes?ft.strokes(n,this,s):ft.stroke(n,this,s))}else e.__pathInputed?Ur(this,s,t):this.__drawFast(s,t)},__renderShape(s,t,e,i){if(this.__worldOpacity){s.setWorld(this.__nowWorld=this.__getNowWorld(t));const{fill:n,stroke:a}=this.__;this.__drawRenderPath(s),n&&!e&&(this.__.__pixelFill?ft.fills(n,this,s):ft.fill("#000000",this,s)),this.__.__isCanvas&&this.__drawAfterFill(s,t),a&&!i&&(this.__.__pixelStroke?ft.strokes(a,this,s):ft.stroke("#000000",this,s))}}};function Ur(s,t,e){const{fill:i,stroke:n,__drawAfterFill:a}=s.__;s.__drawRenderPath(t),i&&ft.fill(i,s,t),a&&s.__drawAfterFill(t,e),n&&ft.stroke(n,s,t)}const Zc={__drawFast(s,t){let{width:e,height:i,fill:n,stroke:a,__drawAfterFill:r}=this.__;if(n&&(s.fillStyle=n,s.fillRect(0,0,e,i)),r&&this.__drawAfterFill(s,t),a){const{strokeAlign:h,__strokeWidth:o}=this.__;if(!o)return;s.setStroke(a,o,this.__);const l=o/2;switch(h){case"center":s.strokeRect(0,0,e,i);break;case"inside":e-=o,i-=o,e<0||i<0?(s.save(),this.__clip(s,t),s.strokeRect(l,l,e,i),s.restore()):s.strokeRect(l,l,e,i);break;case"outside":s.strokeRect(-l,-l,e+o,i+o);break}}}};var da;let y=da=class extends Ke{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(t){typeof t=="number"?this.scaleX=this.scaleY=t:(this.scaleX=t.x,this.scaleY=t.y)}get scale(){const{scaleX:t,scaleY:e}=this;return t!==e?{x:t,y:e}:t}get pen(){const{path:t}=this.__;return As.set(this.path=t||[]),t||this.__drawPathByBox(As),As}get editConfig(){}get editOuter(){return this.__.__isLinePath?"LineEditTool":"EditTool"}get editInner(){return"PathEditor"}constructor(t){super(t)}reset(t){}set(t){Object.assign(this,t)}get(t){return typeof t=="string"?this.__.__getInput(t):this.__.__getInputData(t)}createProxyData(){}find(t,e){}findTag(t){return this.find({tag:t})}findOne(t,e){}findId(t){return this.findOne({id:t})}getPath(t,e){this.__layout.update();let i=e?this.__.__pathForRender:this.__.path;return i||(As.set(i=[]),this.__drawPathByBox(As)),t?qe.toCanvasData(i,!0):i}getPathString(t,e){return qe.stringify(this.getPath(t,e))}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){const t=this.__;t.lazy&&!this.__inLazyBounds&&!Gs.running?t.__needComputePaint=!0:t.__computePaint()}}__updateRenderPath(){if(this.__.path){const t=this.__;t.__pathForRender=t.cornerRadius?up.smooth(t.path,t.cornerRadius,t.cornerSmoothing):t.path,t.__useArrow&&vo.addArrows(this,!t.cornerRadius)}}__drawRenderPath(t){t.beginPath(),this.__drawPathByData(t,this.__.__pathForRender)}__drawPath(t){t.beginPath(),this.__drawPathByData(t,this.__.path)}__drawPathByData(t,e){e?Vd.drawPathByData(t,e):this.__drawPathByBox(t)}__drawPathByBox(t){const{x:e,y:i,width:n,height:a}=this.__layout.boxBounds;if(this.__.cornerRadius){const{cornerRadius:r}=this.__;t.roundRect(e,i,n,a,typeof r=="number"?[r]:r)}else t.rect(e,i,n,a)}export(t,e){return Gs.export(this,t,e)}clone(){return da.one(this.toJSON())}static one(t,e,i,n,a){return $i.get(t.tag||this.prototype.__tag,t,e,i,n,a)}static registerUI(){yt()(this)}static registerData(t){kt(t)(this.prototype)}static setEditConfig(t){}static setEditOuter(t){}static setEditInner(t){}destroy(){this.fill=this.stroke=null,super.destroy()}};c([kt(Fe)],y.prototype,"__",void 0);c([Mc()],y.prototype,"zoomLayer",void 0);c([mt("")],y.prototype,"id",void 0);c([mt("")],y.prototype,"name",void 0);c([mt("")],y.prototype,"className",void 0);c([Zs("pass-through")],y.prototype,"blendMode",void 0);c([vp(1)],y.prototype,"opacity",void 0);c([Cp(!0)],y.prototype,"visible",void 0);c([Co(!1)],y.prototype,"selected",void 0);c([Co(!1)],y.prototype,"disabled",void 0);c([Zs(!1)],y.prototype,"locked",void 0);c([Bp(0)],y.prototype,"zIndex",void 0);c([Rp(!1)],y.prototype,"mask",void 0);c([Ap(!1)],y.prototype,"eraser",void 0);c([xs(0,!0)],y.prototype,"x",void 0);c([xs(0,!0)],y.prototype,"y",void 0);c([O(100,!0)],y.prototype,"width",void 0);c([O(100,!0)],y.prototype,"height",void 0);c([yo(1,!0)],y.prototype,"scaleX",void 0);c([yo(1,!0)],y.prototype,"scaleY",void 0);c([Ta(0,!0)],y.prototype,"rotation",void 0);c([Ta(0,!0)],y.prototype,"skewX",void 0);c([Ta(0,!0)],y.prototype,"skewY",void 0);c([xs(0,!0)],y.prototype,"offsetX",void 0);c([xs(0,!0)],y.prototype,"offsetY",void 0);c([xs(0,!0)],y.prototype,"scrollX",void 0);c([xs(0,!0)],y.prototype,"scrollY",void 0);c([zi()],y.prototype,"origin",void 0);c([zi()],y.prototype,"around",void 0);c([mt(!1)],y.prototype,"lazy",void 0);c([bp(1)],y.prototype,"pixelRatio",void 0);c([Fp()],y.prototype,"path",void 0);c([bt()],y.prototype,"windingRule",void 0);c([bt(!0)],y.prototype,"closed",void 0);c([zi(!1)],y.prototype,"flow",void 0);c([O(0)],y.prototype,"padding",void 0);c([O(0)],y.prototype,"gap",void 0);c([O("top-left")],y.prototype,"flowAlign",void 0);c([O(!1)],y.prototype,"flowWrap",void 0);c([O("box")],y.prototype,"itemBox",void 0);c([O(!0)],y.prototype,"inFlow",void 0);c([O()],y.prototype,"autoWidth",void 0);c([O()],y.prototype,"autoHeight",void 0);c([O()],y.prototype,"lockRatio",void 0);c([O()],y.prototype,"autoBox",void 0);c([O()],y.prototype,"widthRange",void 0);c([O()],y.prototype,"heightRange",void 0);c([mt(!1)],y.prototype,"draggable",void 0);c([mt()],y.prototype,"dragBounds",void 0);c([mt(!1)],y.prototype,"editable",void 0);c([ts(!0)],y.prototype,"hittable",void 0);c([ts("path")],y.prototype,"hitFill",void 0);c([le("path")],y.prototype,"hitStroke",void 0);c([ts(!1)],y.prototype,"hitBox",void 0);c([ts(!0)],y.prototype,"hitChildren",void 0);c([ts(!0)],y.prototype,"hitSelf",void 0);c([ts()],y.prototype,"hitRadius",void 0);c([Sp("")],y.prototype,"cursor",void 0);c([Zs()],y.prototype,"fill",void 0);c([le()],y.prototype,"stroke",void 0);c([le("inside")],y.prototype,"strokeAlign",void 0);c([le(1)],y.prototype,"strokeWidth",void 0);c([le(!1)],y.prototype,"strokeWidthFixed",void 0);c([le("none")],y.prototype,"strokeCap",void 0);c([le("miter")],y.prototype,"strokeJoin",void 0);c([le()],y.prototype,"dashPattern",void 0);c([le()],y.prototype,"dashOffset",void 0);c([le(10)],y.prototype,"miterLimit",void 0);c([Bo("none")],y.prototype,"startArrow",void 0);c([Bo("none")],y.prototype,"endArrow",void 0);c([bt(0)],y.prototype,"cornerRadius",void 0);c([bt()],y.prototype,"cornerSmoothing",void 0);c([Js()],y.prototype,"shadow",void 0);c([Js()],y.prototype,"innerShadow",void 0);c([Js()],y.prototype,"blur",void 0);c([Js()],y.prototype,"backgroundBlur",void 0);c([Js()],y.prototype,"grayscale",void 0);c([mt()],y.prototype,"normalStyle",void 0);c([mt()],y.prototype,"hoverStyle",void 0);c([mt()],y.prototype,"pressStyle",void 0);c([mt()],y.prototype,"focusStyle",void 0);c([mt()],y.prototype,"selectedStyle",void 0);c([mt()],y.prototype,"disabledStyle",void 0);c([mt({})],y.prototype,"data",void 0);c([Jt(Ke.prototype.reset)],y.prototype,"reset",null);y=da=c([Vt(qc),Vt(Kc),Hi()],y);let he=class extends y{get __tag(){return"Group"}get isBranch(){return!0}constructor(t){super(t)}reset(t){this.__setBranch(),super.reset(t)}__setBranch(){this.children||(this.children=[])}set(t){if(t.children){const{children:e}=t;delete t.children,this.children?this.clear():this.__setBranch(),super.set(t);let i;e.forEach(n=>{i=n.__?n:$i.get(n.tag,n),this.add(i)}),t.children=e}else super.set(t)}toJSON(t){const e=super.toJSON(t);return e.children=this.children.map(i=>i.toJSON(t)),e}pick(t,e){}addAt(t,e){this.add(t,e)}addAfter(t,e){this.add(t,this.children.indexOf(e)+1)}addBefore(t,e){this.add(t,this.children.indexOf(e))}add(t,e){}addMany(...t){}remove(t,e){}removeAll(t){}clear(){}};c([kt(ji)],he.prototype,"__",void 0);he=c([Vt(oa),yt()],he);var Ri;const Dn=H.get("Leafer");let Qt=Ri=class extends he{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&Ct.isComplete}get layoutLocked(){return!this.layouter.running}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds()}constructor(t,e){super(e),this.config={type:"design",start:!0,hittable:!0,smooth:!0,lazySpeard:100,zoom:{min:.01,max:256},move:{holdSpaceKey:!0,holdMiddleKey:!0,autoDistance:2}},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=t,t&&(t.view||t.width)&&this.init(t),Ri.list.add(this)}init(t,e){if(this.canvas)return;this.__setLeafer(this),t&&_t.assign(this.config,t);let i;const{config:n}=this;this.initType(n.type);const a=this.canvas=pt.canvas(n);this.__controllers.push(this.renderer=pt.renderer(this,a,n),this.watcher=pt.watcher(this,n),this.layouter=pt.layouter(this,n)),this.isApp&&this.__setApp(),this.__checkAutoLayout(n),this.view=a.view,e?(this.__bindApp(e),i=e.running):(this.selector=pt.selector(this),this.interaction=pt.interaction(this,a,this.selector,n),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=pt.hitCanvasManager()),this.canvasManager=new ao,i=n.start),this.hittable=n.hittable,this.fill=n.fill,this.canvasManager.add(a),this.__listenEvents(),i&&(this.__startTimer=setTimeout(this.start.bind(this))),Ye.run(this.__initWait),this.onInit()}onInit(){}initType(t){}set(t){this.waitInit(()=>{super.set(t)})}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.ready?this.emitLeafer(at.RESTART):this.emitLeafer(at.START),this.__controllers.forEach(t=>t.start()),this.isApp||this.renderer.render(),this.running=!0)}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach(t=>t.stop()),this.running=!1,this.emitLeafer(at.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(t){const e=_t.copyAttrs({},t,Ee);Object.keys(e).forEach(i=>this[i]=e[i])}forceRender(t){this.renderer.addBlock(t?new et(t):this.canvas.bounds),this.viewReady&&this.renderer.update()}updateCursor(t){const e=this.interaction;e&&(t?e.setCursor(t):e.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(t){const{canvas:e}=this;if(!e||e.isSameSize(t))return;const i=_t.copyAttrs({},this.canvas,Ee);e.resize(t),this.updateLazyBounds(),this.__onResize(new es(t,i))}__onResize(t){this.emitEvent(t),_t.copyAttrs(this.__,t,Ee),(!t.width||!t.height)&&Dn.warn("w = 0 or h = 0"),setTimeout(()=>{this.canvasManager&&this.canvasManager.clearRecycled()},0)}__setApp(){}__bindApp(t){this.selector=t.selector,this.interaction=t.interaction,this.canvasManager=t.canvasManager,this.hitCanvasManager=t.hitCanvasManager}__setLeafer(t){this.leafer=t,this.__level=1}__checkAutoLayout(t){(!t.width||!t.height)&&(this.autoLayout=new fl(t),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(t,e){return this.canvas&&(Ee.includes(t)?(e||Dn.warn(t+" is 0"),this.__changeCanvasSize(t,e)):t==="fill"?this.__changeFill(e):t==="hittable"?this.parent||(this.canvas.hittable=e):t==="zIndex"&&(this.canvas.zIndex=e,setTimeout(()=>this.parent&&this.parent.__updateSortChildren()))),super.__setAttr(t,e)}__getAttr(t){return this.canvas&&Ee.includes(t)?this.canvas[t]:super.__getAttr(t)}__changeCanvasSize(t,e){const i=_t.copyAttrs({},this.canvas,Ee);i[t]=this.config[t]=e,e&&this.canvas.stopAutoLayout(),this.__doResize(i)}__changeFill(t){this.config.fill=t,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=t:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready||(this.ready=!0,this.emitLeafer(at.BEFORE_READY),this.emitLeafer(at.READY),this.emitLeafer(at.AFTER_READY),Ye.run(this.__readyWait))}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(at.VIEW_READY),Ye.run(this.__viewReadyWait))}__onNextRender(){if(this.viewReady){Ye.run(this.__nextRenderWait);const{imageReady:t}=this;t&&!this.viewCompleted&&this.__checkViewCompleted(),t||(this.viewCompleted=!1)}}__checkViewCompleted(t=!0){this.nextRender(()=>{this.imageReady&&(t&&this.emitLeafer(at.VIEW_COMPLETED),Ye.run(this.__viewCompletedWait),this.viewCompleted=!0)})}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender(()=>this.interaction.updateCursor())}waitInit(t,e){e&&(t=t.bind(e)),this.__initWait||(this.__initWait=[]),this.canvas?t():this.__initWait.push(t)}waitReady(t,e){e&&(t=t.bind(e)),this.ready?t():this.__readyWait.push(t)}waitViewReady(t,e){e&&(t=t.bind(e)),this.viewReady?t():this.__viewReadyWait.push(t)}waitViewCompleted(t,e){e&&(t=t.bind(e)),this.__viewCompletedWait.push(t),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(t,e,i){e&&(t=t.bind(e));const n=this.__nextRenderWait;if(i){for(let a=0;a<n.length;a++)if(n[a]===t){n.splice(a,1);break}}else n.push(t)}zoom(t,e,i){}getValidMove(t,e){return{x:t,y:e}}getValidScale(t){return t}getWorldPointByClient(t,e){return this.interaction&&this.interaction.getLocal(t,e)}__checkUpdateLayout(){this.__layout.update()}emitLeafer(t){this.emitEvent(new at(t,this))}__listenEvents(){const t=Xt.start("FirstCreate "+this.innerName);this.once(at.START,()=>Xt.end(t)),this.once(G.START,()=>this.updateLazyBounds()),this.once(G.END,()=>this.__onReady()),this.once(X.START,()=>this.__onCreated()),this.once(X.END,()=>this.__onViewReady()),this.__eventIds.push(this.on_(Pe.DATA,this.__onWatchData,this),this.on_(X.NEXT,this.__onNextRender,this),this.on_(G.CHECK_UPDATE,this.__checkUpdateLayout,this))}__removeListenEvents(){this.off_(this.__eventIds),this.__eventIds.length=0}destroy(t){const e=()=>{if(!this.destroyed){Ri.list.remove(this);try{this.stop(),this.emitEvent(new at(at.END,this)),this.__removeListenEvents(),this.__controllers.forEach(i=>{this.parent&&i===this.interaction||i.destroy()}),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager.destroy()),this.canvas.destroy(),this.config.view=this.view=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout(()=>{Ct.clearRecycled()},100)}catch(i){Dn.error(i)}}};t?e():setTimeout(e)}};Qt.list=new lt;c([kt(Ic)],Qt.prototype,"__",void 0);c([O()],Qt.prototype,"pixelRatio",void 0);Qt=Ri=c([yt()],Qt);let Qe=class extends y{get __tag(){return"Rect"}constructor(t){super(t)}};c([kt(Ma)],Qe.prototype,"__",void 0);Qe=c([Vt(Zc),Hi(),yt()],Qe);const ss=Qe.prototype,Qc=he.prototype,Pn={},{copy:Jc,add:tu,includes:eu}=C;let ct=class extends he{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(t){super(t),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(){const t=this.__;if(this.children.length){if(t.__autoSide){if(this.leafer&&this.leafer.ready&&this.leafer.layouter.addExtra(this),super.__updateBoxBounds(),!t.__autoSize){const e=this.__layout.boxBounds;t.__autoWidth||(e.height+=e.y,e.width=t.width,e.x=e.y=0),t.__autoHeight||(e.width+=e.x,e.height=t.height,e.y=e.x=0)}}else this.__updateRectBoxBounds();t.flow&&this.__updateContentBounds()}else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let t;const{renderBounds:e}=this.__layout;this.children.length?(super.__updateRenderBounds(),Jc(Pn,e),this.__updateRectRenderBounds(),t=!eu(e,Pn)||void 0):this.__updateRectRenderBounds(),this.isOverflow!==t&&(this.isOverflow=t),t&&!(this.__.__drawAfterFill=this.__.overflow==="hide")&&tu(e,Pn)}__updateRectRenderBounds(){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(t,e){}__renderGroup(t,e){}__render(t,e){this.__.__drawAfterFill?this.__renderRect(t,e):(this.__renderRect(t,e),this.children.length&&this.__renderGroup(t,e))}__drawAfterFill(t,e){const{length:i}=this.children;this.isOverflow?(t.save(),t.clip(),i&&this.__renderGroup(t,e),t.restore()):i&&this.__renderGroup(t,e),this.__.stroke&&i&&(t.setWorld(this.__nowWorld),this.__drawRenderPath(t))}};c([kt(Oa)],ct.prototype,"__",void 0);c([mt(!1)],ct.prototype,"resizeChildren",void 0);c([mo("show")],ct.prototype,"overflow",void 0);c([Jt(ss.__updateStrokeSpread)],ct.prototype,"__updateStrokeSpread",null);c([Jt(ss.__updateRenderSpread)],ct.prototype,"__updateRectRenderSpread",null);c([Jt(ss.__updateBoxBounds)],ct.prototype,"__updateRectBoxBounds",null);c([Jt(ss.__updateStrokeBounds)],ct.prototype,"__updateStrokeBounds",null);c([Jt(ss.__updateRenderBounds)],ct.prototype,"__updateRectRenderBounds",null);c([Jt(ss.__updateChange)],ct.prototype,"__updateRectChange",null);c([Jt(ss.__render)],ct.prototype,"__renderRect",null);c([Jt(Qc.__render)],ct.prototype,"__renderGroup",null);ct=c([Hi(),yt()],ct);let js=class extends ct{get __tag(){return"Frame"}get isFrame(){return!0}constructor(t){super(t)}};c([kt(Wc)],js.prototype,"__",void 0);c([Zs("#FFFFFF")],js.prototype,"fill",void 0);c([mo("hide")],js.prototype,"overflow",void 0);js=c([yt()],js);const{moveTo:Yr,closePath:Vr,ellipse:ls}=Je;let ys=class extends y{get __tag(){return"Ellipse"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,innerRadius:i,startAngle:n,endAngle:a}=this.__,r=t/2,h=e/2,o=this.__.path=[];i?(n||a?(i<1&&ls(o,r,h,r*i,h*i,0,n,a,!1),ls(o,r,h,r,h,0,a,n,!0),i<1&&Vr(o)):(i<1&&(ls(o,r,h,r*i,h*i),Yr(o,t,h)),ls(o,r,h,r,h,0,360,0,!0)),b.ellipseToCurve&&(this.__.path=this.getPath(!0))):n||a?(Yr(o,r,h),ls(o,r,h,r,h,0,n,a,!1),Vr(o)):ls(o,r,h,r,h)}};c([kt(zc)],ys.prototype,"__",void 0);c([bt(0)],ys.prototype,"innerRadius",void 0);c([bt(0)],ys.prototype,"startAngle",void 0);c([bt(0)],ys.prototype,"endAngle",void 0);ys=c([yt()],ys);const{moveTo:su,lineTo:iu,drawPoints:Xr}=Je,{rotate:nu,getAngle:au,getDistance:ru,defaultPoint:qr}=R,{toBounds:hu}=Pa;let oe=class extends y{get __tag(){return"Line"}get toPoint(){const{width:t,rotation:e}=this.__,i=so();return t&&(i.x=t),e&&nu(i,e),i}set toPoint(t){this.width=ru(qr,t),this.rotation=au(qr,t),this.height&&(this.height=0)}constructor(t){super(t)}__updatePath(){const t=this.__,e=t.path=[];t.points?Xr(e,t.points,!1,t.closed):(su(e,0,0),iu(e,this.width,0))}__updateRenderPath(){const t=this.__;!this.pathInputed&&t.points&&t.curve?(Xr(t.__pathForRender=[],t.points,t.curve,t.closed),t.__useArrow&&vo.addArrows(this,!1)):super.__updateRenderPath()}__updateBoxBounds(){this.points?hu(this.__.__pathForRender,this.__layout.boxBounds):super.__updateBoxBounds()}};c([kt($c)],oe.prototype,"__",void 0);c([Ni("center")],oe.prototype,"strokeAlign",void 0);c([O(0)],oe.prototype,"height",void 0);c([bt()],oe.prototype,"points",void 0);c([bt(0)],oe.prototype,"curve",void 0);c([bt(!1)],oe.prototype,"closed",void 0);oe=c([yt()],oe);const{sin:ou,cos:lu,PI:Kr}=Math,{moveTo:du,lineTo:pu,closePath:cu,drawPoints:uu}=Je,Ro=oe.prototype;let be=class extends y{get __tag(){return"Polygon"}constructor(t){super(t)}__updatePath(){const t=this.__.path=[];if(this.__.points)uu(t,this.__.points,!1,!0);else{const{width:e,height:i,sides:n}=this.__,a=e/2,r=i/2;du(t,a,0);for(let h=1;h<n;h++)pu(t,a+a*ou(h*2*Kr/n),r-r*lu(h*2*Kr/n))}cu(t)}__updateRenderPath(){}__updateBoxBounds(){}};c([kt(Nc)],be.prototype,"__",void 0);c([bt(3)],be.prototype,"sides",void 0);c([bt()],be.prototype,"points",void 0);c([bt(0)],be.prototype,"curve",void 0);c([Jt(Ro.__updateRenderPath)],be.prototype,"__updateRenderPath",null);c([Jt(Ro.__updateBoxBounds)],be.prototype,"__updateBoxBounds",null);be=c([Hi(),yt()],be);const{sin:fu,cos:_u,PI:Zr}=Math,{moveTo:gu,lineTo:ku,closePath:yu}=Je;let Us=class extends y{get __tag(){return"Star"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,corners:i,innerRadius:n}=this.__,a=t/2,r=e/2,h=this.__.path=[];gu(h,a,0);for(let o=1;o<i*2;o++)ku(h,a+(o%2===0?a:a*n)*fu(o*Zr/i),r-(o%2===0?r:r*n)*_u(o*Zr/i));yu(h)}};c([kt(Hc)],Us.prototype,"__",void 0);c([bt(5)],Us.prototype,"corners",void 0);c([bt(.382)],Us.prototype,"innerRadius",void 0);Us=c([yt()],Us);let Si=class extends Qe{get __tag(){return"Image"}get ready(){return this.image?this.image.ready:!1}constructor(t){super(t),this.on(Ie.LOADED,e=>{e.attrName==="fill"&&e.attrValue.url===this.url&&(this.image=e.image)})}destroy(){this.image=null,super.destroy()}};c([kt(Vc)],Si.prototype,"__",void 0);c([O("")],Si.prototype,"url",void 0);Si=c([yt()],Si);let Me=class extends Qe{get __tag(){return"Canvas"}constructor(t){super(t),this.canvas=pt.canvas(this.__),this.context=this.canvas.context,this.__.__isCanvas=this.__.__drawAfterFill=!0}draw(t,e,i,n){t.__layout.update();const a=new Oe(t.__world).invert(),r=new Oe;e&&r.translate(e.x,e.y),i&&(typeof i=="number"?r.scale(i):r.scale(i.x,i.y)),n&&r.rotate(n),a.multiplyParent(r),t.__render(this.canvas,{matrix:a.withScale()}),this.paint()}paint(){this.forceUpdate("fill")}__drawAfterFill(t,e){const i=this.canvas.view,{width:n,height:a}=this;this.__.cornerRadius||this.pathInputed?(t.save(),t.clip(),t.drawImage(this.canvas.view,0,0,i.width,i.height,0,0,n,a),t.restore()):t.drawImage(this.canvas.view,0,0,i.width,i.height,0,0,n,a)}__updateSize(){const{canvas:t}=this;if(t){const{smooth:e}=this.__;t.smooth!==e&&(t.smooth=e),t.resize(this.__)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.context=null),super.destroy()}};c([kt(Xc)],Me.prototype,"__",void 0);c([ti(100)],Me.prototype,"width",void 0);c([ti(100)],Me.prototype,"height",void 0);c([ti(b.devicePixelRatio)],Me.prototype,"pixelRatio",void 0);c([ti(!0)],Me.prototype,"smooth",void 0);c([ti()],Me.prototype,"contextSettings",void 0);Me=c([yt()],Me);const{copyAndSpread:Eu,includes:mu,isSame:wu,spread:xu,setList:bu}=C;let U=class extends y{get __tag(){return"Text"}get editInner(){return"TextEditor"}get textDrawData(){return this.__layout.update(),this.__.__textDrawData}constructor(t){super(t)}__drawHitPath(t){const{__lineHeight:e,__baseLine:i,__textDrawData:n}=this.__;t.beginPath(),this.__.__letterSpacing<0?this.__drawPathByData(t):n.rows.forEach(a=>t.rect(a.x,a.y-i,a.width,e))}__drawPathByData(t,e){const{x:i,y:n,width:a,height:r}=this.__layout.boxBounds;t.rect(i,n,a,r)}__drawRenderPath(t){t.font=this.__.__font}__updateTextDrawData(){const t=this.__;t.__textDrawData=Fo.getDrawData(t.text,this.__)}__updateBoxBounds(){const t=this.__,e=this.__layout,{lineHeight:i,letterSpacing:n,fontFamily:a,fontSize:r,fontWeight:h,italic:o,textCase:l,textOverflow:d,padding:_}=t,u=t.__autoWidth,p=t.__autoHeight;t.__lineHeight=jr.number(i,r),t.__letterSpacing=jr.number(n,r),t.__padding=_?Gt.fourNumber(_):void 0,t.__baseLine=t.__lineHeight-(t.__lineHeight-r*.7)/2,t.__font=`${o?"italic ":""}${l==="small-caps"?"small-caps ":""}${h!=="normal"?h+" ":""}${r}px ${a}`,t.__clipText=d!=="show"&&!t.__autoSize,this.__updateTextDrawData();const{bounds:f}=t.__textDrawData,g=e.boxBounds;if(t.__lineHeight<r&&xu(f,r/2),u||p){if(g.x=u?f.x:0,g.y=p?f.y:0,g.width=u?f.width:t.width,g.height=p?f.height:t.height,_){const[E,k,w,x]=t.__padding;u&&(g.x-=x,g.width+=k+x),p&&(g.y-=E,g.height+=w+E)}this.__updateNaturalSize()}else super.__updateBoxBounds();o&&(g.width+=r*.16);const m=mu(g,f)?g:f;wu(m,e.contentBounds)?t.__textBoxBounds=m:(e.contentBounds=m,e.renderChanged=!0,bu(t.__textBoxBounds={},[g,f]))}__updateRenderSpread(){let t=super.__updateRenderSpread();return t||(t=this.__layout.boxBounds===this.__layout.contentBounds?0:1),t}__updateRenderBounds(){Eu(this.__layout.renderBounds,this.__.__textBoxBounds,this.__layout.renderSpread)}};c([kt(Yc)],U.prototype,"__",void 0);c([O(0)],U.prototype,"width",void 0);c([O(0)],U.prototype,"height",void 0);c([mt(!1)],U.prototype,"resizeFontSize",void 0);c([Zs("#000000")],U.prototype,"fill",void 0);c([Ni("outside")],U.prototype,"strokeAlign",void 0);c([ts("all")],U.prototype,"hitFill",void 0);c([O("")],U.prototype,"text",void 0);c([O("L")],U.prototype,"fontFamily",void 0);c([O(12)],U.prototype,"fontSize",void 0);c([O("normal")],U.prototype,"fontWeight",void 0);c([O(!1)],U.prototype,"italic",void 0);c([O("none")],U.prototype,"textCase",void 0);c([O("none")],U.prototype,"textDecoration",void 0);c([O(0)],U.prototype,"letterSpacing",void 0);c([O({type:"percent",value:1.5})],U.prototype,"lineHeight",void 0);c([O(0)],U.prototype,"paraIndent",void 0);c([O(0)],U.prototype,"paraSpacing",void 0);c([O("left")],U.prototype,"textAlign",void 0);c([O("top")],U.prototype,"verticalAlign",void 0);c([O("normal")],U.prototype,"textWrap",void 0);c([O("show")],U.prototype,"textOverflow",void 0);U=c([yt()],U);let Es=class extends y{get __tag(){return"Path"}constructor(t){super(t),this.__.__pathInputed=2}};c([kt(Gc)],Es.prototype,"__",void 0);c([Ni("center")],Es.prototype,"strokeAlign",void 0);Es=c([yt()],Es);let Di=class extends he{get __tag(){return"Pen"}constructor(t){super(t)}setStyle(t){const e=this.pathElement=new Es(t);return this.pathStyle=t,this.__path=e.path||(e.path=[]),this.add(e),this}beginPath(){return this.__path.length=0,this.paint(),this}moveTo(t,e){return this}lineTo(t,e){return this}bezierCurveTo(t,e,i,n,a,r){return this}quadraticCurveTo(t,e,i,n){return this}closePath(){return this}rect(t,e,i,n){return this}roundRect(t,e,i,n,a){return this}ellipse(t,e,i,n,a,r,h,o){return this}arc(t,e,i,n,a,r){return this}arcTo(t,e,i,n,a){return this}drawEllipse(t,e,i,n,a,r,h,o){return this}drawArc(t,e,i,n,a,r){return this}drawPoints(t,e,i){return this}clearPath(){return this}paint(){this.pathElement.forceUpdate("path")}};c([kt(jc)],Di.prototype,"__",void 0);c([Fu()],Di.prototype,"path",void 0);Di=c([Vt(Da,["set","beginPath","path"]),yt()],Di);function Fu(){return(s,t)=>{Ks(s,t,{get(){return this.__path}})}}function ve(s,t,e,i){var n=arguments.length,a=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,t,e,i);else for(var h=s.length-1;h>=0;h--)(r=s[h])&&(a=(n<3?r(a):n>3?r(t,e,a):r(t,e))||a);return n>3&&a&&Object.defineProperty(t,e,a),a}let Qr=class extends Qt{get __tag(){return"App"}get isApp(){return!0}constructor(t,e){super(t,e)}init(t,e){if(super.init(t,e),t){const{ground:i,tree:n,sky:a,editor:r}=t;i&&(this.ground=this.addLeafer(i)),(n||r)&&(this.tree=this.addLeafer(n)),(a||r)&&(this.sky=this.addLeafer(a||{type:"draw",usePartRender:!1})),r&&(this.editor=pt.editor(r),this.sky.add(this.editor))}}__setApp(){const{canvas:t}=this,{realCanvas:e,view:i}=this.config;e||i===this.canvas.view||!t.parentView?this.realCanvas=!0:t.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable(),this.__eventIds.push(this.on_(me.CHANGE,this.__onPropertyChange,this))}start(){super.start(),this.children.forEach(t=>t.start())}stop(){this.children.forEach(t=>t.stop()),super.stop()}unlockLayout(){super.unlockLayout(),this.children.forEach(t=>t.unlockLayout())}lockLayout(){super.lockLayout(),this.children.forEach(t=>t.lockLayout())}forceRender(t){this.children.forEach(e=>e.forceRender(t))}addLeafer(t){const e=new Qt(t);return this.add(e),e}add(t,e){if(!t.view){if(this.realCanvas&&!this.canvas.bounds){setTimeout(()=>this.add(t,e),10);return}t.init(this.__getChildConfig(t.userConfig),this)}super.add(t,e),e!==void 0&&(t.canvas.childIndex=e),this.__listenChildEvents(t)}__onPropertyChange(){H.showHitView&&this.children.forEach(t=>t.forceUpdate("surface"))}__onCreated(){this.created=this.children.every(t=>t.created)}__onReady(){this.children.every(t=>t.ready)&&super.__onReady()}__onViewReady(){this.children.every(t=>t.viewReady)&&super.__onViewReady()}__onChildRenderEnd(t){this.renderer.addBlock(t.renderBounds),this.viewReady&&this.renderer.update()}__render(t,e){if(e.matrix){const{a:i,b:n,c:a,d:r,e:h,f:o}=e.matrix;t.setTransform(i,n,a,r,h,o)}this.children.forEach(i=>t.copyWorld(i.canvas))}__onResize(t){this.children.forEach(e=>e.resize(t)),super.__onResize(t)}__checkUpdateLayout(){this.children.forEach(t=>t.__layout.update())}__getChildConfig(t){let e=Object.assign({},this.config);return e.hittable=e.realCanvas=void 0,t&&_t.assign(e,t),this.autoLayout&&_t.copyAttrs(e,this,Ee),e.view=this.realCanvas?void 0:this.view,e.fill=void 0,e}__listenChildEvents(t){t.once(G.END,()=>this.__onReady()),t.once(X.START,()=>this.__onCreated()),t.once(X.END,()=>this.__onViewReady()),this.realCanvas&&this.__eventIds.push(t.on_(X.END,this.__onChildRenderEnd,this))}};Qr=ve([yt()],Qr);const yi={},Ws={isHoldSpaceKey(){return Ws.isHold("Space")},isHold(s){return yi[s]},setDownCode(s){yi[s]||(yi[s]=!0)},setUpCode(s){yi[s]=!1}},Yt={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(s){s.buttons||(s.buttons=1)},left(s){return s.buttons===1},right(s){return s.buttons===2},middle(s){return s.buttons===4}};class Ui extends pe{get spaceKey(){return Ws.isHoldSpaceKey()}get left(){return Yt.left(this)}get right(){return Yt.right(this)}get middle(){return Yt.middle(this)}constructor(t){super(t.type),this.bubbles=!0,Object.assign(this,t)}getPage(){return this.current.getPagePoint(this)}getInner(t){return t||(t=this.current),t.getInnerPoint(this)}getLocal(t){return t||(t=this.current),t.getLocalPoint(this)}static changeName(t,e){ks.changeName(t,e)}}let B=class extends Ui{};B.POINTER="pointer";B.BEFORE_DOWN="pointer.before_down";B.BEFORE_MOVE="pointer.before_move";B.BEFORE_UP="pointer.before_up";B.DOWN="pointer.down";B.MOVE="pointer.move";B.UP="pointer.up";B.OVER="pointer.over";B.OUT="pointer.out";B.ENTER="pointer.enter";B.LEAVE="pointer.leave";B.TAP="tap";B.DOUBLE_TAP="double_tap";B.CLICK="click";B.DOUBLE_CLICK="double_click";B.LONG_PRESS="long_press";B.LONG_TAP="long_tap";B.MENU="pointer.menu";B.MENU_TAP="pointer.menu_tap";B=ve([Le()],B);const Ss={};let z=class extends B{static setList(t){this.list=t instanceof lt?t:new lt(t)}static setData(t){this.data=t}static getValidMove(t,e,i){const{draggable:n,dragBounds:a,x:r,y:h}=t,o=t.getLocalPoint(i,null,!0);return o.x+=e.x-r,o.y+=e.y-h,a&&this.getMoveInDragBounds(t.__local,a==="parent"?t.parent.boxBounds:a,o,!0),n==="x"&&(o.y=0),n==="y"&&(o.x=0),o}static getMoveInDragBounds(t,e,i,n){const a=t.x+i.x,r=t.y+i.y,h=a+t.width,o=r+t.height,l=e.x+e.width,d=e.y+e.height;return n||(i=Object.assign({},i)),C.includes(t,e)?(a>e.x?i.x+=e.x-a:h<l&&(i.x+=l-h),r>e.y?i.y+=e.y-r:o<d&&(i.y+=d-o)):(a<e.x?i.x+=e.x-a:h>l&&(i.x+=l-h),r<e.y?i.y+=e.y-r:o>d&&(i.y+=d-o)),i}getPageMove(t){return this.assignMove(t),this.current.getPagePoint(Ss,null,!0)}getInnerMove(t,e){return t||(t=this.current),this.assignMove(e),t.getInnerPoint(Ss,null,!0)}getLocalMove(t,e){return t||(t=this.current),this.assignMove(e),t.getLocalPoint(Ss,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(t){return this.getInnerMove(t,!0)}getLocalTotal(t){return this.getLocalMove(t,!0)}getPageBounds(){const t=this.getPageTotal(),e=this.getPage(),i={};return C.set(i,e.x-t.x,e.y-t.y,t.x,t.y),C.unsign(i),i}assignMove(t){Ss.x=t?this.totalX:this.moveX,Ss.y=t?this.totalY:this.moveY}};z.BEFORE_DRAG="drag.before_drag";z.START="drag.start";z.DRAG="drag";z.END="drag.end";z.OVER="drag.over";z.OUT="drag.out";z.ENTER="drag.enter";z.LEAVE="drag.leave";z=ve([Le()],z);let Ys=class extends B{static setList(t){z.setList(t)}static setData(t){z.setData(t)}};Ys.DROP="drop";Ys=ve([Le()],Ys);let xt=class extends z{};xt.BEFORE_MOVE="move.before_move";xt.START="move.start";xt.MOVE="move";xt.END="move.end";xt=ve([Le()],xt);let re=class extends Ui{};re.BEFORE_ROTATE="rotate.before_rotate";re.START="rotate.start";re.ROTATE="rotate";re.END="rotate.end";re=ve([Le()],re);let qt=class extends z{};qt.SWIPE="swipe";qt.LEFT="swipe.left";qt.RIGHT="swipe.right";qt.UP="swipe.up";qt.DOWN="swipe.down";qt=ve([Le()],qt);let Kt=class extends Ui{};Kt.BEFORE_ZOOM="zoom.before_zoom";Kt.START="zoom.start";Kt.ZOOM="zoom";Kt.END="zoom.end";Kt=ve([Le()],Kt);let Te=class extends Ui{};Te.DOWN="key.down";Te.HOLD="key.hold";Te.UP="key.up";Te=ve([Le()],Te);function Ao(s){s.isApp||s.__eventIds.push(s.on_(xt.BEFORE_MOVE,t=>{s.zoomLayer.move(s.getValidMove(t.moveX,t.moveY))}),s.on_(Kt.BEFORE_ZOOM,t=>{const{zoomLayer:e}=s,i=s.getValidScale(t.scale);i!==1&&(R.scaleOf(e,t,i),e.scale=e.__.scaleX*i)}))}function vu(s){Ao(s),s.config.move.scroll="limit",s.config.zoom.min=1}const Jr=H.get("LeaferTypeCreator"),So={list:{},register(s,t){Tn[s]?Jr.repeat(s):Tn[s]=t},run(s,t){const e=Tn[s];e?e(t):Jr.error("no",s)}},{list:Tn,register:Yi}=So;Yi("draw",()=>{});Yi("custom",()=>{});Yi("design",Ao);Yi("document",vu);const La=Qt.prototype;La.initType=function(s){So.run(s,this)};La.getValidMove=function(s,t){const{scroll:e,disabled:i}=this.app.config.move;if(e&&(Math.abs(s)>Math.abs(t)?t=0:s=0,e==="limit")){const{x:n,y:a,width:r,height:h}=new et(this.__world).addPoint(this.zoomLayer),o=n+r-this.width,l=a+h-this.height;n>=0&&o<=0?s=0:s>0?n+s>0&&(s=-n):s<0&&o+s<0&&(s=-o),a>=0&&l<=0?t=0:t>0?a+t>0&&(t=-a):t<0&&l+t<0&&(t=-l)}return{x:i?0:s,y:i?0:t}};La.getValidScale=function(s){const{scaleX:t}=this.zoomLayer.__,{min:e,max:i,disabled:n}=this.app.config.zoom,a=Math.abs(t*s);return a<e?s=e/t:a>i&&(s=i/t),n?1:s};class Cu{constructor(t){this.interaction=t}move(t){const{interaction:e}=this;if(!this.moveData){const{path:i}=e.selector.getByPoint(t,e.hitRadius);t.path=i,this.moveData=Object.assign(Object.assign({},t),{moveX:0,moveY:0}),e.cancelHover(),e.emit(xt.START,this.moveData)}t.path=this.moveData.path,e.emit(xt.BEFORE_MOVE,t),e.emit(xt.MOVE,t),this.transformEndWait()}zoom(t){const{interaction:e}=this;if(!this.zoomData){const{path:i}=e.selector.getByPoint(t,e.hitRadius);t.path=i,this.zoomData=Object.assign(Object.assign({},t),{scale:1}),e.cancelHover(),e.emit(Kt.START,this.zoomData)}t.path=this.zoomData.path,e.emit(Kt.BEFORE_ZOOM,t),e.emit(Kt.ZOOM,t),this.transformEndWait()}rotate(t){const{interaction:e}=this;if(!this.rotateData){const{path:i}=e.selector.getByPoint(t,e.hitRadius);t.path=i,this.rotateData=Object.assign(Object.assign({},t),{rotation:0}),e.cancelHover(),e.emit(re.START,this.rotateData)}t.path=this.rotateData.path,e.emit(re.BEFORE_ROTATE,t),e.emit(re.ROTATE,t),this.transformEndWait()}transformEndWait(){clearTimeout(this.transformTimer),this.transformTimer=setTimeout(()=>{this.transformEnd()},this.interaction.config.pointer.transformTime)}transformEnd(){this.moveEnd(),this.zoomEnd(),this.rotateEnd()}moveEnd(){this.moveData&&(this.interaction.emit(xt.END,this.moveData),this.moveData=null)}zoomEnd(){this.zoomData&&(this.interaction.emit(Kt.END,this.zoomData),this.zoomData=null)}rotateEnd(){this.rotateData&&(this.interaction.emit(re.END,this.rotateData),this.rotateData=null)}destroy(){this.zoomData=this.moveData=this.rotateData=null}}const Zt={getMoveEventData(s,t,e){return Object.assign(Object.assign({},e),{x:s.x,y:s.y,moveX:t.x,moveY:t.y})},getRotateEventData(s,t,e){return Object.assign(Object.assign({},e),{x:s.x,y:s.y,rotation:t})},getZoomEventData(s,t,e){return Object.assign(Object.assign({},e),{x:s.x,y:s.y,scale:t})},getDragEventData(s,t,e){return Object.assign(Object.assign({},e),{x:e.x,y:e.y,moveX:e.x-t.x,moveY:e.y-t.y,totalX:e.x-s.x,totalY:e.y-s.y})},getDropEventData(s,t,e){return Object.assign(Object.assign({},s),{list:t,data:e})},getSwipeDirection(s){return s<-45&&s>-135?qt.UP:s>45&&s<135?qt.DOWN:s<=45&&s>=-45?qt.RIGHT:qt.LEFT},getSwipeEventData(s,t,e){return Object.assign(Object.assign({},e),{moveX:t.moveX,moveY:t.moveY,totalX:e.x-s.x,totalY:e.y-s.y,type:Bu.getSwipeDirection(R.getAngle(s,e))})},getBase(s){const t=s.button===1?4:s.button;return{altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey,buttons:s.buttons===void 0?1:s.buttons===0?t:s.buttons,origin:s}},pathHasEventType(s,t){const{list:e}=s;for(let i=0,n=e.length;i<n;i++)if(e[i].hasEvent(t))return!0;return!1},filterPathByEventType(s,t){const e=new lt,{list:i}=s;for(let n=0,a=i.length;n<a;n++)i[n].hasEvent(t)&&e.add(i[n]);return e}},Bu=Zt,th=new lt,{getDragEventData:On,getDropEventData:Ru,getSwipeEventData:Au}=Zt;class Su{constructor(t){this.interaction=t}setDragData(t){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=On(t,t,t),this.canAnimate=this.canDragOut=!0}getList(){const{proxy:t}=this.interaction.selector;return this.dragging&&(!t||!t.list.length)&&(z.list||this.dragableList)||th}checkDrag(t,e){const{interaction:i}=this;if(this.moving&&t.buttons<1){this.canAnimate=!1,i.pointerCancel();return}!this.moving&&e&&(this.moving=i.canMove(this.downData)||i.isHoldRightKey||i.isMobileDragEmpty)&&i.emit(xt.START,this.dragData),this.moving||this.dragStart(t,e),this.drag(t)}dragStart(t,e){this.dragging||(this.dragging=e&&Yt.left(t),this.dragging&&(this.interaction.emit(z.START,this.dragData),this.getDragableList(this.dragData.path),this.setDragStartPoints(this.realDragableList=this.getList())))}setDragStartPoints(t){this.dragStartPoints={},t.forEach(e=>this.dragStartPoints[e.innerId]={x:e.x,y:e.y})}getDragableList(t){let e;for(let i=0,n=t.length;i<n;i++)if(e=t.list[i],(e.__.draggable||e.__.editable)&&e.__.hitSelf&&!e.__.locked){this.dragableList=new lt(e);break}}drag(t){const{interaction:e,dragData:i,downData:n}=this,{path:a,throughPath:r}=n;this.dragData=On(n,i,t),r&&(this.dragData.throughPath=r),this.dragData.path=a,this.moving?(e.emit(xt.BEFORE_MOVE,this.dragData),e.emit(xt.MOVE,this.dragData)):this.dragging&&(this.dragReal(),e.emit(z.BEFORE_DRAG,this.dragData),e.emit(z.DRAG,this.dragData))}dragReal(){const{running:t}=this.interaction,e=this.realDragableList;if(e.length&&t){const{totalX:i,totalY:n}=this.dragData;e.forEach(a=>a.draggable&&a.move(z.getValidMove(a,this.dragStartPoints[a.innerId],{x:i,y:n})))}}dragOverOrOut(t){const{interaction:e}=this,{dragOverPath:i}=this,{path:n}=t;this.dragOverPath=n,i?n.indexAt(0)!==i.indexAt(0)&&(e.emit(z.OUT,t,i),e.emit(z.OVER,t,n)):e.emit(z.OVER,t,n)}dragEnterOrLeave(t){const{interaction:e}=this,{dragEnterPath:i}=this,{path:n}=t;e.emit(z.LEAVE,t,i,n),e.emit(z.ENTER,t,n,i),this.dragEnterPath=n}dragEnd(t,e){if(!this.dragging&&!this.moving)return;const{moveX:i,moveY:n}=this.dragData;this.interaction.config.move.dragAnimate&&this.canAnimate&&this.moving&&(Math.abs(i)>1||Math.abs(n)>1)?(t=Object.assign({},t),e=(e||(t.pointerType==="touch"?2:1))*.9,R.move(t,i*e,n*e),this.drag(t),this.animate(()=>{this.dragEnd(t,1)})):this.dragEndReal(t)}dragEndReal(t){const{interaction:e,downData:i,dragData:n}=this;t||(t=n);const{path:a,throughPath:r}=i,h=On(i,t,t);if(r&&(h.throughPath=r),h.path=a,this.moving&&(this.moving=!1,e.emit(xt.END,h)),this.dragging){const o=this.getList();this.dragging=!1,e.emit(z.END,h),this.swipe(t,i,n,h),this.drop(t,o,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,"off")}animate(t,e){const i=t||this.animateWait;i&&this.interaction.target.nextRender(i,null,e),this.animateWait=t}swipe(t,e,i,n){const{interaction:a}=this;if(R.getDistance(e,t)>a.config.pointer.swipeDistance){const r=Au(e,i,n);this.interaction.emit(r.type,r)}}drop(t,e,i){const n=Ru(t,e,z.data);n.path=i,this.interaction.emit(Ys.DROP,n),this.interaction.emit(z.LEAVE,t,i)}dragReset(){z.list=z.data=this.dragableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null}checkDragOut(t){const{interaction:e}=this;this.autoMoveCancel(),this.dragging&&!e.shrinkCanvasBounds.hitPoint(t)&&this.autoMoveOnDragOut(t)}autoMoveOnDragOut(t){const{interaction:e,downData:i,canDragOut:n}=this,{autoDistance:a,dragOut:r}=e.config.move;if(!r||!n||!a)return;const h=e.shrinkCanvasBounds,{x:o,y:l}=h,d=C.maxX(h),_=C.maxY(h),u=t.x<o?a:d<t.x?-a:0,p=t.y<l?a:_<t.y?-a:0;let f=0,g=0;this.autoMoveTimer=setInterval(()=>{f+=u,g+=p,R.move(i,u,p),R.move(this.dragData,u,p),e.move(Object.assign(Object.assign({},t),{moveX:u,moveY:p,totalX:f,totalY:g})),e.pointerMoveReal(t)},10)}autoMoveCancel(){this.autoMoveTimer&&(clearInterval(this.autoMoveTimer),this.autoMoveTimer=0)}destroy(){this.dragReset()}}const Du=H.get("emit");function Pu(s,t,e,i){if(!e&&!t.path)return;let n;t.type=s,e?t=Object.assign(Object.assign({},t),{path:e}):e=t.path,t.target=e.indexAt(0);try{for(let a=e.length-1;a>-1;a--){if(n=e.list[a],pa(n,s,t,!0,i))return;n.isApp&&eh(n,s,t,!0,i)}for(let a=0,r=e.length;a<r;a++)if(n=e.list[a],n.isApp&&eh(n,s,t,!1,i),pa(n,s,t,!1,i))return}catch(a){Du.error(a)}}const Tu=["move","zoom","rotate","key"];function eh(s,t,e,i,n){if(Tu.some(a=>t.startsWith(a))&&s.__.hitChildren&&!Do(s,n)){let a;for(let r=0,h=s.children.length;r<h;r++)a=s.children[r],!e.path.has(a)&&a.__.hittable&&pa(a,t,e,i,n)}}function pa(s,t,e,i,n){if(s.destroyed)return!1;if(s.__.hitSelf&&!Do(s,n)&&(Et.updateEventStyle&&Et.updateEventStyle(s,t),s.hasEvent(t,i))){e.phase=i?1:s===e.target?2:3;const a=ks.get(t,e);if(s.emitEvent(a,i),a.isStop)return!0}return!1}function Do(s,t){return t&&t.has(s)}const Ou={getData(s){const t=s[0],e=s[1],i=R.getCenter(t.from,e.from),n=R.getCenter(t.to,e.to),a={x:n.x-i.x,y:n.y-i.y},r=R.getDistance(t.from,e.from),o=R.getDistance(t.to,e.to)/r,l=R.getRotation(t.from,e.from,t.to,e.to);return{move:a,scale:o,angle:l,center:n}}},Mu={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:80/4,y:8},preventDefault:!0},pointer:{hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20,preventDefaultMenu:!0},cursor:!0,keyEvent:!0},{pathHasEventType:Mn,getMoveEventData:Lu,getZoomEventData:Iu,getRotateEventData:Wu}=Zt;class $u{get dragging(){return this.dragger.dragging}get moveMode(){return this.config.move.drag||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get isDragEmpty(){return this.config.move.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.config.move.dragEmpty&&!this.config.pointer.hover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.config.move.holdMiddleKey&&this.downData&&Yt.middle(this.downData)}get isHoldRightKey(){return this.config.move.holdRightKey&&this.downData&&Yt.right(this.downData)}get isHoldSpaceKey(){return this.config.move.holdSpaceKey&&Ws.isHoldSpaceKey()}get hitRadius(){return this.config.pointer.hitRadius}constructor(t,e,i,n){this.config=Mu,this.tapCount=0,this.downKeyMap={},this.target=t,this.canvas=e,this.selector=i,this.defaultPath=new lt(t),this.transformer=new Cu(this),this.dragger=new Su(this),n&&(this.config=_t.default(n,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(t){}pointerDown(t,e){t||(t=this.hoverData),t&&(Yt.defaultLeft(t),this.updateDownData(t),this.checkPath(t,e),this.downTime=Date.now(),this.emit(B.BEFORE_DOWN,t),this.emit(B.DOWN,t),Yt.left(t)&&(this.tapWait(),this.longPressWait(t)),this.waitMenuTap=Yt.right(t),this.dragger.setDragData(t),this.isHoldRightKey||this.updateCursor(t))}pointerMove(t){if(t||(t=this.hoverData),!t)return;const{downData:e}=this;e&&Yt.defaultLeft(t),(this.canvas.bounds.hitPoint(t)||e)&&(this.pointerMoveReal(t),e&&this.dragger.checkDragOut(t))}pointerMoveReal(t){const{dragHover:e,dragDistance:i}=this.config.pointer;if(this.emit(B.BEFORE_MOVE,t,this.defaultPath),this.downData){const n=R.getDistance(this.downData,t)>i;n&&(this.waitTap&&this.pointerWaitCancel(),this.waitMenuTap=!1),this.dragger.checkDrag(t,n)}this.dragger.moving||(this.updateHoverData(t),this.checkPath(t),this.emit(B.MOVE,t),this.dragging&&!e||this.pointerHover(t),this.dragger.dragging&&(this.dragger.dragOverOrOut(t),this.dragger.dragEnterOrLeave(t))),this.updateCursor(this.downData||t)}pointerUp(t){const{downData:e}=this;if(t||(t=e),!e)return;Yt.defaultLeft(t),this.findPath(t);const i=Object.assign(Object.assign({},t),{path:t.path.clone()});t.path.addList(e.path.list),this.checkPath(t),this.downData=null,this.emit(B.BEFORE_UP,t),this.emit(B.UP,t),this.touchLeave(t),t.isCancel||(this.tap(t),this.menuTap(t)),this.dragger.dragEnd(t),this.updateCursor(i)}pointerCancel(){const t=Object.assign({},this.dragger.dragData);t.isCancel=!0,this.pointerUp(t)}multiTouch(t,e){const{move:i,angle:n,scale:a,center:r}=Ou.getData(e);this.rotate(Wu(r,n,t)),this.zoom(Iu(r,a,t)),this.move(Lu(r,i,t))}menu(t){this.findPath(t),this.emit(B.MENU,t)}menuTap(t){this.waitMenuTap&&this.emit(B.MENU_TAP,t)}move(t){this.transformer.move(t)}zoom(t){this.transformer.zoom(t)}rotate(t){this.transformer.rotate(t)}transformEnd(){this.transformer.transformEnd()}keyDown(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]||(this.downKeyMap[e]=!0,Ws.setDownCode(e),this.emit(Te.HOLD,t,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(Te.DOWN,t,this.defaultPath)}keyUp(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]=!1,Ws.setUpCode(e),this.emit(Te.UP,t,this.defaultPath),this.cursor==="grab"&&this.updateCursor()}pointerHover(t){this.config.pointer.hover&&(this.pointerOverOrOut(t),this.pointerEnterOrLeave(t))}pointerOverOrOut(t){const{path:e}=t,{overPath:i}=this;this.overPath=e,i?e.indexAt(0)!==i.indexAt(0)&&(this.emit(B.OUT,t,i),this.emit(B.OVER,t,e)):this.emit(B.OVER,t,e)}pointerEnterOrLeave(t){let{path:e}=t;this.downData&&!this.moveMode&&(e=e.clone(),this.downData.path.forEach(n=>e.add(n)));const{enterPath:i}=this;this.enterPath=e,this.emit(B.LEAVE,t,i,e),this.emit(B.ENTER,t,e,i)}touchLeave(t){t.pointerType==="touch"&&this.enterPath&&(this.emit(B.LEAVE,t),this.dragger.dragging&&this.emit(Ys.LEAVE,t))}tap(t){const{pointer:e}=this.config,i=this.longTap(t);if(!e.tapMore&&i||!this.waitTap)return;e.tapMore&&this.emitTap(t);const n=Date.now()-this.downTime,a=[B.DOUBLE_TAP,B.DOUBLE_CLICK].some(r=>Mn(t.path,r));n<e.tapTime+50&&a?(this.tapCount++,this.tapCount===2?(this.tapWaitCancel(),this.emitDoubleTap(t)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout(()=>{e.tapMore||(this.tapWaitCancel(),this.emitTap(t))},e.tapTime))):e.tapMore||(this.tapWaitCancel(),this.emitTap(t))}findPath(t,e){const{hitRadius:i,through:n}=this.config.pointer,{bottomList:a}=this,r=this.selector.getByPoint(t,i,Object.assign({bottomList:a,name:t.type},e||{through:n}));return r.throughPath&&(t.throughPath=r.throughPath),t.path=r.path,r.path}isRootPath(t){return t&&t.path.list[0].isLeafer}isTreePath(t){const e=this.target.app;return!e||!e.isApp?!1:e.editor&&!t.path.has(e.editor)&&t.path.has(e.tree)&&!t.target.syncEventer}checkPath(t,e){(e||this.canMove(t))&&(t.path=this.defaultPath)}canMove(t){return this.moveMode&&t&&t.path.list.every(e=>!e.isOutside)}isDrag(t){return this.dragger.getList().has(t)}isPress(t){return this.downData&&this.downData.path.has(t)}isHover(t){return this.enterPath&&this.enterPath.has(t)}isFocus(t){return this.focusData===t}cancelHover(){const{hoverData:t}=this;t&&(t.path=this.defaultPath,this.pointerHover(t))}updateDownData(t,e,i){const{downData:n}=this;!t&&n&&(t=n),t&&(this.findPath(t,e),i&&n&&t.path.addList(n.path.list),this.downData=t)}updateHoverData(t){t||(t=this.hoverData),t&&(this.findPath(t,{exclude:this.dragger.getList(),name:B.MOVE}),this.hoverData=t)}updateCursor(t){if(!this.config.cursor||!this.config.pointer.hover)return;if(t||(this.updateHoverData(),t=this.downData||this.hoverData),this.dragger.moving)return this.setCursor("grabbing");if(this.canMove(t))return this.setCursor(this.downData?"grabbing":"grab");if(!t)return;let e,i;const{path:n}=t;for(let a=0,r=n.length;a<r&&(e=n.list[a],i=e.syncEventer?e.syncEventer.cursor:e.cursor,!i);a++);this.setCursor(i)}setCursor(t){this.cursor=t}getLocal(t,e){const i=this.canvas.getClientBounds(e);return{x:t.clientX-i.x,y:t.clientY-i.y}}emitTap(t){this.emit(B.TAP,t),this.emit(B.CLICK,t)}emitDoubleTap(t){this.emit(B.DOUBLE_TAP,t),this.emit(B.DOUBLE_CLICK,t)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0}longPressWait(t){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.longPressed=!0,this.emit(B.LONG_PRESS,t)},this.config.pointer.longPressTime)}longTap(t){let e;return this.longPressed&&(this.emit(B.LONG_TAP,t),(Mn(t.path,B.LONG_TAP)||Mn(t.path,B.LONG_PRESS))&&(e=!0)),this.longPressWaitCancel(),e}longPressWaitCancel(){clearTimeout(this.longPressTimer),this.longPressed=!1}__onResize(){this.shrinkCanvasBounds=new et(this.canvas.bounds),this.shrinkCanvasBounds.spread(-2)}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(es.RESIZE,this.__onResize,this)],t.once(at.READY,()=>this.__onResize())}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(t,e,i,n){this.running&&Pu(t,e,i,n)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}}class Po{static set(t,e){this.custom[t]=e}static get(t){return this.custom[t]}}Po.custom={};class zu extends ao{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new lt,this.pixelList=new lt}getPixelType(t,e){return this.__autoClear(),this.pixelList.add(t),pt.hitCanvas(e)}getPathType(t){return this.__autoClear(),this.pathList.add(t),pt.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(t){t.length&&(t.forEach(e=>{e.__hitCanvas&&(e.__hitCanvas.destroy(),e.__hitCanvas=null)}),t.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}}const{toInnerRadiusPointOf:Nu,copy:Hu,setRadius:Gu}=R,Ds={},ei=Ke.prototype;ei.__hitWorld=function(s){if(!this.__.hitSelf)return!1;this.__.hitRadius&&(Hu(Ds,s),s=Ds,Gu(s,this.__.hitRadius)),Nu(s,this.__world,Ds);const{width:t,height:e}=this.__world,i=t<10&&e<10;if(this.__.hitBox||i){if(C.hitRadiusPoint(this.__layout.boxBounds,Ds))return!0;if(i)return!1}return(this.__layout.hitCanvasChanged||!this.__hitCanvas)&&(this.__updateHitCanvas(),this.__layout.boundsChanged||(this.__layout.hitCanvasChanged=!1)),this.__hit(Ds)};ei.__hitFill=function(s){var t;return(t=this.__hitCanvas)===null||t===void 0?void 0:t.hitFill(s,this.__.windingRule)};ei.__hitStroke=function(s,t){var e;return(e=this.__hitCanvas)===null||e===void 0?void 0:e.hitStroke(s,t)};ei.__hitPixel=function(s){var t;return(t=this.__hitCanvas)===null||t===void 0?void 0:t.hitPixel(s,this.__layout.renderBounds,this.__hitCanvas.hitScale)};ei.__drawHitPath=function(s){s&&this.__drawRenderPath(s)};const ju=new Oe,To=y.prototype;To.__updateHitCanvas=function(){const s=this.__,{hitCanvasManager:t}=this.leafer,e=(s.__pixelFill||s.__isCanvas)&&s.hitFill==="pixel",i=s.__pixelStroke&&s.hitStroke==="pixel",n=e||i;this.__hitCanvas||(this.__hitCanvas=n?t.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):t.getPathType(this));const a=this.__hitCanvas;if(n){const{renderBounds:r}=this.__layout,h=b.image.hitCanvasSize,o=a.hitScale=$.set(0,0,h,h).getFitMatrix(r,.5).a,{x:l,y:d,width:_,height:u}=$.set(r).scale(o);a.resize({width:_,height:u,pixelRatio:1}),a.clear(),Ct.patternLocked=!0,this.__renderShape(a,{matrix:ju.setWith(this.__world).scaleWith(1/o).invertWith().translate(-l,-d)},!e,!i),Ct.patternLocked=!1,a.resetTransform(),s.__isHitPixel=!0}else s.__isHitPixel&&(s.__isHitPixel=!1);this.__drawHitPath(a),a.setStrokeOptions(s)};To.__hit=function(s){b.name==="miniapp"&&this.__drawHitPath(this.__hitCanvas);const t=this.__;if(t.__isHitPixel&&this.__hitPixel(s))return!0;const{hitFill:e}=t,i=(t.fill||t.__isCanvas)&&(e==="path"||e==="pixel"&&!(t.__pixelFill||t.__isCanvas))||e==="all";if(i&&this.__hitFill(s))return!0;const{hitStroke:n,__strokeWidth:a}=t,r=t.stroke&&(n==="path"||n==="pixel"&&!t.__pixelStroke)||n==="all";if(!i&&!r)return!1;const h=s.radiusX*2;let o=h;if(r)switch(t.strokeAlign){case"inside":if(o+=a*2,!i&&this.__hitFill(s)&&this.__hitStroke(s,o))return!0;o=h;break;case"center":o+=a;break;case"outside":if(o+=a*2,!i){if(!this.__hitFill(s)&&this.__hitStroke(s,o))return!0;o=h}break}return o?this.__hitStroke(s,o):!1};const Oo=new y,Mo=Qe.prototype;Mo.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&this.hitFill==="pixel"||this.hitStroke==="all"?Oo.__updateHitCanvas.call(this):this.__hitCanvas&&(this.__hitCanvas=null)};Mo.__hitFill=function(s){return this.__hitCanvas?Oo.__hitFill.call(this,s):C.hitRadiusPoint(this.__layout.boxBounds,s)};const Lo=y.prototype,Uu=he.prototype;Lo.find=function(s,t){return this.leafer?this.leafer.selector.getBy(s,this,!1,t):[]};Lo.findOne=function(s,t){return this.leafer?this.leafer.selector.getBy(s,this,!0,t):null};Uu.pick=function(s,t){return this.__layout.update(),t||(t={}),this.leafer?this.leafer.selector.getByPoint(s,t.hitRadius||0,Object.assign(Object.assign({},t),{target:this})):null};const Ia=Sa.prototype;Ia.hitFill=function(s,t){return t?this.context.isPointInPath(s.x,s.y,t):this.context.isPointInPath(s.x,s.y)};Ia.hitStroke=function(s,t){return this.strokeWidth=t,this.context.isPointInStroke(s.x,s.y)};Ia.hitPixel=function(s,t,e=1){let{x:i,y:n,radiusX:a,radiusY:r}=s;t&&(i-=t.x,n-=t.y),$.set(i-a,n-r,a*2,r*2).scale(e).ceil();const{data:h}=this.context.getImageData($.x,$.y,$.width||1,$.height||1);for(let o=0,l=h.length;o<l;o+=4)if(h[o+3]>0)return!0;return h[3]>0};const sh=H.get("LeaferCanvas");class Io extends Sa{set zIndex(t){const{style:e}=this.view;e.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){const{view:e,parentView:i}=this;if(e&&i){const n=i.children[t];n?(this.setAbsolute(n),i.insertBefore(e,n)):i.appendChild(n)}}init(){const{view:t}=this.config;t?this.__createViewFrom(t):this.__createView();const{style:e}=this.view;if(e.display||(e.display="block"),this.parentView=this.view.parentElement,this.parentView){const i=this.parentView.style;i.webkitUserSelect=i.userSelect="none"}b.syncDomFont&&!this.parentView&&(e.display="none",document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(this.config)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return this.view.style.pointerEvents!=="none"}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let e=typeof t=="string"?document.getElementById(t):t;if(e)if(e instanceof HTMLCanvasElement)this.view=e;else{let i=e;if(e===window||e===document){const a=document.createElement("div"),{style:r}=a;r.position="absolute",r.top=r.bottom=r.left=r.right="0px",document.body.appendChild(a),i=a}this.__createView();const n=this.view;i.hasChildNodes()&&(this.setAbsolute(n),i.style.position||(i.style.position="relative")),i.appendChild(n)}else sh.error(`no id: ${t}`),this.__createView()}setAbsolute(t){const{style:e}=t;e.position="absolute",e.top=e.left="0px"}updateViewSize(){const{width:t,height:e,pixelRatio:i}=this,{style:n}=this.view;n.width=t+"px",n.height=e+"px",this.view.width=Math.ceil(t*i),this.view.height=Math.ceil(e*i)}updateClientBounds(){this.clientBounds=this.view.getBoundingClientRect()}startAutoLayout(t,e){this.autoBounds=t,this.resizeListener=e;try{this.resizeObserver=new ResizeObserver(n=>{this.updateClientBounds();for(const a of n)this.checkAutoBounds(a.contentRect)});const i=this.parentView;i?(this.resizeObserver.observe(i),this.checkAutoBounds(i.getBoundingClientRect())):(this.checkAutoBounds(this.view),sh.warn("no parent"))}catch{this.imitateResizeObserver()}}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),b.requestRender(this.imitateResizeObserver.bind(this)))}checkAutoBounds(t){const e=this.view,{x:i,y:n,width:a,height:r}=this.autoBounds.getBoundsFrom(t);if(a!==this.width||r!==this.height){const{style:h}=e,{pixelRatio:o}=this;h.marginLeft=i+"px",h.marginTop=n+"px";const l={width:a,height:r,pixelRatio:o},d={};_t.copyAttrs(d,this,Ee),this.resize(l),this.width!==void 0&&this.resizeListener(new es(l,d))}}stopAutoLayout(){this.autoLayout=!1,this.resizeListener=null,this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}unrealCanvas(){if(!this.unreal&&this.parentView){const t=this.view;t&&t.remove(),this.view=this.parentView,this.unreal=!0}}destroy(){if(this.view){if(this.stopAutoLayout(),!this.unreal){const t=this.view;t.parentElement&&t.remove()}super.destroy()}}}go(CanvasRenderingContext2D.prototype);go(Path2D.prototype);const{mineType:Ln,fileType:Yu}=we;Object.assign(pt,{canvas:(s,t)=>new Io(s,t),image:s=>new mp(s)});function Vu(s,t){b.origin={createCanvas(e,i){const n=document.createElement("canvas");return n.width=e,n.height=i,n},canvasToDataURL:(e,i,n)=>e.toDataURL(Ln(i),n),canvasToBolb:(e,i,n)=>new Promise(a=>e.toBlob(a,Ln(i),n)),canvasSaveAs:(e,i,n)=>{const a=e.toDataURL(Ln(Yu(i)),n);return b.origin.download(a,i)},download(e,i){return new Promise(n=>{let a=document.createElement("a");a.href=e,a.download=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),n()})},loadImage(e){return new Promise((i,n)=>{const a=new Image,{crossOrigin:r}=b.image;r&&(a.setAttribute("crossOrigin",r),a.crossOrigin=r),a.onload=()=>{i(a)},a.onerror=h=>{n(h)},a.src=b.image.getRealURL(e)})}},b.event={stopDefault(e){e.preventDefault()},stopNow(e){e.stopImmediatePropagation()},stop(e){e.stopPropagation()}},b.canvas=pt.canvas(),b.conicGradientSupport=!!b.canvas.context.createConicGradient}b.name="web";b.isMobile="ontouchstart"in window;b.requestRender=function(s){window.requestAnimationFrame(s)};b.devicePixelRatio=Math.max(1,devicePixelRatio);const{userAgent:fs}=navigator;fs.indexOf("Firefox")>-1?(b.conicGradientRotate90=!0,b.intWheelDeltaY=!0,b.syncDomFont=!0):fs.indexOf("Safari")>-1&&fs.indexOf("Chrome")===-1&&(b.fullImageShadow=!0);fs.indexOf("Windows")>-1?(b.os="Windows",b.intWheelDeltaY=!0):fs.indexOf("Mac")>-1?b.os="Mac":fs.indexOf("Linux")>-1&&(b.os="Linux");class Xu{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove){const t=new lt;return this.__updatedList.list.forEach(e=>{e.leafer&&t.add(e)}),t}else return this.__updatedList}constructor(t,e){this.totalTimes=0,this.config={},this.__updatedList=new lt,this.target=t,e&&(this.config=_t.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(X.REQUEST)}__onAttrChange(t){this.__updatedList.add(t.target),this.update()}__onChildEvent(t){t.type===Dt.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent)),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){const{children:e}=t;for(let i=0,n=e.length;i<n;i++)this.__pushChild(e[i])}__onRquestData(){this.target.emitEvent(new Pe(Pe.DATA,{updatedList:this.updatedList})),this.__updatedList=new lt,this.totalTimes++,this.changed=!1,this.hasVisible=!1,this.hasRemove=!1,this.hasAdd=!1}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(me.CHANGE,this.__onAttrChange,this),t.on_([Dt.ADD,Dt.REMOVE],this.__onChildEvent,this),t.on_(Pe.REQUEST,this.__onRquestData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=null,this.__updatedList=null)}}const{updateAllMatrix:qu,updateBounds:ih,updateAllWorldOpacity:Ku}=de,{pushAllChildBranch:Zu,pushAllParent:nh}=Qs;function Qu(s,t){let e;s.list.forEach(i=>{e=i.__layout,t.without(i)&&!e.proxyZoom&&(e.matrixChanged?(qu(i,!0),t.add(i),i.isBranch&&Zu(i,t),nh(i,t)):e.boundsChanged&&(t.add(i),i.isBranch&&(i.__tempNumber=0),nh(i,t)))})}function Ju(s){let t,e,i;s.sort(!0),s.levels.forEach(n=>{t=s.levelMap[n];for(let a=0,r=t.length;a<r;a++){if(e=t[a],e.isBranch&&e.__tempNumber){i=e.children;for(let h=0,o=i.length;h<o;h++)i[h].isBranch||ih(i[h])}ih(e)}})}function tf(s){s.list.forEach(t=>{t.__layout.opacityChanged&&Ku(t),t.__updateChange()})}const{worldBounds:ah}=Gi,ef={x:0,y:0,width:1e5,height:1e5};class rh{constructor(t){this.updatedBounds=new et,this.beforeBounds=new et,this.afterBounds=new et,t instanceof Array&&(t=new lt(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,ah)}setAfter(){const{list:t}=this.updatedList;t.some(e=>e.noBounds)?this.afterBounds.set(ef):this.afterBounds.setListWithFn(t,ah),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}}const{updateAllMatrix:sf,updateAllChange:nf}=de,In=H.get("Layouter");class Vi{constructor(t,e){this.totalTimes=0,this.config={},this.__levelList=new Oc,this.target=t,e&&(this.config=_t.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(!this.running)return;const{target:t}=this;this.times=0;try{t.emit(G.START),this.layoutOnce(),t.emitEvent(new G(G.END,this.layoutedBlocks,this.times))}catch(e){In.error(e)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){if(this.layouting)return In.warn("layouting");if(this.times>3)return In.warn("layout max times");this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(Pe.REQUEST),this.totalTimes>1?this.partLayout():this.fullLayout(),this.layouting=!1,this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())}partLayout(){var t;if(!(!((t=this.__updatedList)===null||t===void 0)&&t.length))return;const e=Xt.start("PartLayout"),{target:i,__updatedList:n}=this,{BEFORE:a,LAYOUT:r,AFTER:h}=G,o=this.getBlocks(n);o.forEach(l=>l.setBefore()),i.emitEvent(new G(a,o,this.times)),this.extraBlock=null,n.sort(),Qu(n,this.__levelList),Ju(this.__levelList),tf(n),this.extraBlock&&o.push(this.extraBlock),o.forEach(l=>l.setAfter()),i.emitEvent(new G(r,o,this.times)),i.emitEvent(new G(h,o,this.times)),this.addBlocks(o),this.__levelList.reset(),this.__updatedList=null,Xt.end(e)}fullLayout(){const t=Xt.start("FullLayout"),{target:e}=this,{BEFORE:i,LAYOUT:n,AFTER:a}=G,r=this.getBlocks(new lt(e));e.emitEvent(new G(i,r,this.times)),Vi.fullLayout(e),r.forEach(h=>{h.setAfter()}),e.emitEvent(new G(n,r,this.times)),e.emitEvent(new G(a,r,this.times)),this.addBlocks(r),Xt.end(t)}static fullLayout(t){sf(t,!0),t.isBranch?Qs.updateBounds(t):de.updateBounds(t),nf(t)}addExtra(t){if(!this.__updatedList.has(t)){const{updatedList:e,beforeBounds:i}=this.extraBlock||(this.extraBlock=new rh([]));e.length?i.add(t.__world):i.set(t.__world),e.add(t)}}createBlock(t){return new rh(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(G.REQUEST,this.layout,this),t.on_(G.AGAIN,this.layoutAgain,this),t.on_(Pe.DATA,this.__onReceiveWatchData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}}const He=H.get("Renderer");class af{get needFill(){return!!(!this.canvas.allowBackgroundColor&&this.config.fill)}constructor(t,e,i){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:60},this.target=t,this.canvas=e,i&&(this.config=_t.default(i,this.config)),this.__listenEvents(),this.__requestRender()}start(){this.running=!0}stop(){this.running=!1}update(){this.changed=!0}requestLayout(){this.target.emit(G.REQUEST)}render(t){if(!(this.running&&this.canvas.view)){this.changed=!0;return}const{target:e}=this;this.times=0,this.totalBounds=new et,He.log(e.innerName,"--->");try{this.emitRender(X.START),this.renderOnce(t),this.emitRender(X.END,this.totalBounds),Ct.clearRecycled()}catch(i){this.rendering=!1,He.error(i)}He.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(t){if(this.rendering)return He.warn("rendering");if(this.times>3)return He.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new et,this.renderOptions={},t)this.emitRender(X.BEFORE),t();else{if(this.requestLayout(),this.ignore){this.ignore=this.rendering=!1;return}this.emitRender(X.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(X.RENDER,this.renderBounds,this.renderOptions),this.emitRender(X.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){const{canvas:t,updateBlocks:e}=this;if(!e)return He.warn("PartRender: need update attr");this.mergeBlocks(),e.forEach(i=>{t.bounds.hit(i)&&!i.isEmpty()&&this.clipRender(i)})}clipRender(t){const e=Xt.start("PartRender"),{canvas:i}=this,n=t.getIntersect(i.bounds),a=t.includes(this.target.__world),r=new et(n);i.save(),a&&!H.showRepaint?i.clear():(n.spread(10+1/this.canvas.pixelRatio).ceil(),i.clearWorld(n,!0),i.clipWorld(n,!0)),this.__render(n,a,r),i.restore(),Xt.end(e)}fullRender(){const t=Xt.start("FullRender"),{canvas:e}=this;e.save(),e.clear(),this.__render(e.bounds,!0),e.restore(),Xt.end(t)}__render(t,e,i){const n=t.includes(this.target.__world)?{includes:e}:{bounds:t,includes:e};this.needFill&&this.canvas.fillWorld(t,this.config.fill),H.showRepaint&&this.canvas.strokeWorld(t,"red"),this.target.__render(this.canvas,n),this.renderBounds=i||t,this.renderOptions=n,this.totalBounds.isEmpty()?this.totalBounds=this.renderBounds:this.totalBounds.add(this.renderBounds),H.showHitView&&this.renderHitView(n),H.showBoundsView&&this.renderBoundsView(n),this.canvas.updateRender()}renderHitView(t){}renderBoundsView(t){}addBlock(t){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(t)}mergeBlocks(){const{updateBlocks:t}=this;if(t){const e=new et;e.setList(t),t.length=0,t.push(e)}}__requestRender(){const t=Date.now();b.requestRender(()=>{this.FPS=Math.min(60,Math.ceil(1e3/(Date.now()-t))),this.running&&(this.target.emit(bo.FRAME),this.changed&&this.canvas.view&&this.render(),this.target.emit(X.NEXT)),this.target&&this.__requestRender()})}__onResize(t){if(!this.canvas.unreal){if(t.bigger||!t.samePixelRatio){const{width:e,height:i}=t.old;if(!new et(0,0,e,i).includes(this.target.__world)||this.needFill||!t.samePixelRatio){this.addBlock(this.canvas.bounds),this.target.forceUpdate("surface");return}}this.addBlock(new et(0,0,1,1)),this.changed=!0}}__onLayoutEnd(t){t.data&&t.data.map(e=>{let i;e.updatedList&&e.updatedList.list.some(n=>(i=!n.__world.width||!n.__world.height,i&&(n.isLeafer||He.tip(n.innerName,": empty"),i=!n.isBranch||n.isBranchLeaf),i)),this.addBlock(i?this.canvas.bounds:e.updatedBounds)})}emitRender(t,e,i){this.target.emitEvent(new X(t,this.times,e,i))}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(X.REQUEST,this.update,this),t.on_(G.END,this.__onLayoutEnd,this),t.on_(X.AGAIN,this.renderAgain,this),t.on_(es.RESIZE,this.__onResize,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.canvas=this.config=null)}}const{hitRadiusPoint:rf}=C;class hf{constructor(t,e){this.target=t,this.selector=e}getByPoint(t,e,i){e||(e=0),i||(i={});const n=i.through||!1,a=i.ignoreHittable||!1,r=i.target||this.target;this.exclude=i.exclude||null,this.point={x:t.x,y:t.y,radiusX:e,radiusY:e},this.findList=new lt(i.findList),i.findList||this.hitBranch(r);const{list:h}=this.findList,o=this.getBestMatchLeaf(h,i.bottomList,a),l=a?this.getPath(o):this.getHitablePath(o);return this.clear(),n?{path:l,target:o,throughPath:h.length?this.getThroughPath(h):l}:{path:l,target:o}}getBestMatchLeaf(t,e,i){if(t.length){let n;this.findList=new lt;const{x:a,y:r}=this.point,h={x:a,y:r,radiusX:0,radiusY:0};for(let o=0,l=t.length;o<l;o++)if(n=t[o],(i||de.worldHittable(n))&&(this.hitChild(n,h),this.findList.length))return this.findList.list[0]}if(e){for(let n=0,a=e.length;n<a;n++)if(this.hitChild(e[n].target,this.point,e[n].proxy),this.findList.length)return this.findList.list[0]}return t[0]}getPath(t){const e=new lt;for(;t;)e.add(t),t=t.parent;return e.add(this.target),e}getHitablePath(t){const e=this.getPath(t&&t.hittable?t:null);let i,n=new lt;for(let a=e.list.length-1;a>-1&&(i=e.list[a],!(!i.__.hittable||(n.addAt(i,0),!i.__.hitChildren)));a--);return n}getThroughPath(t){const e=new lt,i=[];for(let h=t.length-1;h>-1;h--)i.push(this.getPath(t[h]));let n,a,r;for(let h=0,o=i.length;h<o;h++){n=i[h],a=i[h+1];for(let l=0,d=n.length;l<d&&(r=n.list[l],!(a&&a.has(r)));l++)e.add(r)}return e}hitBranch(t){this.eachFind(t.children,t.__onlyHitMask)}eachFind(t,e){let i,n;const{point:a}=this,r=t.length;for(let h=r-1;h>-1;h--)i=t[h],!(!i.__.visible||e&&!i.__.mask)&&(n=i.__.hitRadius?!0:rf(i.__world,a),i.isBranch?(n||i.__ignoreHitWorld)&&(this.eachFind(i.children,i.__onlyHitMask),i.isBranchLeaf&&!this.findList.length&&this.hitChild(i,a)):n&&this.hitChild(i,a))}hitChild(t,e,i){if(!(this.exclude&&this.exclude.has(t))&&t.__hitWorld(e)){const{parent:n}=t;if(n&&n.__hasMask&&!t.__.mask&&!n.children.some(a=>a.__.mask&&a.__hitWorld(e)))return;this.findList.add(i||t)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}}const{Yes:of,NoAndSkip:lf,YesAndSkip:df}=aa,hh={},oh={},lh={};class pf{constructor(t,e){this.config={},this.innerIdMap={},this.idMap={},this.methods={id:(i,n)=>i.id===n?(this.idMap[n]=i,1):0,innerId:(i,n)=>i.innerId===n?(this.innerIdMap[n]=i,1):0,className:(i,n)=>i.className===n?1:0,tag:(i,n)=>i.__tag===n?1:0,tags:(i,n)=>n[i.__tag]?1:0},this.target=t,e&&(this.config=_t.default(e,this.config)),this.picker=new hf(t,this),this.__listenEvents()}getBy(t,e,i,n){switch(typeof t){case"number":const a=this.getByInnerId(t,e);return i?a:a?[a]:[];case"string":switch(t[0]){case"#":hh.id=t.substring(1),t=hh;break;case".":oh.className=t.substring(1),t=oh;break;default:lh.tag=t,t=lh}case"object":if(t.id!==void 0){const r=this.getById(t.id,e);return i?r:r?[r]:[]}else if(t.tag){const{tag:r}=t,h=r instanceof Array;return this.getByMethod(h?this.methods.tags:this.methods.tag,e,i,h?_t.toMap(r):r)}else return this.getByMethod(this.methods.className,e,i,t.className);case"function":return this.getByMethod(t,e,i,n)}}getByPoint(t,e,i){return b.name==="node"&&this.target.emit(G.CHECK_UPDATE),this.picker.getByPoint(t,e,i)}getByInnerId(t,e){const i=this.innerIdMap[t];return i||(this.eachFind(this.toChildren(e),this.methods.innerId,null,t),this.findLeaf)}getById(t,e){const i=this.idMap[t];return i&&de.hasParent(i,e||this.target)?i:(this.eachFind(this.toChildren(e),this.methods.id,null,t),this.findLeaf)}getByClassName(t,e){return this.getByMethod(this.methods.className,e,!1,t)}getByTag(t,e){return this.getByMethod(this.methods.tag,e,!1,t)}getByMethod(t,e,i,n){const a=i?null:[];return this.eachFind(this.toChildren(e),t,a,n),a||this.findLeaf}eachFind(t,e,i,n){let a,r;for(let h=0,o=t.length;h<o;h++){if(a=t[h],r=e(a,n),r===of||r===df)if(i)i.push(a);else{this.findLeaf=a;return}a.isBranch&&r<lf&&this.eachFind(a.children,e,i,n)}}toChildren(t){return this.findLeaf=null,[t||this.target]}__onRemoveChild(t){const{id:e,innerId:i}=t.child;this.idMap[e]&&delete this.idMap[e],this.innerIdMap[i]&&delete this.innerIdMap[i]}__checkIdChange(t){if(t.attrName==="id"){const e=t.oldValue;this.idMap[e]&&delete this.idMap[e]}}__listenEvents(){this.__eventIds=[this.target.on_(Dt.REMOVE,this.__onRemoveChild,this),this.target.on_(me.CHANGE,this.__checkIdChange,this)]}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}destroy(){this.__eventIds.length&&(this.__removeListenEvents(),this.picker.destroy(),this.findLeaf=null,this.innerIdMap={},this.idMap={})}}Object.assign(pt,{watcher:(s,t)=>new Xu(s,t),layouter:(s,t)=>new Vi(s,t),renderer:(s,t,e)=>new af(s,t,e),selector:(s,t)=>new pf(s,t)});b.layout=Vi.fullLayout;const vt={convert(s,t){const e=Zt.getBase(s),i=Object.assign(Object.assign({},e),{x:t.x,y:t.y,width:s.width,height:s.height,pointerType:s.pointerType,pressure:s.pressure});return i.pointerType==="pen"&&(i.tangentialPressure=s.tangentialPressure,i.tiltX=s.tiltX,i.tiltY=s.tiltY,i.twist=s.twist),i},convertMouse(s,t){const e=Zt.getBase(s);return Object.assign(Object.assign({},e),{x:t.x,y:t.y,width:1,height:1,pointerType:"mouse",pressure:.5})},convertTouch(s,t){const e=vt.getTouch(s),i=Zt.getBase(s);return Object.assign(Object.assign({},i),{x:t.x,y:t.y,width:1,height:1,pointerType:"touch",pressure:e.force})},getTouch(s){return s.targetTouches[0]||s.changedTouches[0]}},dh={getMove(s,t){let{moveSpeed:e}=t,{deltaX:i,deltaY:n}=s;return s.shiftKey&&!i&&(i=n,n=0),i>50&&(i=Math.max(50,i/3)),n>50&&(n=Math.max(50,n/3)),{x:-i*e*2,y:-n*e*2}},getScale(s,t){let e,i=1,{zoomMode:n,zoomSpeed:a}=t;const r=s.deltaY||s.deltaX;if(n?(e=n==="mouse"?!0:!s.deltaX&&(b.intWheelDeltaY?Math.abs(r)>17:Math.ceil(r)!==r),(s.shiftKey||s.metaKey||s.ctrlKey)&&(e=!0)):e=!s.shiftKey&&(s.metaKey||s.ctrlKey),e){a=Gt.within(a,0,1);const h=s.deltaY?t.delta.y:t.delta.x;i=1-r/(h*4)*a,i<.5&&(i=.5),i>=1.5&&(i=1.5)}return i}},ph={convert(s){const t=Zt.getBase(s);return Object.assign(Object.assign({},t),{code:s.code,key:s.key})}},{getMoveEventData:cf,getZoomEventData:ch,getRotateEventData:uf}=Zt;class ff extends $u{__listenEvents(){super.__listenEvents();const t=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};const{viewEvents:e,windowEvents:i}=this;for(let n in e)e[n]=e[n].bind(this),t.addEventListener(n,e[n]);for(let n in i)i[n]=i[n].bind(this),window.addEventListener(n,i[n])}__removeListenEvents(){super.__removeListenEvents();const{viewEvents:t,windowEvents:e}=this;for(let i in t)this.view.removeEventListener(i,t[i]),this.viewEvents={};for(let i in e)window.removeEventListener(i,e[i]),this.windowEvents={}}getTouches(t){const e=[];for(let i=0,n=t.length;i<n;i++)e.push(t[i]);return e}preventDefaultPointer(t){const{pointer:e}=this.config;e.preventDefault&&t.preventDefault()}preventDefaultWheel(t){const{wheel:e}=this.config;e.preventDefault&&t.preventDefault()}preventWindowPointer(t){return!this.downData&&t.target!==this.view}onKeyDown(t){this.keyDown(ph.convert(t))}onKeyUp(t){this.keyUp(ph.convert(t))}onContextMenu(t){this.config.pointer.preventDefaultMenu&&t.preventDefault(),this.menu(vt.convert(t,this.getLocal(t)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(t){this.preventDefaultPointer(t),this.usePointer||(this.usePointer=!0),!this.useMultiTouch&&this.pointerDown(vt.convert(t,this.getLocal(t)))}onPointerMove(t){this.usePointer||(this.usePointer=!0),!(this.useMultiTouch||this.preventWindowPointer(t))&&this.pointerMove(vt.convert(t,this.getLocal(t,!0)))}onPointerUp(t){this.downData&&this.preventDefaultPointer(t),!(this.useMultiTouch||this.preventWindowPointer(t))&&this.pointerUp(vt.convert(t,this.getLocal(t)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(t){this.preventDefaultPointer(t),!(this.useTouch||this.usePointer)&&this.pointerDown(vt.convertMouse(t,this.getLocal(t)))}onMouseMove(t){this.useTouch||this.usePointer||this.preventWindowPointer(t)||this.pointerMove(vt.convertMouse(t,this.getLocal(t,!0)))}onMouseUp(t){this.downData&&this.preventDefaultPointer(t),!(this.useTouch||this.usePointer||this.preventWindowPointer(t))&&this.pointerUp(vt.convertMouse(t,this.getLocal(t)))}onMouseCancel(){this.useTouch||this.usePointer||this.pointerCancel()}onTouchStart(t){if(t.preventDefault(),this.multiTouchStart(t),this.usePointer)return;this.touchTimer&&(window.clearTimeout(this.touchTimer),this.touchTimer=0),this.useTouch=!0;const e=vt.getTouch(t);this.pointerDown(vt.convertTouch(t,this.getLocal(e,!0)))}onTouchMove(t){if(this.multiTouchMove(t),this.usePointer||this.preventWindowPointer(t))return;const e=vt.getTouch(t);this.pointerMove(vt.convertTouch(t,this.getLocal(e)))}onTouchEnd(t){if(this.multiTouchEnd(),this.usePointer||this.preventWindowPointer(t))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(()=>{this.useTouch=!1},500);const e=vt.getTouch(t);this.pointerUp(vt.convertTouch(t,this.getLocal(e)))}onTouchCancel(){this.usePointer||this.pointerCancel()}multiTouchStart(t){this.useMultiTouch=t.touches.length>=2,this.touches=this.useMultiTouch?this.getTouches(t.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(t){if(this.useMultiTouch&&t.touches.length>1){const e=this.getTouches(t.touches),i=this.getKeepTouchList(this.touches,e);i.length>1&&(this.multiTouch(Zt.getBase(t),i),this.touches=e)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(t,e){let i;const n=[];return t.forEach(a=>{i=e.find(r=>r.identifier===a.identifier),i&&n.push({from:this.getLocal(a),to:this.getLocal(i)})}),n}getLocalTouchs(t){return t.map(e=>this.getLocal(e))}onWheel(t){this.preventDefaultWheel(t);const{wheel:e}=this.config;if(e.disabled)return;const i=e.getScale?e.getScale(t,e):dh.getScale(t,e),n=this.getLocal(t),a=Zt.getBase(t);i!==1?this.zoom(ch(n,i,a)):this.move(cf(n,e.getMove?e.getMove(t,e):dh.getMove(t,e),a))}onGesturestart(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(t){if(this.useMultiTouch)return;this.preventDefaultWheel(t);const e=this.getLocal(t),i=Zt.getBase(t),n=t.scale/this.lastGestureScale,a=t.rotation-this.lastGestureRotation;let{rotateSpeed:r}=this.config.wheel;r=Gt.within(r,0,1),this.zoom(ch(e,n*n,i)),this.rotate(uf(e,a/Math.PI*180*(r/4+.1),i)),this.lastGestureScale=t.scale,this.lastGestureRotation=t.rotation}onGestureend(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.transformEnd())}setCursor(t){super.setCursor(t);const e=[];this.eachCursor(t,e),typeof e[e.length-1]=="object"&&e.push("default"),this.canvas.view.style.cursor=e.map(i=>typeof i=="object"?`url(${i.url}) ${i.x||0} ${i.y||0}`:i).join(",")}eachCursor(t,e,i=0){if(i++,t instanceof Array)t.forEach(n=>this.eachCursor(n,e,i));else{const n=typeof t=="string"&&Po.get(t);n&&i<2?this.eachCursor(n,e,i):e.push(t)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}}function _s(s,t){let e;const{rows:i,decorationY:n,decorationHeight:a}=s.__.__textDrawData;for(let r=0,h=i.length;r<h;r++)e=i[r],e.text?t.fillText(e.text,e.x,e.y):e.data&&e.data.forEach(o=>{t.fillText(o.char,o.x,e.y)}),n&&t.fillRect(e.x,e.y+n,e.width,a)}function _f(s,t,e){e.fillStyle=s,t.__.__font?_s(t,e):t.__.windingRule?e.fill(t.__.windingRule):e.fill()}function gf(s,t,e){let i;const{windingRule:n,__font:a}=t.__;for(let r=0,h=s.length;r<h;r++)i=s[r],!(i.image&&Ze.checkImage(t,e,i,!a))&&i.style&&(e.fillStyle=i.style,i.transform?(e.save(),e.transform(i.transform),i.blendMode&&(e.blendMode=i.blendMode),a?_s(t,e):n?e.fill(n):e.fill(),e.restore()):i.blendMode?(e.saveBlendMode(i.blendMode),a?_s(t,e):n?e.fill(n):e.fill(),e.restoreBlendMode()):a?_s(t,e):n?e.fill(n):e.fill())}function Wa(s,t,e){const{strokeAlign:i}=t.__,n=typeof s!="string";switch(i){case"center":e.setStroke(n?void 0:s,t.__.strokeWidth,t.__),n?$s(s,!0,t,e):Vs(t,e);break;case"inside":uh("inside",s,n,t,e);break;case"outside":uh("outside",s,n,t,e);break}}function uh(s,t,e,i,n){const{__strokeWidth:a,__font:r}=i.__,h=n.getSameCanvas(!0,!0);h.setStroke(e?void 0:t,a*2,i.__),h.font=r,e?$s(t,!0,i,h):Vs(i,h),h.blendMode=s==="outside"?"destination-out":"destination-in",_s(i,h),h.blendMode="normal",i.__worldFlipped?n.copyWorldByReset(h,i.__nowWorld):n.copyWorldToInner(h,i.__nowWorld,i.__layout.renderBounds),h.recycle(i.__nowWorld)}function Vs(s,t){let e;const{rows:i,decorationY:n,decorationHeight:a}=s.__.__textDrawData;for(let r=0,h=i.length;r<h;r++)e=i[r],e.text?t.strokeText(e.text,e.x,e.y):e.data&&e.data.forEach(o=>{t.strokeText(o.char,o.x,e.y)}),n&&t.strokeRect(e.x,e.y+n,e.width,a)}function $s(s,t,e,i){let n;for(let a=0,r=s.length;a<r;a++)n=s[a],!(n.image&&Ze.checkImage(e,i,n,!1))&&n.style&&(i.strokeStyle=n.style,n.blendMode?(i.saveBlendMode(n.blendMode),t?Vs(e,i):i.stroke(),i.restoreBlendMode()):t?Vs(e,i):i.stroke())}function kf(s,t,e){const i=t.__,{__strokeWidth:n,strokeAlign:a,__font:r}=i;if(n)if(r)Wa(s,t,e);else switch(a){case"center":e.setStroke(s,n,i),e.stroke();break;case"inside":e.save(),e.setStroke(s,n*2,i),i.windingRule?e.clip(i.windingRule):e.clip(),e.stroke(),e.restore();break;case"outside":const h=e.getSameCanvas(!0,!0);h.setStroke(s,n*2,i),t.__drawRenderPath(h),h.stroke(),i.windingRule?h.clip(i.windingRule):h.clip(),h.clearWorld(t.__layout.renderBounds),t.__worldFlipped?e.copyWorldByReset(h,t.__nowWorld):e.copyWorldToInner(h,t.__nowWorld,t.__layout.renderBounds),h.recycle(t.__nowWorld);break}}function yf(s,t,e){const i=t.__,{__strokeWidth:n,strokeAlign:a,__font:r}=i;if(n)if(r)Wa(s,t,e);else switch(a){case"center":e.setStroke(void 0,n,i),$s(s,!1,t,e);break;case"inside":e.save(),e.setStroke(void 0,n*2,i),i.windingRule?e.clip(i.windingRule):e.clip(),$s(s,!1,t,e),e.restore();break;case"outside":const{renderBounds:h}=t.__layout,o=e.getSameCanvas(!0,!0);t.__drawRenderPath(o),o.setStroke(void 0,n*2,i),$s(s,!1,t,o),i.windingRule?o.clip(i.windingRule):o.clip(),o.clearWorld(h),t.__worldFlipped?e.copyWorldByReset(o,t.__nowWorld):e.copyWorldToInner(o,t.__nowWorld,h),o.recycle(t.__nowWorld);break}}const{getSpread:Ef,getOuterOf:mf,getByMove:wf,getIntersectData:xf}=C;function bf(s,t,e){const i=t.getSameCanvas(),n=s.__nowWorld;let a,r,h,o,{scaleX:l,scaleY:d}=n;if(l<0&&(l=-l),d<0&&(d=-d),t.bounds.includes(n))o=i,a=h=n;else{const{renderShapeSpread:_}=s.__layout,u=xf(_?Ef(t.bounds,l===d?_*l:[_*d,_*l]):t.bounds,n);r=t.bounds.getFitMatrix(u);let{a:p,d:f}=r;if(r.a<1&&(o=t.getSameCanvas(),s.__renderShape(o,e),l*=p,d*=f),h=mf(n,r),a=wf(h,-r.e,-r.f),e.matrix){const{matrix:g}=e;r.multiply(g),p*=g.scaleX,f*=g.scaleY}e=Object.assign(Object.assign({},e),{matrix:r.withScale(p,f)})}return s.__renderShape(i,e),{canvas:i,matrix:r,bounds:a,worldCanvas:o,shapeBounds:h,scaleX:l,scaleY:d}}let ca;function Ff(s,t){const e=t.__,i=[];let n=e.__input[s],a;n instanceof Array||(n=[n]),ca=Ze.recycleImage(s,e);for(let r=0,h=n.length,o;r<h;r++)o=vf(s,n[r],t),o&&i.push(o);e["_"+s]=i.length?i:void 0,i.length&&i[0].image&&(a=i[0].image.hasOpacityPixel),s==="fill"?e.__pixelFill=a:e.__pixelStroke=a}function vf(s,t,e){if(typeof t!="object"||t.visible===!1||t.opacity===0)return;const{boxBounds:i}=e.__layout;switch(t.type){case"solid":let{type:n,blendMode:a,color:r,opacity:h}=t;return{type:n,blendMode:a,style:Hs.string(r,h)};case"image":return Ze.image(e,s,t,i,!ca||!ca[t.url]);case"linear":return Bi.linearGradient(t,i);case"radial":return Bi.radialGradient(t,i);case"angular":return Bi.conicGradient(t,i);default:return t.r!==void 0?{type:"solid",style:Hs.string(t)}:void 0}}const Cf={compute:Ff,fill:_f,fills:gf,fillText:_s,stroke:kf,strokes:yf,strokeText:Wa,drawTextStroke:Vs,shape:bf};let Ps={};const{get:$a,rotateOfOuter:Wo,translate:cs,scaleOfOuter:Bf,scale:$o,rotate:zo}=S;function No(s,t,e,i,n,a,r){const h=$a();cs(h,t.x+e,t.y+i),$o(h,n,a),r&&Wo(h,{x:t.x+t.width/2,y:t.y+t.height/2},r),s.transform=h}function Ho(s,t,e,i,n,a,r){const h=$a();cs(h,t.x+e,t.y+i),n&&$o(h,n,a),r&&zo(h,r),s.transform=h}function Go(s,t,e,i,n,a,r,h,o,l){const d=$a();if(o)if(l==="center")Wo(d,{x:e/2,y:i/2},o);else switch(zo(d,o),o){case 90:cs(d,i,0);break;case 180:cs(d,e,i);break;case 270:cs(d,0,e);break}Ps.x=t.x+n,Ps.y=t.y+a,cs(d,Ps.x,Ps.y),r&&Bf(d,Ps,r,h),s.transform=d}const{get:Rf,translate:Af}=S,Sf=new et,Wn={};function jo(s,t,e,i){const{blendMode:n}=e;n&&(s.blendMode=n),s.data=Uo(e,i,t)}function Uo(s,t,e){let{width:i,height:n}=e;s.padding&&(t=Sf.set(t).shrink(s.padding));const{opacity:a,mode:r,align:h,offset:o,scale:l,size:d,rotation:_,repeat:u}=s,p=t.width===i&&t.height===n,f={mode:r},g=h!=="center"&&(_||0)%180===90,m=g?n:i,E=g?i:n;let k=0,w=0,x,A;if(!r||r==="cover"||r==="fit"){if(!p||_){const M=t.width/m,P=t.height/E;x=A=r==="fit"?Math.min(M,P):Math.max(M,P),k+=(t.width-i*x)/2,w+=(t.height-n*A)/2}}else d?(x=(typeof d=="number"?d:d.width)/i,A=(typeof d=="number"?d:d.height)/n):l&&(x=typeof l=="number"?l:l.x,A=typeof l=="number"?l:l.y);if(h){const M={x:k,y:w,width:m,height:E};x&&(M.width*=x,M.height*=A),no.toPoint(h,M,t,Wn,!0),k+=Wn.x,w+=Wn.y}switch(o&&(k+=o.x,w+=o.y),r){case"strench":p||(i=t.width,n=t.height);break;case"normal":case"clip":(k||w||x||_)&&Ho(f,t,k,w,x,A,_);break;case"repeat":(!p||x||_)&&Go(f,t,i,n,k,w,x,A,_,h),u||(f.repeat="repeat");break;case"fit":case"cover":default:x&&No(f,t,k,w,x,A,_)}return f.transform||(t.x||t.y)&&(f.transform=Rf(),Af(f.transform,t.x,t.y)),x&&r!=="strench"&&(f.scaleX=x,f.scaleY=A),f.width=i,f.height=n,a&&(f.opacity=a),u&&(f.repeat=typeof u=="string"?u==="x"?"repeat-x":"repeat-y":"repeat"),f}let Ts,Df=new et;const{isSame:Pf}=C;function Tf(s,t,e,i,n){let a,r;const h=Ct.get(e);return Ts&&e===Ts.paint&&Pf(i,Ts.boxBounds)?a=Ts.leafPaint:(a={type:e.type,image:h},Ts=h.use>1?{leafPaint:a,paint:e,boxBounds:Df.set(i)}:null),(n||h.loading)&&(r={image:h,attrName:t,attrValue:e}),h.ready?(fh(s,t,e,h,a,i),n&&(_h(s,r),gh(s,r))):h.error?n&&kh(s,r,h.error):($n(s,!0),n&&_h(s,r),a.loadId=h.load(()=>{$n(s,!1),s.destroyed||(fh(s,t,e,h,a,i)&&(h.hasOpacityPixel&&(s.__layout.hitCanvasChanged=!0),s.forceUpdate("surface")),gh(s,r)),a.loadId=null},o=>{$n(s,!1),kh(s,r,o),a.loadId=null})),a}function fh(s,t,e,i,n,a){if(t==="fill"&&!s.__.__naturalWidth){const r=s.__;if(r.__naturalWidth=i.width/r.pixelRatio,r.__naturalHeight=i.height/r.pixelRatio,r.__autoSide)return s.forceUpdate("width"),s.__proxyData&&(s.setProxyAttr("width",r.width),s.setProxyAttr("height",r.height)),!1}return n.data||jo(n,i,e,a),!0}function _h(s,t){za(s,Ie.LOAD,t)}function gh(s,t){za(s,Ie.LOADED,t)}function kh(s,t,e){t.error=e,s.forceUpdate("surface"),za(s,Ie.ERROR,t)}function za(s,t,e){s.hasEvent(t)&&s.emitEvent(new Ie(t,e))}function $n(s,t){const{leafer:e}=s;e&&e.viewReady&&(e.renderer.ignore=t)}const{get:yh,scale:Eh,copy:mh}=S,{ceil:wh,abs:xh}=Math;function ua(s,t,e){let{scaleX:i,scaleY:n}=Ct.patternLocked?s.__world:s.__nowWorld;const a=i+"-"+n;if(t.patternId!==a&&!s.destroyed){i=xh(i),n=xh(n);const{image:r,data:h}=t;let o,l,{width:d,height:_,scaleX:u,scaleY:p,opacity:f,transform:g,repeat:m}=h;u&&(l=yh(),mh(l,g),Eh(l,1/u,1/p),i*=u,n*=p),i*=e,n*=e,d*=i,_*=n;const E=d*_;if(!m&&E>b.image.maxCacheSize)return!1;let k=b.image.maxPatternSize;if(!r.isSVG){const A=r.width*r.height;k>A&&(k=A)}E>k&&(o=Math.sqrt(E/k)),o&&(i/=o,n/=o,d/=o,_/=o),u&&(i/=u,n/=p),(g||i!==1||n!==1)&&(l||(l=yh(),g&&mh(l,g)),Eh(l,1/i,1/n));const w=r.getCanvas(wh(d)||1,wh(_)||1,f),x=r.getPattern(w,m||b.origin.noRepeat||"no-repeat",l,t);return t.style=x,t.patternId=a,!0}else return!1}function Na(s,t,e,i){function n(a){return a instanceof e?a:new e(function(r){r(a)})}return new(e||(e=Promise))(function(a,r){function h(d){try{l(i.next(d))}catch(_){r(_)}}function o(d){try{l(i.throw(d))}catch(_){r(_)}}function l(d){d.done?a(d.value):n(d.value).then(h,o)}l((i=i.apply(s,[])).next())})}const{abs:bh}=Math;function Of(s,t,e,i){const{scaleX:n,scaleY:a}=Ct.patternLocked?s.__world:s.__nowWorld;if(!e.data||e.patternId===n+"-"+a)return!1;{const{data:r}=e;if(i)if(r.repeat)i=!1;else{let{width:h,height:o}=r;h*=bh(n)*t.pixelRatio,o*=bh(a)*t.pixelRatio,r.scaleX&&(h*=r.scaleX,o*=r.scaleY),i=h*o>b.image.maxCacheSize||Gs.running}return i?(t.save(),t.clip(),e.blendMode&&(t.blendMode=e.blendMode),r.opacity&&(t.opacity*=r.opacity),r.transform&&t.transform(r.transform),t.drawImage(e.image.view,0,0,r.width,r.height),t.restore(),!0):(!e.style||Gs.running?ua(s,e,t.pixelRatio):e.patternTask||(e.patternTask=Ct.patternTasker.add(()=>Na(this,void 0,void 0,function*(){e.patternTask=null,t.bounds.hit(s.__nowWorld)&&ua(s,e,t.pixelRatio),s.forceUpdate("surface")}),300)),!1)}}function Mf(s,t){const e=t["_"+s];if(e instanceof Array){let i,n,a,r;for(let h=0,o=e.length;h<o;h++)i=e[h].image,r=i&&i.url,r&&(n||(n={}),n[r]=!0,Ct.recycle(i),i.loading&&(a||(a=t.__input&&t.__input[s]||[],a instanceof Array||(a=[a])),i.unload(e[h].loadId,!a.some(l=>l.url===r))));return n}return null}const Lf={image:Tf,checkImage:Of,createPattern:ua,recycleImage:Mf,createData:jo,getPatternData:Uo,fillOrFitMode:No,clipMode:Ho,repeatMode:Go},{toPoint:Fh}=ws,zn={},Nn={};function If(s,t){let{from:e,to:i,type:n,blendMode:a,opacity:r}=s;Fh(e||"top",t,zn),Fh(i||"bottom",t,Nn);const h=b.canvas.createLinearGradient(zn.x,zn.y,Nn.x,Nn.y);Ha(h,s.stops,r);const o={type:n,style:h};return a&&(o.blendMode=a),o}function Ha(s,t,e){let i;for(let n=0,a=t.length;n<a;n++)i=t[n],typeof i=="string"?s.addColorStop(n/(a-1),Hs.string(i,e)):s.addColorStop(i.offset,Hs.string(i.color,e))}const{getAngle:Wf,getDistance:$f}=R,{get:zf,rotateOfOuter:vh,scaleOfOuter:Ch}=S,{toPoint:Bh}=ws,Ge={},Hn={};function Nf(s,t){let{from:e,to:i,type:n,opacity:a,blendMode:r,stretch:h}=s;Bh(e||"center",t,Ge),Bh(i||"bottom",t,Hn);const o=b.canvas.createRadialGradient(Ge.x,Ge.y,0,Ge.x,Ge.y,$f(Ge,Hn));Ha(o,s.stops,a);const l={type:n,style:o},d=Ga(t,Ge,Hn,h,!0);return d&&(l.transform=d),r&&(l.blendMode=r),l}function Ga(s,t,e,i,n){let a;const{width:r,height:h}=s;if(r!==h||i){const o=Wf(t,e);a=zf(),n?(Ch(a,t,r/h*(i||1),1),vh(a,t,o+90)):(Ch(a,t,1,r/h*(i||1)),vh(a,t,o))}return a}const{getDistance:Hf}=R,{toPoint:Rh}=ws,ke={},Gn={};function Gf(s,t){let{from:e,to:i,type:n,opacity:a,blendMode:r,stretch:h}=s;Rh(e||"center",t,ke),Rh(i||"bottom",t,Gn);const o=b.conicGradientSupport?b.canvas.createConicGradient(0,ke.x,ke.y):b.canvas.createRadialGradient(ke.x,ke.y,0,ke.x,ke.y,Hf(ke,Gn));Ha(o,s.stops,a);const l={type:n,style:o},d=Ga(t,ke,Gn,h||1,b.conicGradientRotate90);return d&&(l.transform=d),r&&(l.blendMode=r),l}const jf={linearGradient:If,radialGradient:Nf,conicGradient:Gf,getTransform:Ga},{copy:Ah,toOffsetOutBounds:Uf}=C,Ft={},Ei={};function Yf(s,t,e){let i,n;const{__nowWorld:a,__layout:r}=s,{shadow:h}=s.__,{worldCanvas:o,bounds:l,shapeBounds:d,scaleX:_,scaleY:u}=e,p=t.getSameCanvas(),f=h.length-1;Uf(l,Ei),h.forEach((g,m)=>{p.setWorldShadow(Ei.offsetX+g.x*_,Ei.offsetY+g.y*u,g.blur*_,g.color),n=g.spread?1+g.spread*2/(r.boxBounds.width+(r.strokeBoxSpread||0)*2):0,Yo(p,Ei,n,e),i=l,g.box&&(p.restore(),p.save(),o&&(p.copyWorld(p,l,a,"copy"),i=a),o?p.copyWorld(o,a,a,"destination-out"):p.copyWorld(e.canvas,d,l,"destination-out")),s.__worldFlipped?t.copyWorldByReset(p,i,a,g.blendMode):t.copyWorldToInner(p,i,r.renderBounds,g.blendMode),f&&m<f&&p.clearWorld(i,!0)}),p.recycle(i)}function Yo(s,t,e,i){const{bounds:n,shapeBounds:a}=i;if(b.fullImageShadow){if(Ah(Ft,s.bounds),Ft.x+=t.x-a.x,Ft.y+=t.y-a.y,e){const{matrix:r}=i;Ft.x-=(n.x+(r?r.e:0)+n.width/2)*(e-1),Ft.y-=(n.y+(r?r.f:0)+n.height/2)*(e-1),Ft.width*=e,Ft.height*=e}s.copyWorld(i.canvas,s.bounds,Ft)}else e&&(Ah(Ft,t),Ft.x-=t.width/2*(e-1),Ft.y-=t.height/2*(e-1),Ft.width*=e,Ft.height*=e),s.copyWorld(i.canvas,a,e?Ft:t)}const{toOffsetOutBounds:Vf}=C,mi={};function Xf(s,t,e){let i,n;const{__nowWorld:a,__layout:r}=s,{innerShadow:h}=s.__,{worldCanvas:o,bounds:l,shapeBounds:d,scaleX:_,scaleY:u}=e,p=t.getSameCanvas(),f=h.length-1;Vf(l,mi),h.forEach((g,m)=>{p.save(),p.setWorldShadow(mi.offsetX+g.x*_,mi.offsetY+g.y*u,g.blur*_),n=g.spread?1-g.spread*2/(r.boxBounds.width+(r.strokeBoxSpread||0)*2):0,Yo(p,mi,n,e),p.restore(),o?(p.copyWorld(p,l,a,"copy"),p.copyWorld(o,a,a,"source-out"),i=a):(p.copyWorld(e.canvas,d,l,"source-out"),i=l),p.fillWorld(i,g.color,"source-in"),s.__worldFlipped?t.copyWorldByReset(p,i,a,g.blendMode):t.copyWorldToInner(p,i,r.renderBounds,g.blendMode),f&&m<f&&p.clearWorld(i,!0)}),p.recycle(i)}function qf(s,t,e){const{blur:i}=s.__;e.setWorldBlur(i*s.__nowWorld.a),e.copyWorldToInner(t,s.__nowWorld,s.__layout.renderBounds),e.filter="none"}function Kf(s,t,e){}const Zf={shadow:Yf,innerShadow:Xf,blur:qf,backgroundBlur:Kf},{excludeRenderBounds:Qf}=Gi;he.prototype.__renderMask=function(s,t){let e,i,n,a,r;const{children:h}=this;for(let o=0,l=h.length;o<l;o++)e=h[o],!(e.__.mask&&(r&&(Sh(this,r,s,n,i,a),i=n=null),e.__.mask==="path"?(e.opacity<1?(r="opacity-path",a=e.opacity,n||(n=jn(s))):(r="path",s.save()),e.__clip(n||s,t)):(r="alpha",i||(i=jn(s)),n||(n=jn(s)),e.__render(i,t)),e.__.mask!=="clipping"))&&(Qf(e,t)||e.__render(n||s,t));Sh(this,r,s,n,i,a)};function Sh(s,t,e,i,n,a){switch(t){case"alpha":Jf(s,e,i,n);break;case"opacity-path":Vo(s,e,i,a);break;case"path":e.restore()}}function jn(s){return s.getSameCanvas(!1,!0)}function Jf(s,t,e,i){const n=s.__nowWorld;e.resetTransform(),e.opacity=1,e.useMask(i,n),i.recycle(n),Vo(s,t,e,1)}function Vo(s,t,e,i){const n=s.__nowWorld;t.resetTransform(),t.opacity=i,t.copyWorld(e,n),e.recycle(n)}const t_="",e_="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz",s_=""+t_,i_="",n_="",a_="",r_=`{[(<'"`+s_,Xo=`>)]}%!?,.:;'"`+i_,h_=Xo+"_#~&*+\\=|"+n_,o_="- "+a_,l_=[[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]],d_=new RegExp(l_.map(([s,t])=>`[\\u${s.toString(16)}-\\u${t.toString(16)}]`).join("|"));function si(s){const t={};return s.split("").forEach(e=>t[e]=!0),t}const p_=si(e_),c_=si(r_),u_=si(Xo),f_=si(h_),__=si(o_);var Pi;(function(s){s[s.Letter=0]="Letter",s[s.Single=1]="Single",s[s.Before=2]="Before",s[s.After=3]="After",s[s.Symbol=4]="Symbol",s[s.Break=5]="Break"})(Pi||(Pi={}));const{Letter:Dh,Single:g_,Before:k_,After:y_,Symbol:E_,Break:m_}=Pi;function w_(s){return p_[s]?Dh:__[s]?m_:c_[s]?k_:u_[s]?y_:f_[s]?E_:d_.test(s)?g_:Dh}const x_={trimRight(s){const{words:t}=s;let e=0,i=t.length,n;for(let a=i-1;a>-1&&(n=t[a].data[0],n.char===" ");a--)e++,s.width-=n.width;e&&t.splice(i-e,e)}};function b_(s,t,e){switch(t){case"title":return e?s.toUpperCase():s;case"upper":return s.toUpperCase();case"lower":return s.toLowerCase();default:return s}}const{trimRight:F_}=x_,{Letter:Un,Single:Os,Before:Ph,After:Yn,Symbol:v_,Break:Th}=Pi;let zs,ie,wt,ne,Vn,Ut,ye,Xs,ms,Lt,Ae,Xn,Ms,us,fa,ps=[],_a;function C_(s,t,e){fa=s,ps=s.rows,_a=s.bounds;const{__letterSpacing:i,paraIndent:n,textCase:a}=e,{canvas:r}=b,{width:h,height:o}=_a;if(h||o||i||a!=="none"){const d=e.textWrap!=="none",_=e.textWrap==="break";us=!0,Ae=null,Xs=ye=ms=wt=ne=0,zs={data:[]},ie={words:[]};for(let u=0,p=t.length;u<p;u++)Ut=t[u],Ut===`
`?(wt&&je(),ie.paraEnd=!0,Ls(),us=!0):(Lt=w_(Ut),Lt===Un&&a!=="none"&&(Ut=b_(Ut,a,!wt)),ye=r.measureText(Ut).width,i&&(i<0&&(ms=ye),ye+=i),Xn=Lt===Os&&(Ae===Os||Ae===Un)||Ae===Os&&Lt!==Yn,Ms=(Lt===Ph||Lt===Os)&&(Ae===v_||Ae===Yn),Vn=us&&n?h-n:h,d&&h&&ne+wt+ye>Vn&&(_?(wt&&je(),ne&&Ls()):(Ms||(Ms=Lt===Un&&Ae==Yn),(Xn||Ms||Lt===Th||Lt===Ph||Lt===Os||wt+ye>Vn)&&wt&&je(),ne&&Ls())),Ut===" "&&us!==!0&&ne+wt===0||(Lt===Th?(Ut===" "&&wt&&je(),qn(Ut,ye),je()):((Xn||Ms)&&wt&&je(),qn(Ut,ye))),Ae=Lt);wt&&je(),ne&&Ls(),ps.length>0&&(ps[ps.length-1].paraEnd=!0)}else t.split(`
`).forEach(d=>{fa.paraNumber++,ps.push({x:n||0,text:d,width:r.measureText(d).width,paraStart:!0})})}function qn(s,t){ms&&!Xs&&(Xs=ms),zs.data.push({char:s,width:t}),wt+=t}function je(){ne+=wt,zs.width=wt,ie.words.push(zs),zs={data:[]},wt=0}function Ls(){us&&(fa.paraNumber++,ie.paraStart=!0,us=!1),ms&&(ie.startCharSize=Xs,ie.endCharSize=ms,Xs=0),ie.width=ne,_a.width&&F_(ie),ps.push(ie),ie={words:[]},ne=0}const B_=0,Oh=1,Mh=2;function R_(s,t,e,i){const{rows:n}=s,{textAlign:a,paraIndent:r,letterSpacing:h}=t;let o,l,d,_,u;n.forEach(p=>{p.words&&(d=r&&p.paraStart?r:0,l=e&&a==="justify"&&p.words.length>1?(e-p.width-d)/(p.words.length-1):0,_=h||p.isOverflow?B_:l>.01?Oh:Mh,p.isOverflow&&!h&&(p.textMode=!0),_===Mh?(p.x+=d,A_(p)):(p.x+=d,o=p.x,p.data=[],p.words.forEach(f=>{_===Oh?(u={char:"",x:o},o=S_(f.data,o,u),(p.isOverflow||u.char!==" ")&&p.data.push(u)):o=D_(f.data,o,p.data,p.isOverflow),!p.paraEnd&&l&&(o+=l,p.width+=l)})),p.words=null)})}function A_(s){s.text="",s.words.forEach(t=>{t.data.forEach(e=>{s.text+=e.char})})}function S_(s,t,e){return s.forEach(i=>{e.char+=i.char,t+=i.width}),t}function D_(s,t,e,i){return s.forEach(n=>{(i||n.char!==" ")&&(n.x=t,e.push(n)),t+=n.width}),t}function P_(s,t){const{rows:e,bounds:i}=s,{__lineHeight:n,__baseLine:a,__letterSpacing:r,__clipText:h,textAlign:o,verticalAlign:l,paraSpacing:d}=t;let{x:_,y:u,width:p,height:f}=i,g=n*e.length+(d?d*(s.paraNumber-1):0),m=a;if(h&&g>f)g=Math.max(f,n),s.overflow=e.length;else switch(l){case"middle":u+=(f-g)/2;break;case"bottom":u+=f-g}m+=u;let E,k,w;for(let x=0,A=e.length;x<A;x++){if(E=e[x],E.x=_,E.width<p||E.width>p&&!h)switch(o){case"center":E.x+=(p-E.width)/2;break;case"right":E.x+=p-E.width}E.paraStart&&d&&x>0&&(m+=d),E.y=m,m+=n,s.overflow>x&&m>g&&(E.isOverflow=!0,s.overflow=x+1),k=E.x,w=E.width,r<0&&(E.width<0?(w=-E.width+t.fontSize+r,k-=w,w+=t.fontSize):w-=r),k<i.x&&(i.x=k),w>i.width&&(i.width=w),h&&p&&p<w&&(E.isOverflow=!0,s.overflow||(s.overflow=e.length))}i.y=u,i.height=g}function T_(s,t,e,i){if(!i)return;const{rows:n,overflow:a}=s;let{textOverflow:r}=t;if(n.splice(a),r&&r!=="show"){r==="hide"?r="":r==="ellipsis"&&(r="...");let h,o;const l=r?b.canvas.measureText(r).width:0,d=e+i-l;(t.textWrap==="none"?n:[n[a-1]]).forEach(u=>{if(u.isOverflow&&u.data){let p=u.data.length-1;for(let f=p;f>-1&&(h=u.data[f],o=h.x+h.width,!(f===p&&o<d));f--){if(o<d&&h.char!==" "){u.data.splice(f+1),u.width-=h.width;break}u.width-=h.width}u.width+=l,u.data.push({char:r,x:o}),u.textMode&&O_(u)}})}}function O_(s){s.text="",s.data.forEach(t=>{s.text+=t.char}),s.data=null}function M_(s,t){const{fontSize:e}=t;switch(s.decorationHeight=e/11,t.textDecoration){case"under":s.decorationY=e*.15;break;case"delete":s.decorationY=-e*.35}}const{top:ga,right:qo,bottom:Ko,left:ka}=ia;function L_(s,t){typeof s!="string"&&(s=String(s));let e=0,i=0,n=t.__getInput("width")||0,a=t.__getInput("height")||0;const{textDecoration:r,__font:h,__padding:o}=t;o&&(n&&(e=o[ka],n-=o[qo]+o[ka]),a&&(i=o[ga],a-=o[ga]+o[Ko]));const l={bounds:{x:e,y:i,width:n,height:a},rows:[],paraNumber:0,font:b.canvas.font=h};return C_(l,s,t),o&&I_(o,l,t,n,a),P_(l,t),R_(l,t,n),l.overflow&&T_(l,t,e,n),r!=="none"&&M_(l,t),l}function I_(s,t,e,i,n){if(!i)switch(e.textAlign){case"left":wi(t,"x",s[ka]);break;case"right":wi(t,"x",-s[qo])}if(!n)switch(e.verticalAlign){case"top":wi(t,"y",s[ga]);break;case"bottom":wi(t,"y",-s[Ko])}}function wi(s,t,e){const{bounds:i,rows:n}=s;i[t]+=e;for(let a=0;a<n.length;a++)n[a][t]+=e}const W_={getDrawData:L_};function $_(s,t){if(typeof s=="string")return s;let e=s.a===void 0?1:s.a;t&&(e*=t);const i=s.r+","+s.g+","+s.b;return e===1?"rgb("+i+")":"rgba("+i+","+e+")"}const z_={string:$_},{setPoint:N_,addPoint:H_,toBounds:G_}=qs;function j_(s){const{width:t,height:e}=s.view,{data:i}=s.context.getImageData(0,0,t,e);let n,a,r,h=0;for(let l=0;l<i.length;l+=4)i[l+3]!==0&&(n=h%t,a=(h-n)/t,r?H_(r,n,a):N_(r={},n,a)),h++;const o=new et;return G_(r,o),o.scale(1/s.pixelRatio).ceil()}const U_={export(s,t,e){this.running=!0;const i=we.fileType(t);return e=we.getExportOptions(e),Y_(n=>new Promise(a=>{const r=d=>{n(d),a(),this.running=!1},{toURL:h}=b,{download:o}=b.origin;if(t==="json")return r({data:s.toJSON(e.json)});if(i==="json")return o(h(JSON.stringify(s.toJSON(e.json)),"text"),t),r({data:!0});if(t==="svg")return r({data:s.toSVG()});if(i==="svg")return o(h(s.toSVG(),"svg"),t),r({data:!0});const{leafer:l}=s;l?(Zo(s),l.waitViewCompleted(()=>Na(this,void 0,void 0,function*(){let d,_,u=1,p=1;const{worldTransform:f,isLeafer:g,isFrame:m}=s,{slice:E,trim:k,onCanvas:w}=e;let x=e.scale||1,A=e.pixelRatio||1;const M=e.smooth===void 0?l.config.smooth:e.smooth,P=e.contextSettings||l.config.contextSettings;s.isApp&&(x*=A,A=s.app.pixelRatio);const W=e.screenshot||s.isApp,J=g&&W&&e.fill===void 0?s.fill:e.fill,it=we.isOpaqueImage(t)||J,Y=new Oe;if(W)d=W===!0?g?l.canvas.bounds:s.worldRenderBounds:W;else{let nt=e.relative||(g?"inner":"local");switch(u=f.scaleX,p=f.scaleY,nt){case"inner":Y.set(f);break;case"local":Y.set(f).divide(s.localTransform),u/=s.scaleX,p/=s.scaleY;break;case"world":u=1,p=1;break;case"page":nt=s.leafer;default:Y.set(f).divide(s.getTransform(nt));const Pt=nt.worldTransform;u/=u/Pt.scaleX,p/=p/Pt.scaleY}d=s.getBounds("render",nt)}const{x:tt,y:j,width:rt,height:V}=new et(d).scale(x);let T=pt.canvas({width:Math.round(rt),height:Math.round(V),pixelRatio:A,smooth:M,contextSettings:P});const ht={matrix:Y.scale(1/x).invert().translate(-tt,-j).withScale(1/u*x,1/p*x)};if(E&&(s=l,ht.bounds=T.bounds),T.save(),m&&J!==void 0){const nt=s.get("fill");s.fill="",s.__render(T,ht),s.fill=nt}else s.__render(T,ht);if(T.restore(),k){_=j_(T);const nt=T,{width:Pt,height:jt}=_,Ce={x:0,y:0,width:Pt,height:jt,pixelRatio:A};T=pt.canvas(Ce),T.copyWorld(nt,_,Ce)}it&&T.fillWorld(T.bounds,J||"#FFFFFF","destination-over"),w&&w(T);const ot=t==="canvas"?T:yield T.export(t,e);r({data:ot,width:T.pixelWidth,height:T.pixelHeight,renderBounds:d,trimBounds:_})}))):r({data:!1})}))}};let Kn;function Y_(s){return Kn||(Kn=new ha),new Promise(t=>{Kn.add(()=>Na(this,void 0,void 0,function*(){return yield s(t)}),{parallel:!1})})}function Zo(s){s.__.__needComputePaint&&s.__.__computePaint(),s.isBranch&&s.children.forEach(t=>Zo(t))}const Xi=Sa.prototype,Qo=H.get("@leafer-ui/export");Xi.export=function(s,t){const{quality:e,blob:i}=we.getExportOptions(t);return s.includes(".")?this.saveAs(s,e):i?this.toBlob(s,e):this.toDataURL(s,e)};Xi.toBlob=function(s,t){return new Promise(e=>{b.origin.canvasToBolb(this.view,s,t).then(i=>{e(i)}).catch(i=>{Qo.error(i),e(null)})})};Xi.toDataURL=function(s,t){return b.origin.canvasToDataURL(this.view,s,t)};Xi.saveAs=function(s,t){return new Promise(e=>{b.origin.canvasSaveAs(this.view,s,t).then(()=>{e(!0)}).catch(i=>{Qo.error(i),e(!1)})})};Object.assign(Fo,W_);Object.assign(Hs,z_);Object.assign(ft,Cf);Object.assign(Ze,Lf);Object.assign(Bi,jf);Object.assign(la,Zf);Object.assign(Gs,U_);Object.assign(pt,{interaction:(s,t,e,i)=>new ff(s,t,e,i),hitCanvas:(s,t)=>new Io(s,t),hitCanvasManager:()=>new zu});Vu();const{M:V_,L:X_,C:q_,Q:K_,Z:Z_,N:Q_,D:J_,X:tg,G:Lh,F:Ih,O:eg,P:sg,U:ig}=Ht,ja={scale(s,t,e){if(!s)return;let i,n=0,a=s.length;for(;n<a;)switch(i=s[n],i){case V_:It(s,t,e,n,1),n+=3;break;case X_:It(s,t,e,n,1),n+=3;break;case q_:It(s,t,e,n,3),n+=7;break;case K_:It(s,t,e,n,2),n+=5;break;case Z_:n+=1;break;case Q_:It(s,t,e,n,2),n+=5;break;case J_:It(s,t,e,n,2),n+=9;break;case tg:It(s,t,e,n,2),n+=6;break;case Lh:It(s,t,e,n,2),n+=9;break;case Ih:It(s,t,e,n,2),n+=5;break;case eg:s[n]=Lh,s.splice(n+4,0,s[n+3],0),It(s,t,e,n,2),n+=9,a+=2;break;case sg:s[n]=Ih,s.splice(n+4,0,s[n+3]),It(s,t,e,n,2),n+=5,a+=1;break;case ig:It(s,t,e,n,2),n+=6;break}},scalePoints(s,t,e,i,n){for(let a=n?i+1:0,r=n?a+n*2:s.length;a<r;a+=2)s[a]*=t,s[a+1]*=e}},{scalePoints:It}=ja,Zn=S.get();function qi(s,t,e){s.pathInputed?Ki(s,t,e):(t!==1&&(s.width*=t),e!==1&&(s.height*=e))}function ng(s,t,e){const{width:i,height:n}=s.__localBoxBounds;t!==1?(s.fontSize*=t,s.y-=n*(t-e)/2):e!==1&&(s.fontSize*=e,s.x-=i*(e-t)/2)}function Ki(s,t,e){ja.scale(s.__.path,t,e),s.path=s.__.path}function Jo(s,t,e){ja.scalePoints(s.__.points,t,e),s.points=s.__.points}function ya(s,t,e){const{children:i}=s;for(let n=0;n<i.length;n++)Zn.a=t,Zn.d=e,i[n].transform(Zn,!0)}const Zi=Ke.prototype;Zi.scaleResize=function(s,t=s,e){const i=this;e||i.editConfig&&i.editConfig.editSize==="scale"?(i.scaleX*=s,i.scaleY*=t):(s<0&&(i.scaleX*=-1,s=-s),t<0&&(i.scaleY*=-1,t=-t),this.__scaleResize(s,t))};Zi.__scaleResize=function(s,t){qi(this,s,t)};Zi.resizeWidth=function(s){const t=s/this.getBounds("box","local").width;this.scaleOf(this.__layout.boxBounds,t,this.__.lockRatio?t:1,!0)};Zi.resizeHeight=function(s){const t=s/this.getBounds("box","local").height;this.scaleOf(this.__layout.boxBounds,this.__.lockRatio?t:1,t,!0)};U.prototype.__scaleResize=function(s,t){this.__.__autoSize&&(this.__.resizeFontSize||this.editConfig&&this.editConfig.editSize==="font-size")?ng(this,s,t):qi(this,s,t)};Es.prototype.__scaleResize=function(s,t){Ki(this,s,t)};oe.prototype.__scaleResize=function(s,t){this.pathInputed?Ki(this,s,t):this.points?Jo(this,s,t):this.width*=s};be.prototype.__scaleResize=function(s,t){this.pathInputed?Ki(this,s,t):this.points?Jo(this,s,t):qi(this,s,t)};he.prototype.__scaleResize=function(s,t){ya(this,s,t)};ct.prototype.__scaleResize=function(s,t){this.__.__autoSize&&this.children.length?ya(this,s,t):(qi(this,s,t),this.__.resizeChildren&&ya(this,s,t))};function Qn(s,t,e,i){var n,a=arguments.length,r=a<3?t:i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,t,e,i);else for(var h=s.length-1;h>=0;h--)(n=s[h])&&(r=(a<3?n(r):a>3?n(t,e,r):n(t,e))||r);return a>3&&r&&Object.defineProperty(t,e,r),r}let St=class extends ct{get __tag(){return"Flow"}constructor(s){super(s),this.__hasAutoLayout=!0}};Qn([kt(class extends Oa{})],St.prototype,"__",void 0),Qn([zi("x")],St.prototype,"flow",void 0),St=Qn([yt()],St);const Jn={},tl={"top-left":"from",top:"center","top-right":"to",right:"to","bottom-right":"to",bottom:"center","bottom-left":"from",left:"from",center:"center","baseline-left":"from","baseline-center":"center","baseline-right":"to"},el={"top-left":"from",top:"from","top-right":"from",right:"center","bottom-right":"to",bottom:"to","bottom-left":"to",left:"center",center:"center","baseline-left":"to","baseline-center":"to","baseline-right":"to"};function Ti(s,t,e){no.toPoint(e,t,s.__layout.contentBounds,Jn);const i=s.__;t.x=i.__autoWidth?0:Jn.x,t.y=i.__autoHeight?0:Jn.y}const{move:ag}=R;function Wh(s,t,e,i,n,a){const{children:r}=s;let h,o,{x:l,start:d}=t,_=i;l+=e;for(let u=0,p=t.count;u<p;u++)h=r[a?d-u:d+u],h.__.inFlow&&h.__.visible!==0?(o=h.__flowBounds,n!=="from"&&(_=i+(t.height-o.height)/(n==="center"?2:1)),ag(h,l-o.x,_-o.y),l+=o.width+t.gap):p++}function Oi(s,t,e){const i=e==="width"?"height":"width";s[e]=Math.max(s[e],t[e]),s[i]+=s.count?t[i]+s.gap:t[i],s.list.push(t),s.count++}const Z={};function sl(s,t){const{gap:e,flowAlign:i,flowWrap:n,__autoWidth:a,__autoHeight:r}=s.__,h=n&&(t?!a:!r);return typeof e=="object"?(Z.xGap=e.x||0,Z.yGap=e.y||0):Z.xGap=Z.yGap=e,Z.isAutoXGap=typeof Z.xGap=="string"&&!a,Z.isAutoYGap=typeof Z.yGap=="string"&&!r,Z.complex=h||i!=="top-left"||s.__hasGrow||Z.isAutoXGap||Z.isAutoYGap,Z.wrap=h,Z.complex&&(Z.isFitXGap=Z.xGap==="fit"&&!a,Z.isFitYGap=Z.yGap==="fit"&&!r,typeof i=="object"?(Z.contentAlign=i.content||"top-left",Z.rowXAlign=i.x||"from",Z.rowYAlign=i.y||"from"):(Z.contentAlign=i,Z.rowXAlign=tl[i],Z.rowYAlign=el[i])),Z}function Mi(s,t){return{x:0,y:0,width:0,height:0,gap:t,start:s,count:0,grow:0}}function gs(s,t,e,i){const{count:n}=s;n>1&&(e>s[t]||i)&&(s.gap=(e-s[t])/(n-1),s[t]=e)}function il(s,t){return t==="box"?s.__local:s.__layout.localStrokeBounds}const{within:rg}=Gt;function $h(s,t,e,i){let n,a,r,h=0,o=t.hasRangeSize&&[],{grow:l,start:d}=t;const _=t.width<e?(e-t.width)/l:0,{children:u}=s;_&&(t.width=e);for(let p=0,f=t.count;p<f;p++)n=u[i?d-p:d+p],n.__.inFlow&&n.__.visible!==0?(a=n.__widthGrow)&&(r=Ea(n,n.__flowBounds,_*a),r?(h+=r,l-=a):o&&(n.__.widthRange?o.unshift(n):o.push(n))):f++;h&&function(p,f,g){let m,E,k,w;p.forEach(x=>{m=x.__widthGrow,E=f/g*m,w=Ea(x,k=x.__flowBounds,k.width+E),f-=E-w,g-=m})}(o,h,l)}function Ea(s,t,e){const{widthRange:i,lockRatio:n}=s.__,a=i?rg(e,i.min,i.max):e,r=a/t.width;return s.scaleResize(r,n?r:1),t.width=a,e-a}const{within:hg}=Gt;function zh(s,t,e,i){let n,a,r,h=0,o=t.hasRangeSize&&[],{grow:l,start:d}=t;const _=t.height<e?(e-t.height)/l:0,{children:u}=s;_&&(t.height=e);for(let p=0,f=t.count;p<f;p++)n=u[i?d-p:d+p],n.__.inFlow&&n.__.visible!==0?(a=n.__heightGrow)&&(r=ma(n,n.__flowBounds,_*a),r?(h+=r,l-=a):o&&(n.__.heightRange?o.unshift(n):o.push(n))):f++;h&&function(p,f,g){let m,E,k,w;p.forEach(x=>{m=x.__heightGrow,E=f/g*m,w=ma(x,k=x.__flowBounds,k.height+E),f-=E-w,g-=m})}(o,h,l)}function ma(s,t,e){const{heightRange:i,lockRatio:n}=s.__,a=i?hg(e,i.min,i.max):e,r=a/t.height;return s.scaleResize(n?r:1,r),t.height=a,e-a}const{move:og}=R,{move:lg}=R;function Nh(s,t,e,i,n,a){const{children:r}=s;let h,o,{y:l,start:d}=t,_=e;l+=i;for(let u=0,p=t.count;u<p;u++)h=r[a?d-u:d+u],h.__.inFlow&&h.__.visible!==0?(o=h.__flowBounds,n!=="from"&&(_=e+(t.width-o.width)/(n==="center"?2:1)),lg(h,_-o.x,l-o.y),l+=o.height+t.gap):p++}const{move:dg}=R;function Hh(s){return st(s,t=>({set(e){const i=typeof e=="number"?e:0;t==="autoWidth"?this.__widthGrow=i:this.__heightGrow=i,!i||this.parent&&this.parent.__hasGrow||this.waitParent(()=>{this.parent.__hasGrow=!0}),this.__setAttr(t,e)&&bs(this)}}))}const{copyAndSpread:pg}=C;let Gh=function(s,t){const e="width",{children:i,itemBox:n}=s,a=sl(s,!0),{complex:r,wrap:h,xGap:o,yGap:l,isAutoXGap:d,isFitXGap:_}=a;if(!i.length)return;const u=h&&{x:0,y:0,width:0,height:0,gap:0,count:0,list:[]},p=d?0:o;let f,g,m,E,k,{x:w,y:x,width:A,height:M}=s.__layout.contentBounds;for(let P=0,W=i.length;P<W;P++)f=i[E=t?W-1-P:P],f.__.inFlow&&f.__.visible!==0&&(g=il(f,n),r?(f.__flowBounds=g,k||(k=Mi(E,p)),h&&k.count&&k.width+g.width>A&&(k.grow?$h(s,k,A,t):d&&gs(k,e,A,_),Oi(u,k,e),k=Mi(E,p)),m=g.width,f.__widthGrow&&(k.grow+=f.__widthGrow,m=0,f.__.widthRange&&(k.hasRangeSize=!0)),f.__heightGrow&&ma(f,g,M),k.width+=k.count?m+p:m,k.height=Math.max(k.height,g.height),k.count++):(og(f,w-g.x,x-g.y),w+=g.width+p));if(r){const{isAutoYGap:P,isFitYGap:W,contentAlign:J,rowXAlign:it,rowYAlign:Y}=a;k.count&&(k.grow?$h(s,k,A,t):d&&gs(k,e,A,_),h&&Oi(u,k,e)),h?(P?gs(u,"height",M,W):u.gap=l,function(tt,j,rt,V){Ti(tt,j,rt);const{list:T}=j;if(T.length>1&&(V||(V=tl[rt]),V!=="from")){let ht;for(let ot=0,nt=T.length;ot<nt;ot++)ht=T[ot],ht.x=j.width-ht.width,V==="center"&&(ht.x/=2)}}(s,u,J,it),function(tt,j,rt,V){const{list:T}=j,ht=tt.__.flowWrap==="reverse";let ot,{x:nt,y:Pt}=j;for(let jt=0,Ce=T.length;jt<Ce;jt++)ot=T[ht?Ce-1-jt:jt],Wh(tt,ot,nt,Pt,rt,V),Pt+=ot.height+j.gap}(s,u,Y,t)):(Ti(s,k,J),Wh(s,k,0,k.y,Y,t))}},jh=function(s,t){const e="height",{children:i,itemBox:n}=s,a=sl(s,!1),{complex:r,wrap:h,xGap:o,yGap:l,isAutoYGap:d,isFitYGap:_}=a;if(!i.length)return;const u=h&&{x:0,y:0,width:0,height:0,gap:0,count:0,list:[]},p=d?0:l;let f,g,m,E,k,{x:w,y:x,width:A,height:M}=s.__layout.contentBounds;for(let P=0,W=i.length;P<W;P++)f=i[E=t?W-1-P:P],f.__.inFlow&&f.__.visible!==0&&(g=il(f,n),r?(f.__flowBounds=g,k||(k=Mi(E,p)),h&&k.count&&k.height+g.height>M&&(k.grow&&zh(s,k,M,t),d&&gs(k,e,M,_),Oi(u,k,e),k=Mi(E,p)),m=g.height,f.__heightGrow&&(k.grow+=f.__heightGrow,m=0,f.__.heightRange&&(k.hasRangeSize=!0)),f.__widthGrow&&Ea(f,g,A),k.height+=k.count?m+p:m,k.width=Math.max(k.width,g.width),k.count++):(dg(f,w-g.x,x-g.y),x+=g.height+p));if(r){const{isAutoXGap:P,isFitXGap:W,contentAlign:J,rowXAlign:it,rowYAlign:Y}=a;k.count&&(k.grow&&zh(s,k,M,t),d&&gs(k,e,M,_),h&&Oi(u,k,e)),h?(P?gs(u,"width",A,W):u.gap=o,function(tt,j,rt,V){Ti(tt,j,rt);const{list:T}=j;if(T.length>1&&(V||(V=el[rt]),V!=="from")){let ht;for(let ot=0,nt=T.length;ot<nt;ot++)ht=T[ot],ht.y=j.height-ht.height,V==="center"&&(ht.y/=2)}}(s,u,J,Y),function(tt,j,rt,V){const{list:T}=j,ht=tt.__.flowWrap==="reverse";let ot,{x:nt,y:Pt}=j;for(let jt=0,Ce=T.length;jt<Ce;jt++)ot=T[ht?Ce-1-jt:jt],Nh(tt,ot,nt,Pt,rt,V),nt+=ot.width+j.gap}(s,u,it,t)):(Ti(s,k,J),Nh(s,k,k.x,0,it,t))}};y.changeAttr("autoWidth",void 0,Hh),y.changeAttr("autoHeight",void 0,Hh),ct.prototype.__updateFlowLayout=function(){this.leafer.created=!1;const{flow:s}=this.__;switch(s){case"x":case!0:Gh(this);break;case"y":jh(this);break;case"x-reverse":Gh(this,!0);break;case"y-reverse":jh(this,!0)}this.leafer.created=!0},ct.prototype.__updateContentBounds=function(){const{padding:s}=this.__,t=this.__layout,e=t.contentBounds===t.boxBounds;s?(e&&t.shrinkContent(),pg(t.contentBounds,t.boxBounds,s,!0)):e||t.shrinkContentCancel()};function nl(s){return s.selected||s.disabled||Et.isFocus(s)}function wa(s){const t=s.__.normalStyle;t&&(s.set(t),s.__.normalStyle=void 0)}function Se(s,t,e){let i;const n=s.__;if(e)i=!nl(s)&&n[t];else switch(t){case"disabledStyle":i=n[t];break;case"focusStyle":i=!s.disabled&&n[t];break;case"selectedStyle":i=!s.disabled&&!Et.isFocus(s)&&n[t];break}i&&(wa(s),s.__.normalStyle=s.get(i),s.set(i))}function xa(s,t,e){e?nl(s)||(wa(s),Et.isPress(s)&&s.pressStyle?Se(s,"pressStyle",!0):Et.isHover(s)&&s.hoverStyle&&Se(s,"hoverStyle",!0)):(wa(s),s.disabledStyle&&s.disabled?Se(s,"disabledStyle"):s.focusStyle&&Et.isFocus(s)?Se(s,"focusStyle"):s.selectedStyle&&s.selected&&Se(s,"selectedStyle"))}function cg(s,t){switch(t){case B.ENTER:Se(s,"hoverStyle",!0);break;case B.LEAVE:xa(s,"hoverStyle",!0);break;case B.DOWN:Se(s,"pressStyle",!0);break;case B.UP:xa(s,"pressStyle",!0);break}}Et.isHover=function(s){return s.leafer&&s.leafer.interaction.isHover(s)};Et.isPress=function(s){return s.leafer&&s.leafer.interaction.isPress(s)};Et.isFocus=function(s){return s.leafer&&s.leafer.interaction.isFocus(s)};Et.isDrag=function(s){return s.leafer&&s.leafer.interaction.isDrag(s)};Et.setStyle=function(s,t,e){e?Se(s,t):xa(s)};Et.updateEventStyle=cg;y.prototype.focus=function(s=!0){this.waitLeafer(()=>{let{focusData:t}=this.app.interaction;s?(t&&t.focus(!1),t=this):t=null,this.app.interaction.focusData=t,Et.setStyle(this,"focusStyle",s)})};function gt(s,t){ug(s)&&(s="100%");const e=fg(s);return s=t===360?s:Math.min(t,Math.max(0,parseFloat(s))),e&&(s=parseInt(String(s*t),10)/100),Math.abs(s-t)<1e-6?1:(t===360?s=(s<0?s%t+t:s%t)/parseFloat(String(t)):s=s%t/parseFloat(String(t)),s)}function xi(s){return Math.min(1,Math.max(0,s))}function ug(s){return typeof s=="string"&&s.indexOf(".")!==-1&&parseFloat(s)===1}function fg(s){return typeof s=="string"&&s.indexOf("%")!==-1}function al(s){return s=parseFloat(s),(isNaN(s)||s<0||s>1)&&(s=1),s}function bi(s){return Number(s)<=1?`${Number(s)*100}%`:s}function Ve(s){return s.length===1?"0"+s:String(s)}function _g(s,t,e){return{r:gt(s,255)*255,g:gt(t,255)*255,b:gt(e,255)*255}}function Uh(s,t,e){s=gt(s,255),t=gt(t,255),e=gt(e,255);const i=Math.max(s,t,e),n=Math.min(s,t,e);let a=0,r=0;const h=(i+n)/2;if(i===n)r=0,a=0;else{const o=i-n;switch(r=h>.5?o/(2-i-n):o/(i+n),i){case s:a=(t-e)/o+(t<e?6:0);break;case t:a=(e-s)/o+2;break;case e:a=(s-t)/o+4;break}a/=6}return{h:a,s:r,l:h}}function ta(s,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?s+(t-s)*(6*e):e<1/2?t:e<2/3?s+(t-s)*(2/3-e)*6:s}function gg(s,t,e){let i,n,a;if(s=gt(s,360),t=gt(t,100),e=gt(e,100),t===0)n=e,a=e,i=e;else{const r=e<.5?e*(1+t):e+t-e*t,h=2*e-r;i=ta(h,r,s+1/3),n=ta(h,r,s),a=ta(h,r,s-1/3)}return{r:i*255,g:n*255,b:a*255}}function Yh(s,t,e){s=gt(s,255),t=gt(t,255),e=gt(e,255);const i=Math.max(s,t,e),n=Math.min(s,t,e);let a=0;const r=i,h=i-n,o=i===0?0:h/i;if(i===n)a=0;else{switch(i){case s:a=(t-e)/h+(t<e?6:0);break;case t:a=(e-s)/h+2;break;case e:a=(s-t)/h+4;break}a/=6}return{h:a,s:o,v:r}}function kg(s,t,e){s=gt(s,360)*6,t=gt(t,100),e=gt(e,100);const i=Math.floor(s),n=s-i,a=e*(1-t),r=e*(1-n*t),h=e*(1-(1-n)*t),o=i%6,l=[e,r,a,a,h,e][o],d=[h,e,e,r,a,a][o],_=[a,a,h,e,e,r][o];return{r:l*255,g:d*255,b:_*255}}function Vh(s,t,e,i){const n=[Ve(Math.round(s).toString(16)),Ve(Math.round(t).toString(16)),Ve(Math.round(e).toString(16))];return i&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function yg(s,t,e,i,n){const a=[Ve(Math.round(s).toString(16)),Ve(Math.round(t).toString(16)),Ve(Math.round(e).toString(16)),Ve(mg(i))];return n&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function Eg(s,t,e,i){const n=s/100,a=t/100,r=e/100,h=i/100,o=255*(1-n)*(1-h),l=255*(1-a)*(1-h),d=255*(1-r)*(1-h);return{r:o,g:l,b:d}}function Xh(s,t,e){let i=1-s/255,n=1-t/255,a=1-e/255,r=Math.min(i,n,a);return r===1?(i=0,n=0,a=0):(i=(i-r)/(1-r)*100,n=(n-r)/(1-r)*100,a=(a-r)/(1-r)*100),r*=100,{c:Math.round(i),m:Math.round(n),y:Math.round(a),k:Math.round(r)}}function mg(s){return Math.round(parseFloat(s)*255).toString(16)}function qh(s){return At(s)/255}function At(s){return parseInt(s,16)}function wg(s){return{r:s>>16,g:(s&65280)>>8,b:s&255}}const ba={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function xg(s){let t={r:0,g:0,b:0},e=1,i=null,n=null,a=null,r=!1,h=!1;return typeof s=="string"&&(s=vg(s)),typeof s=="object"&&(Rt(s.r)&&Rt(s.g)&&Rt(s.b)?(t=_g(s.r,s.g,s.b),r=!0,h=String(s.r).substr(-1)==="%"?"prgb":"rgb"):Rt(s.h)&&Rt(s.s)&&Rt(s.v)?(i=bi(s.s),n=bi(s.v),t=kg(s.h,i,n),r=!0,h="hsv"):Rt(s.h)&&Rt(s.s)&&Rt(s.l)?(i=bi(s.s),a=bi(s.l),t=gg(s.h,i,a),r=!0,h="hsl"):Rt(s.c)&&Rt(s.m)&&Rt(s.y)&&Rt(s.k)&&(t=Eg(s.c,s.m,s.y,s.k),r=!0,h="cmyk"),Object.prototype.hasOwnProperty.call(s,"a")&&(e=s.a)),e=al(e),{ok:r,format:s.format||h,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:e}}const bg="[-\\+]?\\d+%?",Fg="[-\\+]?\\d*\\.\\d+%?",De="(?:"+Fg+")|(?:"+bg+")",ea="[\\s|\\(]+("+De+")[,|\\s]+("+De+")[,|\\s]+("+De+")\\s*\\)?",Fi="[\\s|\\(]+("+De+")[,|\\s]+("+De+")[,|\\s]+("+De+")[,|\\s]+("+De+")\\s*\\)?",$t={CSS_UNIT:new RegExp(De),rgb:new RegExp("rgb"+ea),rgba:new RegExp("rgba"+Fi),hsl:new RegExp("hsl"+ea),hsla:new RegExp("hsla"+Fi),hsv:new RegExp("hsv"+ea),hsva:new RegExp("hsva"+Fi),cmyk:new RegExp("cmyk"+Fi),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function vg(s){if(s=s.trim().toLowerCase(),s.length===0)return!1;let t=!1;if(ba[s])s=ba[s],t=!0;else if(s==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};let e=$t.rgb.exec(s);return e?{r:e[1],g:e[2],b:e[3]}:(e=$t.rgba.exec(s),e?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=$t.hsl.exec(s),e?{h:e[1],s:e[2],l:e[3]}:(e=$t.hsla.exec(s),e?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=$t.hsv.exec(s),e?{h:e[1],s:e[2],v:e[3]}:(e=$t.hsva.exec(s),e?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=$t.cmyk.exec(s),e?{c:e[1],m:e[2],y:e[3],k:e[4]}:(e=$t.hex8.exec(s),e?{r:At(e[1]),g:At(e[2]),b:At(e[3]),a:qh(e[4]),format:t?"name":"hex8"}:(e=$t.hex6.exec(s),e?{r:At(e[1]),g:At(e[2]),b:At(e[3]),format:t?"name":"hex"}:(e=$t.hex4.exec(s),e?{r:At(e[1]+e[1]),g:At(e[2]+e[2]),b:At(e[3]+e[3]),a:qh(e[4]+e[4]),format:t?"name":"hex8"}:(e=$t.hex3.exec(s),e?{r:At(e[1]+e[1]),g:At(e[2]+e[2]),b:At(e[3]+e[3]),format:t?"name":"hex"}:!1))))))))))}function Rt(s){return typeof s=="number"?!Number.isNaN(s):$t.CSS_UNIT.test(s)}class Q{constructor(t="",e={}){if(t instanceof Q)return t;typeof t=="number"&&(t=wg(t)),this.originalInput=t;const i=xg(t);this.originalInput=t,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=e.format??i.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}getBrightness(){const t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3}getLuminance(){const t=this.toRgb();let e,i,n;const a=t.r/255,r=t.g/255,h=t.b/255;return a<=.03928?e=a/12.92:e=Math.pow((a+.055)/1.055,2.4),r<=.03928?i=r/12.92:i=Math.pow((r+.055)/1.055,2.4),h<=.03928?n=h/12.92:n=Math.pow((h+.055)/1.055,2.4),.2126*e+.7152*i+.0722*n}getAlpha(){return this.a}setAlpha(t){return this.a=al(t),this.roundA=Math.round(100*this.a)/100,this}isMonochrome(){const{s:t}=this.toHsl();return t===0}toHsv(){const t=Yh(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}}toHsvString(){const t=Yh(this.r,this.g,this.b),e=Math.round(t.h*360),i=Math.round(t.s*100),n=Math.round(t.v*100);return this.a===1?`hsv(${e}, ${i}%, ${n}%)`:`hsva(${e}, ${i}%, ${n}%, ${this.roundA})`}toHsl(){const t=Uh(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}}toHslString(){const t=Uh(this.r,this.g,this.b),e=Math.round(t.h*360),i=Math.round(t.s*100),n=Math.round(t.l*100);return this.a===1?`hsl(${e}, ${i}%, ${n}%)`:`hsla(${e}, ${i}%, ${n}%, ${this.roundA})`}toHex(t=!1){return Vh(this.r,this.g,this.b,t)}toHexString(t=!1){return"#"+this.toHex(t)}toHex8(t=!1){return yg(this.r,this.g,this.b,this.a,t)}toHex8String(t=!1){return"#"+this.toHex8(t)}toHexShortString(t=!1){return this.a===1?this.toHexString(t):this.toHex8String(t)}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbString(){const t=Math.round(this.r),e=Math.round(this.g),i=Math.round(this.b);return this.a===1?`rgb(${t}, ${e}, ${i})`:`rgba(${t}, ${e}, ${i}, ${this.roundA})`}toPercentageRgb(){const t=e=>`${Math.round(gt(e,255)*100)}%`;return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}}toPercentageRgbString(){const t=e=>Math.round(gt(e,255)*100);return this.a===1?`rgb(${t(this.r)}%, ${t(this.g)}%, ${t(this.b)}%)`:`rgba(${t(this.r)}%, ${t(this.g)}%, ${t(this.b)}%, ${this.roundA})`}toCmyk(){return{...Xh(this.r,this.g,this.b)}}toCmykString(){const{c:t,m:e,y:i,k:n}=Xh(this.r,this.g,this.b);return`cmyk(${t}, ${e}, ${i}, ${n})`}toName(){if(this.a===0)return"transparent";if(this.a<1)return!1;const t="#"+Vh(this.r,this.g,this.b,!1);for(const[e,i]of Object.entries(ba))if(t===i)return e;return!1}toString(t){const e=!!t;t=t??this.format;let i=!1;const n=this.a<1&&this.a>=0;return!e&&n&&(t.startsWith("hex")||t==="name")?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(i=this.toRgbString()),t==="prgb"&&(i=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(i=this.toHexString()),t==="hex3"&&(i=this.toHexString(!0)),t==="hex4"&&(i=this.toHex8String(!0)),t==="hex8"&&(i=this.toHex8String()),t==="name"&&(i=this.toName()),t==="hsl"&&(i=this.toHslString()),t==="hsv"&&(i=this.toHsvString()),t==="cmyk"&&(i=this.toCmykString()),i||this.toHexString())}toNumber(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)}clone(){return new Q(this.toString())}lighten(t=10){const e=this.toHsl();return e.l+=t/100,e.l=xi(e.l),new Q(e)}brighten(t=10){const e=this.toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(t/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(t/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(t/100)))),new Q(e)}darken(t=10){const e=this.toHsl();return e.l-=t/100,e.l=xi(e.l),new Q(e)}tint(t=10){return this.mix("white",t)}shade(t=10){return this.mix("black",t)}desaturate(t=10){const e=this.toHsl();return e.s-=t/100,e.s=xi(e.s),new Q(e)}saturate(t=10){const e=this.toHsl();return e.s+=t/100,e.s=xi(e.s),new Q(e)}greyscale(){return this.desaturate(100)}spin(t){const e=this.toHsl(),i=(e.h+t)%360;return e.h=i<0?360+i:i,new Q(e)}mix(t,e=50){const i=this.toRgb(),n=new Q(t).toRgb(),a=e/100,r={r:(n.r-i.r)*a+i.r,g:(n.g-i.g)*a+i.g,b:(n.b-i.b)*a+i.b,a:(n.a-i.a)*a+i.a};return new Q(r)}analogous(t=6,e=30){const i=this.toHsl(),n=360/e,a=[this];for(i.h=(i.h-(n*t>>1)+720)%360;--t;)i.h=(i.h+n)%360,a.push(new Q(i));return a}complement(){const t=this.toHsl();return t.h=(t.h+180)%360,new Q(t)}monochromatic(t=6){const e=this.toHsv(),{h:i}=e,{s:n}=e;let{v:a}=e;const r=[],h=1/t;for(;t--;)r.push(new Q({h:i,s:n,v:a})),a=(a+h)%1;return r}splitcomplement(){const t=this.toHsl(),{h:e}=t;return[this,new Q({h:(e+72)%360,s:t.s,l:t.l}),new Q({h:(e+216)%360,s:t.s,l:t.l})]}onBackground(t){const e=this.toRgb(),i=new Q(t).toRgb(),n=e.a+i.a*(1-e.a);return new Q({r:(e.r*e.a+i.r*i.a*(1-e.a))/n,g:(e.g*e.a+i.g*i.a*(1-e.a))/n,b:(e.b*e.a+i.b*i.a*(1-e.a))/n,a:n})}triad(){return this.polyad(3)}tetrad(){return this.polyad(4)}polyad(t){const e=this.toHsl(),{h:i}=e,n=[this],a=360/t;for(let r=1;r<t;r++)n.push(new Q({h:(i+r*a)%360,s:e.s,l:e.l}));return n}equals(t){const e=new Q(t);return this.format==="cmyk"||e.format==="cmyk"?this.toCmykString()===e.toCmykString():this.toRgbString()===e.toRgbString()}}function Kh(s,t=20){return new Q(s).mix(Nt.black,t).toString()}function Wt(s,t=20){return new Q(s).mix(Nt.white,t).toString()}function vi(s,t){return new Q(s).toString("rgb")===new Q(t).toString("rgb")}function Cg(){U.changeAttr("fontFamily",Rg)}class rl extends ct{constructor(t){super(),Cg(),this.props=this.proxyProps(t),this.render()}proxyProps(t){const e=this;return new Proxy(t,{set(i,n,a){return i[n]=a,e.render(),!0}})}setProps(t){Object.assign(this.props,t)}render(){}}function Bg(){}function ce(s,t="default"){return new Proxy(s,{get(e,i){return i in e?e[i]:e[t]}})}const Rg="Inter, Helvetica Neue, Helvetica, PingFang SC, Hiragino Sans GB, Microsoft YaHei, , Arial, sans-serif",Zh=ce({large:40,default:32,small:24}),Ns=ce({base:4,small:2,round:20,circle:100}),Nt=ce({white:"#ffffff",black:"#000000",primary:"#409eff",success:"#67c23a",warning:"#e6a23c",danger:"#f56c6c",error:"#f56c6c",info:"#909399"}),Qh=ce({primary:"#303133",regular:"#606266",secondary:"#909399",placeholder:"#a8abb2",disabled:"#c0c4cc"}),Fa=ce({"":"#dcdfe6",light:"#e4e7ed",lighter:"#ebeef5","extra-light":"#f2f6fc",dark:"#d4d7de",darker:"#cdd0d6"}),ut=ce({...Nt,"":Nt.white},""),Jh=ce({...Nt,"":Fa[""]},""),Ag=ce({large:Ns.base,default:Ns.base,small:Ns.small}),to=ce({large:14,default:14,small:12}),Sg=ce({large:[13,20],default:[9,16],small:[6,12]});class Dg extends rl{constructor(t){super(t)}get __tag(){return"ElButton"}render(){const t=this.props.text||"",e=this.props.size||"",i=this.props.type||"",n=this.props.plain,a=this.props.round,r=this.props.circle,h=this.props.disabled,o=this.props.onClick||Bg,l=n?Wt(ut[i],90):ut[i],d=i?n?Wt(Nt[i],50):Nt[i]:Fa[""],_=i?n?ut[i]:Wt(ut[i],30):n?Nt.white:Wt(ut.primary,90),u=i?n?ut[i]:Wt(ut[i],30):n?ut.primary:Wt(ut.primary,70),p=i?Kh(ut[i]):n?Nt.white:Wt(ut.primary,90),f=i?Kh(ut[i]):ut.primary,g=n?Wt(ut[i],90):Wt(ut[i],50),m=i?n?Wt(Jh[i],80):Wt(Jh[i],50):Fa.light,E=i?n?ut[i]:Nt.white:Qh.regular,k=i?Nt.white:ut.primary,w=i?n?Wt(ut[i],50):Nt.white:Qh.placeholder;this.set({height:Zh[e],fill:l,stroke:vi(d,l)?void 0:d,strokeWidth:1,strokeAlign:"inside",cornerRadius:a?Ns.round:r?Ns.circle:Ag[e],cursor:"pointer",disabled:h,hoverStyle:{fill:_,stroke:vi(u,_)?void 0:u},pressStyle:{fill:p,stroke:vi(f,p)?void 0:f},disabledStyle:{fill:g,stroke:vi(m,g)?void 0:m,cursor:"not-allowed"},children:[{tag:"Text",width:r?Zh[e]:void 0,textAlign:r?"center":void 0,text:t,fill:E,fontSize:to[e],fontWeight:500,lineHeight:to[e],padding:Sg[e],hitBox:!0,disabled:h,hoverStyle:{fill:k},disabledStyle:{fill:w}}]}),this.on(B.CLICK,o)}}const D=Dg;function eo(s){return Array.isArray(s)?s[0]:s}class Pg extends rl{constructor(t){super(t)}get __tag(){return"ElButtonGroup"}render(){const t=this.props.children||[],e=this.props.size||"";t.length>1&&t.forEach((i,n)=>{if(e&&(i.props.size=e),n===0){const a=eo(i.cornerRadius);i.cornerRadius=[a,0,0,a]}else if(n===t.length-1){const a=eo(i.cornerRadius);i.cornerRadius=[0,a,a,0]}else i.cornerRadius=0}),this.set({children:[new St({gap:1,children:t})]})}}const Tg=Pg,Og=va({__name:"basic",setup(s){const t=Ca(null);return Ba(()=>{const e=new Qt({view:t.value,height:158,wheel:{disabled:!0,preventDefault:!1}}),i=new D({text:"Default"}),n=new D({text:"Primary",type:"primary"}),a=new D({text:"Success",type:"success"}),r=new D({text:"Info",type:"info"}),h=new D({text:"Warning",type:"warning"}),o=new D({text:"Danger",type:"danger"}),l=new D({text:"Plain",plain:!0}),d=new D({text:"Primary",type:"primary",plain:!0}),_=new D({text:"Success",type:"success",plain:!0}),u=new D({text:"Info",type:"info",plain:!0}),p=new D({text:"Warning",type:"warning",plain:!0}),f=new D({text:"Danger",type:"danger",plain:!0}),g=new D({text:"Round",round:!0}),m=new D({text:"Primary",type:"primary",round:!0}),E=new D({text:"Success",type:"success",round:!0}),k=new D({text:"Info",type:"info",round:!0}),w=new D({text:"Warning",type:"warning",round:!0}),x=new D({text:"Danger",type:"danger",round:!0}),A=new D({text:"A",circle:!0}),M=new D({text:"B",type:"primary",circle:!0}),P=new D({text:"C",type:"success",circle:!0}),W=new D({text:"D",type:"info",circle:!0}),J=new D({text:"E",type:"warning",circle:!0}),it=new D({text:"F",type:"danger",circle:!0}),Y=new St({gap:10,children:[i,n,a,r,h,o]}),tt=new St({gap:10,children:[l,d,_,u,p,f]}),j=new St({gap:10,children:[g,m,E,k,w,x]}),rt=new St({gap:10,children:[A,M,P,W,J,it]}),V=new St({flow:"y",gap:10,children:[Y,tt,j,rt]});e.add(V)}),(e,i)=>(Li(),Ii("div",{ref_key:"container",ref:t},null,512))}}),Mg=va({__name:"disabled",setup(s){const t=Ca(null);return Ba(()=>{const e=new Qt({view:t.value,height:74,wheel:{disabled:!0,preventDefault:!1}}),i=new D({text:"Default",disabled:!0}),n=new D({text:"Primary",type:"primary",disabled:!0}),a=new D({text:"Success",type:"success",disabled:!0}),r=new D({text:"Info",type:"info",disabled:!0}),h=new D({text:"Warning",type:"warning",disabled:!0}),o=new D({text:"Danger",type:"danger",disabled:!0}),l=new D({text:"Plain",plain:!0,disabled:!0}),d=new D({text:"Primary",type:"primary",plain:!0,disabled:!0}),_=new D({text:"Success",type:"success",plain:!0,disabled:!0}),u=new D({text:"Info",type:"info",plain:!0,disabled:!0}),p=new D({text:"Warning",type:"warning",plain:!0,disabled:!0}),f=new D({text:"Danger",type:"danger",plain:!0,disabled:!0}),g=new St({gap:10,children:[i,n,a,r,h,o]}),m=new St({gap:10,children:[l,d,_,u,p,f]}),E=new St({flow:"y",gap:10,children:[g,m]});e.add(E)}),(e,i)=>(Li(),Ii("div",{ref_key:"container",ref:t},null,512))}}),Lg=va({__name:"group",setup(s){const t=Ca(null);return Ba(()=>{const e=new Qt({view:t.value,height:32,wheel:{disabled:!0,preventDefault:!1}}),i=new D({text:"Previous Page",type:"primary"}),n=new D({text:"Current Page",type:"primary"}),a=new D({text:"Next Page",type:"primary"}),r=new Tg({children:[i,n,a]});e.add(r)}),(e,i)=>(Li(),Ii("div",{ref_key:"container",ref:t},null,512))}}),Ig=Wi("",4),Wg=Wi("",4),$g=Wi("",4),zg=Wi("",1),gk=JSON.parse('{"title":"Button ","description":"","frontmatter":{},"headers":[],"relativePath":"zh-CN/component/button.md","filePath":"zh-CN/component/button.md"}'),Ng={name:"zh-CN/component/button.md"},kk=Object.assign(Ng,{setup(s){return(t,e)=>(Li(),Ii("div",null,[Ig,Qi(Og),Wg,Qi(Mg),$g,Qi(Lg),zg]))}});export{gk as __pageData,kk as default};
